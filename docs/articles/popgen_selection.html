<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Allele frequency change and selection • evolved</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Allele frequency change and selection">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">evolved</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/birthdeath_deeptime.html">Birth-death models and deep time</a>
    </li>
    <li>
      <a href="../articles/birthdeath_phylogenies.html">Birth-death models and molecular phylogenies</a>
    </li>
    <li>
      <a href="../articles/deeptime_clocks.html">Allele frequency change and selection</a>
    </li>
    <li>
      <a href="../articles/deeptime_rocks.html">Introduction to the fossil record</a>
    </li>
    <li>
      <a href="../articles/intro_R.html">Introduction to R</a>
    </li>
    <li>
      <a href="../articles/phylogenies_and_diversification.html">Phylogenies and diversification</a>
    </li>
    <li>
      <a href="../articles/popgen_drift.html">Sampling alleles, genetic drift and effective population size</a>
    </li>
    <li>
      <a href="../articles/popgen_intro.html">Introduction to evolutionary genetics</a>
    </li>
    <li>
      <a href="../articles/popgen_selection.html">Allele frequency change and selection</a>
    </li>
    <li>
      <a href="../articles/population_genetics.html">Tools for population genetics</a>
    </li>
    <li>
      <a href="../articles/rocks_and_clocks.html">Clocks and Rocks</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mjanuario/evolved/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Allele frequency change and selection</h1>
                        <h4 data-toc-skip class="author">Matheus
Januario, Andressa Viol, and Daniel Rabosky</h4>
            
            <h4 data-toc-skip class="date">Jan 2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mjanuario/evolved/blob/HEAD/vignettes/popgen_selection.Rmd" class="external-link"><code>vignettes/popgen_selection.Rmd</code></a></small>
      <div class="hidden name"><code>popgen_selection.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="learning-objectives">Learning objectives<a class="anchor" aria-label="anchor" href="#learning-objectives"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Breeding effective population size</li>
<li>Mutation-drift equilibrium</li>
<li>Selection</li>
<li>The case of the peppered moths</li>
</ol>
<p>First, we load our packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">evolved</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>We already saw in other popgen vignettes that due to sampling only,
allele frequencies are predicted to change with time in a finite
population – a process we call genetic drift. Still, many things
<em>other than drift</em> also change allele frequency. We will work
with them today.</p>
</div>
<div class="section level2">
<h2 id="breeding-effective-population-size">Breeding effective population size<a class="anchor" aria-label="anchor" href="#breeding-effective-population-size"></a>
</h2>
<p>Following Wright (1931), the breeding effective size is calculated
as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>e</mi></msub><mo>=</mo><mfrac><mrow><mn>4</mn><msub><mi>N</mi><mi>m</mi></msub><msub><mi>N</mi><mi>f</mi></msub></mrow><mrow><msub><mi>N</mi><mi>m</mi></msub><mo>+</mo><msub><mi>N</mi><mi>f</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\begin{equation}
N_e = \frac{4N_m N_f}{N_m+N_f}
\end{equation}</annotation></semantics></math></p>
</div>
<div class="section level2">
<h2 id="mutation-drift-equilibrium">Mutation-drift equilibrium<a class="anchor" aria-label="anchor" href="#mutation-drift-equilibrium"></a>
</h2>

</div>
<div class="section level2">
<h2 id="selection">Selection<a class="anchor" aria-label="anchor" href="#selection"></a>
</h2>
<p>Using the function <code><a href="../reference/NatSelSim.html">NatSelSim()</a></code> (from
<code>evolved</code>) you can explore how selection occurs in a
bi-allelic gene of a diploid organism, given a set of arguments:
<code>p0</code> is the initial frequency of the focal allele (labeled
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mn>1</mn></msub><annotation encoding="application/x-tex">A_1</annotation></semantics></math>
in the output plots), <code>w11</code> is the fitness of the homozygote
for the focal allele, and <code>w12</code> is the heterozygote fitness.
The function also requires the number of generations simulated
(<code>n.gen</code>).</p>
<p>The question above describes a situation where the dominant allele
has higher fitness. But there are many other possibilities. Tweak the
parameters to explore how selection behaves in different situations.</p>
<p>Now, simulate all those biological scenarios. As we said above,
before running the code, try to come up with expectations about how the
system will behave – this is fundamental for you to build intuition on
how selection works. Try to also vary the initial frequency – why is
this important?</p>
<p>Do your results correspond to your hypotheses?</p>
</div>
<div class="section level2">
<h2 id="the-case-of-the-peppered-moths">The case of the peppered moths<a class="anchor" aria-label="anchor" href="#the-case-of-the-peppered-moths"></a>
</h2>
<p>For a long time, melanic individuals of <em>Biston betularia</em>
(the peppered moth) were considered to be rare. The first dark morph was
deposited in a museum only in 1811 (Berry, 1990), 53 years after the
species was first described. The first live specimen was caught 37 years
after that by R.S. Edleston in 1848. Only 16 years later, however,
Edleston would say that the dark (a.k.a. <em>carbonaria</em>) morph was
the most common morph that he caught in his garden (Berry, 1990).</p>
<p>At the time many hypotheses were drawn to explain this phenomenon
(Cook &amp; Turner, 2020), but a very good hypothesis is that
light-colored morphs were able to camouflage easier in lichenous tree
barks (see figure 1), while the dark morph was easily seen by birds on
this background. However, after the industrial revolution, many of the
lichen died, exposing the darker tree bark underneath and supposedly
changing which morph was most visible to birds.</p>
<div class="figure">
<img src="2_morphs.png" alt="Light and carbonaria morphs of the peppered moth on the same lichenous tree. Image from wikicommons." width="500"><p class="caption">
Light and carbonaria morphs of the peppered moth on the same lichenous
tree. Image from wikicommons.
</p>
</div>
<p>Almost a century ago, J. B. S. Haldane performed some calculations on
peppered moth morphs to estimate the selection coefficient
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>)
that natural populations face (Haldane, 1924). Below, you will use a
similar approach to also estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>,
departing from the same data and assumptions that Haldane used.</p>
<p>Haldane made his estimate using analytic calculations, but we can
approach his results by using a procedure similar to the one below:</p>
<ol style="list-style-type: upper-roman">
<li>Multiply the frequency of each genotype in the population by its
relative fitness, obtaining the frequency of genotypes that will
actually reproduce.</li>
<li>Get the new allele frequency <em>after</em> selection. Then, assume
those genotypes mate randomly, which will lead to offspring genotypes
that follow frequencies expected by HWE and the new allelic frequency
(the one after selection).</li>
<li>Repeat steps I-II until selection for that characteristic is over
(i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">s = 0</annotation></semantics></math>)
or there is no genetic variation anymore. Note that this is no different
than what the function <code><a href="../reference/NatSelSim.html">NatSelSim()</a></code> does “under its hood”
(which you can check by typing the function name without the parenthesis
in the R console).</li>
</ol>
<p>We need some data to help us calculate our estimates. Drawing from
the literature, Haldane assumed that the <strong>carbonaria morph alelle
had a frequency of roughly 1% in 1848 but that its frequency had
increased to 99% after 50 generations</strong>.</p>
<p>Taking Haldane’s assumptions for granted, and using the procedure
explained above, we are going to estimate the intensity of selection
favoring the dark morph. To do that:</p>
<p><strong>(1)</strong> Assume that the <em>carbonaria</em> allele is
dominant, and begin with the allele frequency given above for the
<em>carbonaria</em> allele before the industrial revolution.</p>
<p><strong>(2)</strong> Then, use step I-III above to compute the final
frequency of the allele after 50 generations of selection. After each
simulation, your value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>
will be fixed.</p>
<p><strong>(3)</strong> Do many simulations across a range of relative
fitness values for the light morph allele.</p>
<p><strong>(4)</strong> Using the final
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
frequencies from all simulations, you will generate a “profile plot”,
where your x-axis should be the relative fitness of light morph, and
your y-axis should be the final frequency of the carbonaria allele after
50 generations.</p>
<p>Below, we designed some questions that will guide you through this
procedure.</p>
<p>Since Haldane did his approximation, subsequent research has greatly
improved our knowledge of peppered moth evolution. The fact that we have
few good temporal records from the period in which melanic individuals
were increasing in frequency obscures many details, but several
possibilities were considered for the observed change, from linkage
disequilibrium of melanic alleles to heterozygote advantage (Cook &amp;
Turner, 2020). Still, Haldane’s point is very clear: <strong>selection
can be really strong in natural populations!</strong> However, even
though the melanic morph had very high frequency at the early 20th
century, this allele was <em>not</em> fixed. Influx of alleles via
mating with migrants from elsewhere were not considered a good
hypothesis at the time but, much later, DNA-based evidence in favor of
that hypothesis was found (Cook &amp; Turner, 2020). Are you surprised
that natural populations, even in such “simple” scenarios, are
<em>that</em> complex?</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Berry, R. J. (1990). Industrial melanism and peppered moths (Biston
betularia (L.)). Biological Journal of the Linnean Society, 39(4),
301-322.</p>
<p>Cook, L. M., &amp; Turner, J. R. (2020). Fifty per cent and all that:
what Haldane actually said. Biological Journal of the Linnean Society,
129(3), 765-771.</p>
<p>Edleston, R. S., 1864. Amptydasis betularia. The Entomologist, 2:
150</p>
<p>Haldane JBS. 1924. A mathematical theory of natural and artificial
selection. Transactions of the Cambridge Philosophical Society 23:
19–41.</p>
<p>Wright, S. (1931). Evolution in Mendelian populations. Genetics,
16(2), 97.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Matheus Januario, Jennifer Auler, Andressa Viol, Daniel Rabosky.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
