<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Simulating natural selection through time in a bi-allelic gene — NatSelSim • evolved</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Simulating natural selection through time in a bi-allelic gene — NatSelSim"><meta property="og:description" content="NatSelSim simulates natural selection in a bi-allelic gene through
n.gen generations."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">evolved</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/birthdeath_deeptime.html">Birth-death models and deep time</a>
    </li>
    <li>
      <a href="../articles/birthdeath_phylogenies.html">Birth-death models and molecular phylogenies</a>
    </li>
    <li>
      <a href="../articles/deeptime_clocks.html">Allele frequency change and selection</a>
    </li>
    <li>
      <a href="../articles/deeptime_rocks.html">Introduction to the fossil record</a>
    </li>
    <li>
      <a href="../articles/intro_R.html">Introduction to R</a>
    </li>
    <li>
      <a href="../articles/phylogenies_and_diversification.html">Phylogenies and diversification</a>
    </li>
    <li>
      <a href="../articles/popgen_drift.html">Sampling alleles, genetic drift and effective population size</a>
    </li>
    <li>
      <a href="../articles/popgen_intro.html">Introduction to evolutionary genetics</a>
    </li>
    <li>
      <a href="../articles/popgen_selection.html">Allele frequency change and selection</a>
    </li>
    <li>
      <a href="../articles/population_genetics.html">Tools for population genetics</a>
    </li>
    <li>
      <a href="../articles/rocks_and_clocks.html">Clocks and Rocks</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/mjanuario/evolved/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulating natural selection through time in a bi-allelic gene</h1>
    <small class="dont-index">Source: <a href="https://github.com/mjanuario/evolved/blob/HEAD/R/NatSelSim.R" class="external-link"><code>R/NatSelSim.R</code></a></small>
    <div class="hidden name"><code>NatSelSim.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>NatSelSim</code> simulates natural selection in a bi-allelic gene through
<code>n.gen</code> generations.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">NatSelSim</span><span class="op">(</span></span>
<span>  w11 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  w12 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  w22 <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  p0 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  n.gen <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  plot.type <span class="op">=</span> <span class="st">"animateall"</span>,</span>
<span>  print.data <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  knitr <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-w-">w11<a class="anchor" aria-label="anchor" href="#arg-w-"></a></dt>
<dd><p>Number giving the fitness of genotype A1A1. Values will be
normalized if any genotype fitness exceeds one.</p></dd>


<dt id="arg-w-">w12<a class="anchor" aria-label="anchor" href="#arg-w-"></a></dt>
<dd><p>Number giving the fitness of genotype A1A2. Values will be
normalized if any genotype fitness exceeds one.</p></dd>


<dt id="arg-w-">w22<a class="anchor" aria-label="anchor" href="#arg-w-"></a></dt>
<dd><p>Number giving the fitness of genotype A2A2. Values will be
normalized if any genotype fitness exceeds one.</p></dd>


<dt id="arg-p-">p0<a class="anchor" aria-label="anchor" href="#arg-p-"></a></dt>
<dd><p>Initial (time = 0) allelic frequency of A1.
A2's initial allelic frequency is <code>1-p0</code>.</p></dd>


<dt id="arg-n-gen">n.gen<a class="anchor" aria-label="anchor" href="#arg-n-gen"></a></dt>
<dd><p>Number of generation that will be simulated.</p></dd>


<dt id="arg-plot-type">plot.type<a class="anchor" aria-label="anchor" href="#arg-plot-type"></a></dt>
<dd><p>String indicating if plot should be animated.
The default, "animateall" animate all possible panels.
Other options are "static" (no animation), "animate1", "animate3", or
"animate4". Users can animate each panel individually (using
<code>plot.type = "animateX"</code>, with X being the panel which one wants to
animate (so options are  "animate1",  "animate3",  and "animate4"
(see return for more info).</p></dd>


<dt id="arg-print-data">print.data<a class="anchor" aria-label="anchor" href="#arg-print-data"></a></dt>
<dd><p>Logical indicating whether all
simulation results should be returned as a <code>data.frame</code>. Default value
is <code>FALSE</code>.</p></dd>


<dt id="arg-knitr">knitr<a class="anchor" aria-label="anchor" href="#arg-knitr"></a></dt>
<dd><p>Logical indicating if plot is intended to show up in RMarkdown files made by the <code>Knitr</code> R package.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>If <code>print.data = TRUE</code>, it returns a <code>data.frame</code>
containing the number of individuals for each genotype through time. The
plots done by the function shows (1) Allele frequency change through time.
(2) The adaptive landscape (which remains static during the whole simulation,
so can't be animated), (3) Time series of mean population fitness,
and (4) Time series of genotypic population frequencies.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>If any value of fitness (i.e., <code>w11</code>, <code>w12</code>,
<code>w22</code>) is larger than one, fitness is interpreted as absolute fitness
and values are re-normalized.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Fisher, R. A. (1930). The Fundamental Theorem of Natural Selection. In: The genetical theory of natural selection. The Clarendon Press</p>
<p>Plutynski, A. (2006). What was Fisher’s fundamental theorem of natural selection and what was it for?. Studies in History and Philosophy of Science Part C: Studies in History and Philosophy of Biological and Biomedical Sciences, 37(1), 59-82.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Matheus Januario, Jennifer Auler, Dan Rabosky</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#using the default values (w11=1, w12=1, w22=0.9, p0=0.5, n.gen=10)</span></span></span>
<span class="r-in"><span><span class="fu">NatSelSim</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Continuing a simulation for extra time:</span></span></span>
<span class="r-in"><span><span class="co"># Run the first simulation</span></span></span>
<span class="r-in"><span><span class="va">sim1</span><span class="op">=</span><span class="fu">NatSelSim</span><span class="op">(</span>w11 <span class="op">=</span> <span class="fl">.4</span>, w12 <span class="op">=</span> <span class="fl">.5</span>, w22 <span class="op">=</span> <span class="fl">.4</span>, p0 <span class="op">=</span> <span class="fl">0.35</span>, </span></span>
<span class="r-in"><span>n.gen <span class="op">=</span> <span class="fl">5</span>, plot.type <span class="op">=</span> <span class="st">"static"</span>, print.data <span class="op">=</span> <span class="cn">TRUE</span>, knitr <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Then take the allelic frequency form the first sim:</span></span></span>
<span class="r-in"><span><span class="va">new_p0</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">sim1</span><span class="op">$</span><span class="va">AA</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sim1</span><span class="op">)</span><span class="op">]</span> <span class="op">+</span> <span class="va">sim1</span><span class="op">$</span><span class="va">Aa</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sim1</span><span class="op">)</span><span class="op">]</span><span class="op">*</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="co"># and use as p0 for a second one:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">NatSelSim</span><span class="op">(</span>w11 <span class="op">=</span> <span class="fl">.4</span>, w12 <span class="op">=</span> <span class="fl">.5</span>, w22 <span class="op">=</span> <span class="fl">.4</span>, p0 <span class="op">=</span> <span class="va">new_p0</span>, n.gen <span class="op">=</span> <span class="fl">5</span>, plot.type <span class="op">=</span> <span class="st">"static"</span>, knitr <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Matheus Januario, Jennifer Auler, Andressa Viol, Daniel Rabosky.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

