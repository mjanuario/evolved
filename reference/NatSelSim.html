<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simulating natural selection through time in a bi-allelic gene — NatSelSim • evolved</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulating natural selection through time in a bi-allelic gene — NatSelSim"><meta name="description" content="NatSelSim simulates natural selection in a bi-allelic gene through
n.gen generations."><meta property="og:description" content="NatSelSim simulates natural selection in a bi-allelic gene through
n.gen generations."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">evolved</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-book"></span> Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html"><span class="fa fa-book-open"></span> Vignettes &amp; Tutorials</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper"></span> News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mjanuario/evolved" aria-label="GitHub repository"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulating natural selection through time in a bi-allelic gene</h1>
      <small class="dont-index">Source: <a href="https://github.com/mjanuario/evolved/blob/v1.0.1/R/NatSelSim.R" class="external-link"><code>R/NatSelSim.R</code></a></small>
      <div class="d-none name"><code>NatSelSim.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>NatSelSim</code> simulates natural selection in a bi-allelic gene through
<code>n.gen</code> generations.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">NatSelSim</span><span class="op">(</span></span>
<span>  w11 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  w12 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  w22 <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  p0 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  n.gen <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  plot.type <span class="op">=</span> <span class="st">"animateall"</span>,</span>
<span>  print.data <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  knitr <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-w-">w11<a class="anchor" aria-label="anchor" href="#arg-w-"></a></dt>
<dd><p>Number giving the fitness of genotype A1A1. Values will be
normalized if any genotype fitness exceeds one.</p></dd>


<dt id="arg-w-">w12<a class="anchor" aria-label="anchor" href="#arg-w-"></a></dt>
<dd><p>Number giving the fitness of genotype A1A2. Values will be
normalized if any genotype fitness exceeds one.</p></dd>


<dt id="arg-w-">w22<a class="anchor" aria-label="anchor" href="#arg-w-"></a></dt>
<dd><p>Number giving the fitness of genotype A2A2. Values will be
normalized if any genotype fitness exceeds one.</p></dd>


<dt id="arg-p-">p0<a class="anchor" aria-label="anchor" href="#arg-p-"></a></dt>
<dd><p>Initial (time = 0) allelic frequency of A1.
A2's initial allelic frequency is <code>1-p0</code>.</p></dd>


<dt id="arg-n-gen">n.gen<a class="anchor" aria-label="anchor" href="#arg-n-gen"></a></dt>
<dd><p>Number of generation that will be simulated.</p></dd>


<dt id="arg-plot-type">plot.type<a class="anchor" aria-label="anchor" href="#arg-plot-type"></a></dt>
<dd><p>String indicating if plot should be animated.
The default, "animateall" animate all possible panels.
Other options are "static" (no animation), "animate1", "animate3", or
"animate4". Users can animate each panel individually (using
<code>plot.type = "animateX"</code>, with X being the panel which one wants to
animate (so options are  "animate1",  "animate3",  and "animate4"
(see return for more info).</p></dd>


<dt id="arg-print-data">print.data<a class="anchor" aria-label="anchor" href="#arg-print-data"></a></dt>
<dd><p>Logical indicating whether all
simulation results should be returned as a <code>data.frame</code>. Default value
is <code>FALSE</code>.</p></dd>


<dt id="arg-knitr">knitr<a class="anchor" aria-label="anchor" href="#arg-knitr"></a></dt>
<dd><p>Logical indicating if plot is intended to show up in RMarkdown files made by the <code>Knitr</code> R package.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If <code>print.data = TRUE</code>, it returns a <code>data.frame</code>
containing the number of individuals for each genotype through time. The
plots done by the function shows (1) Allele frequency change through time.
(2) The adaptive landscape (which remains static during the whole simulation,
so can't be animated), (3) Time series of mean population fitness,
and (4) Time series of genotypic population frequencies.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If any value of fitness (i.e., <code>w11</code>, <code>w12</code>,
<code>w22</code>) is larger than one, fitness is interpreted as absolute fitness
and values are re-normalized.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Fisher, R. A. (1930). The Fundamental Theorem of Natural Selection. In: The genetical theory of natural selection. The Clarendon Press</p>
<p>Plutynski, A. (2006). What was Fisher’s fundamental theorem of natural selection and what was it for?. Studies in History and Philosophy of Science Part C: Studies in History and Philosophy of Biological and Biomedical Sciences, 37(1), 59-82.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other microevolution:
<code><a href="OneGenHWSim.html">OneGenHWSim()</a></code>,
<code><a href="WFDriftSim.html">WFDriftSim()</a></code>,
<code><a href="plotNatSel.html">plotNatSel()</a></code>,
<code><a href="plotWFDrift.html">plotWFDrift()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Matheus Januario, Jennifer Auler, Dan Rabosky</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#using the default values (w11=1, w12=1, w22=0.9, p0=0.5, n.gen=10)</span></span></span>
<span class="r-in"><span><span class="fu">NatSelSim</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Continuing a simulation for extra time:</span></span></span>
<span class="r-in"><span><span class="co"># Run the first simulation</span></span></span>
<span class="r-in"><span><span class="va">sim1</span><span class="op">=</span><span class="fu">NatSelSim</span><span class="op">(</span>w11 <span class="op">=</span> <span class="fl">.4</span>, w12 <span class="op">=</span> <span class="fl">.5</span>, w22 <span class="op">=</span> <span class="fl">.4</span>, p0 <span class="op">=</span> <span class="fl">0.35</span>, </span></span>
<span class="r-in"><span>n.gen <span class="op">=</span> <span class="fl">5</span>, plot.type <span class="op">=</span> <span class="st">"static"</span>, print.data <span class="op">=</span> <span class="cn">TRUE</span>, knitr <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Then take the allelic frequency form the first sim:</span></span></span>
<span class="r-in"><span><span class="va">new_p0</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">sim1</span><span class="op">$</span><span class="va">AA</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sim1</span><span class="op">)</span><span class="op">]</span> <span class="op">+</span> <span class="va">sim1</span><span class="op">$</span><span class="va">Aa</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sim1</span><span class="op">)</span><span class="op">]</span><span class="op">*</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="co"># and use as p0 for a second one:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">NatSelSim</span><span class="op">(</span>w11 <span class="op">=</span> <span class="fl">.4</span>, w12 <span class="op">=</span> <span class="fl">.5</span>, w22 <span class="op">=</span> <span class="fl">.4</span>, p0 <span class="op">=</span> <span class="va">new_p0</span>, n.gen <span class="op">=</span> <span class="fl">5</span>, plot.type <span class="op">=</span> <span class="st">"static"</span>, knitr <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matheus Januario, Jennifer Auler, Andressa Viol, Daniel Rabosky.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

