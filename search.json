[{"path":"https://mjanuario.github.io/evolved/CONTRIBUTING.html","id":"how-to-contribute","dir":"","previous_headings":"","what":"How to Contribute","title":"NA","text":"Vignettes can acessed https://mjanuario.github.io/evolved/, downloading package CRAN github (see instructions website). want contribute functions tutorials, please reach Matheus Januario (januarioml.eco [] gmail.com), can work add new material data site Alternatively, contributions new lessons welcome Pull Requests.","code":""},{"path":"https://mjanuario.github.io/evolved/CONTRIBUTING.html","id":"reporting-issues-or-problems-using-github","dir":"","previous_headings":"","what":"Reporting Issues or Problems using github","title":"NA","text":"report issues, bugs, problems either material, functions, wbesite please open issue github page happy address . Alternatively, send email Matheus Januario (januarioml.eco [] gmail.com).","code":""},{"path":"https://mjanuario.github.io/evolved/CONTRIBUTING.html","id":"support","dir":"","previous_headings":"","what":"Support","title":"NA","text":"Send email Matheus Januario (januarioml.eco [] gmail.com). Open issue ’s anything can help!","code":""},{"path":"https://mjanuario.github.io/evolved/CONTRIBUTING.html","id":"license","dir":"","previous_headings":"","what":"License","title":"NA","text":"See License information copyright ownership. Questions can also sent Matheus Januario (januarioml.eco [] gmail.com).","code":""},{"path":"https://mjanuario.github.io/evolved/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"GNU General Public License","title":"GNU General Public License","text":"Version 3, 29 June 2007Copyright © 2007 Free Software Foundation, Inc. <http://fsf.org/> Everyone permitted copy distribute verbatim copies license document, changing allowed.","code":""},{"path":"https://mjanuario.github.io/evolved/LICENSE.html","id":"preamble","dir":"","previous_headings":"","what":"Preamble","title":"GNU General Public License","text":"GNU General Public License free, copyleft license software kinds works. licenses software practical works designed take away freedom share change works. contrast, GNU General Public License intended guarantee freedom share change versions program–make sure remains free software users. , Free Software Foundation, use GNU General Public License software; applies also work released way authors. can apply programs, . speak free software, referring freedom, price. General Public Licenses designed make sure freedom distribute copies free software (charge wish), receive source code can get want , can change software use pieces new free programs, know can things. protect rights, need prevent others denying rights asking surrender rights. Therefore, certain responsibilities distribute copies software, modify : responsibilities respect freedom others. example, distribute copies program, whether gratis fee, must pass recipients freedoms received. must make sure , , receive can get source code. must show terms know rights. Developers use GNU GPL protect rights two steps: (1) assert copyright software, (2) offer License giving legal permission copy, distribute /modify . developers’ authors’ protection, GPL clearly explains warranty free software. users’ authors’ sake, GPL requires modified versions marked changed, problems attributed erroneously authors previous versions. devices designed deny users access install run modified versions software inside , although manufacturer can . fundamentally incompatible aim protecting users’ freedom change software. systematic pattern abuse occurs area products individuals use, precisely unacceptable. Therefore, designed version GPL prohibit practice products. problems arise substantially domains, stand ready extend provision domains future versions GPL, needed protect freedom users. Finally, every program threatened constantly software patents. States allow patents restrict development use software general-purpose computers, , wish avoid special danger patents applied free program make effectively proprietary. prevent , GPL assures patents used render program non-free. precise terms conditions copying, distribution modification follow.","code":""},{"path":[]},{"path":"https://mjanuario.github.io/evolved/LICENSE.html","id":"id_0-definitions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"0. Definitions","title":"GNU General Public License","text":"“License” refers version 3 GNU General Public License. “Copyright” also means copyright-like laws apply kinds works, semiconductor masks. “Program” refers copyrightable work licensed License. licensee addressed “”. “Licensees” “recipients” may individuals organizations. “modify” work means copy adapt part work fashion requiring copyright permission, making exact copy. resulting work called “modified version” earlier work work “based ” earlier work. “covered work” means either unmodified Program work based Program. “propagate” work means anything , without permission, make directly secondarily liable infringement applicable copyright law, except executing computer modifying private copy. Propagation includes copying, distribution (without modification), making available public, countries activities well. “convey” work means kind propagation enables parties make receive copies. Mere interaction user computer network, transfer copy, conveying. interactive user interface displays “Appropriate Legal Notices” extent includes convenient prominently visible feature (1) displays appropriate copyright notice, (2) tells user warranty work (except extent warranties provided), licensees may convey work License, view copy License. interface presents list user commands options, menu, prominent item list meets criterion.","code":""},{"path":"https://mjanuario.github.io/evolved/LICENSE.html","id":"id_1-source-code","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"1. Source Code","title":"GNU General Public License","text":"“source code” work means preferred form work making modifications . “Object code” means non-source form work. “Standard Interface” means interface either official standard defined recognized standards body, , case interfaces specified particular programming language, one widely used among developers working language. “System Libraries” executable work include anything, work whole, () included normal form packaging Major Component, part Major Component, (b) serves enable use work Major Component, implement Standard Interface implementation available public source code form. “Major Component”, context, means major essential component (kernel, window system, ) specific operating system () executable work runs, compiler used produce work, object code interpreter used run . “Corresponding Source” work object code form means source code needed generate, install, (executable work) run object code modify work, including scripts control activities. However, include work’s System Libraries, general-purpose tools generally available free programs used unmodified performing activities part work. example, Corresponding Source includes interface definition files associated source files work, source code shared libraries dynamically linked subprograms work specifically designed require, intimate data communication control flow subprograms parts work. Corresponding Source need include anything users can regenerate automatically parts Corresponding Source. Corresponding Source work source code form work.","code":""},{"path":"https://mjanuario.github.io/evolved/LICENSE.html","id":"id_2-basic-permissions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"2. Basic Permissions","title":"GNU General Public License","text":"rights granted License granted term copyright Program, irrevocable provided stated conditions met. License explicitly affirms unlimited permission run unmodified Program. output running covered work covered License output, given content, constitutes covered work. License acknowledges rights fair use equivalent, provided copyright law. may make, run propagate covered works convey, without conditions long license otherwise remains force. may convey covered works others sole purpose make modifications exclusively , provide facilities running works, provided comply terms License conveying material control copyright. thus making running covered works must exclusively behalf, direction control, terms prohibit making copies copyrighted material outside relationship . Conveying circumstances permitted solely conditions stated . Sublicensing allowed; section 10 makes unnecessary.","code":""},{"path":"https://mjanuario.github.io/evolved/LICENSE.html","id":"id_3-protecting-users-legal-rights-from-anti-circumvention-law","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"3. Protecting Users’ Legal Rights From Anti-Circumvention Law","title":"GNU General Public License","text":"covered work shall deemed part effective technological measure applicable law fulfilling obligations article 11 WIPO copyright treaty adopted 20 December 1996, similar laws prohibiting restricting circumvention measures. convey covered work, waive legal power forbid circumvention technological measures extent circumvention effected exercising rights License respect covered work, disclaim intention limit operation modification work means enforcing, work’s users, third parties’ legal rights forbid circumvention technological measures.","code":""},{"path":"https://mjanuario.github.io/evolved/LICENSE.html","id":"id_4-conveying-verbatim-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"4. Conveying Verbatim Copies","title":"GNU General Public License","text":"may convey verbatim copies Program’s source code receive , medium, provided conspicuously appropriately publish copy appropriate copyright notice; keep intact notices stating License non-permissive terms added accord section 7 apply code; keep intact notices absence warranty; give recipients copy License along Program. may charge price price copy convey, may offer support warranty protection fee.","code":""},{"path":"https://mjanuario.github.io/evolved/LICENSE.html","id":"id_5-conveying-modified-source-versions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"5. Conveying Modified Source Versions","title":"GNU General Public License","text":"may convey work based Program, modifications produce Program, form source code terms section 4, provided also meet conditions: ) work must carry prominent notices stating modified , giving relevant date. b) work must carry prominent notices stating released License conditions added section 7. requirement modifies requirement section 4 “keep intact notices”. c) must license entire work, whole, License anyone comes possession copy. License therefore apply, along applicable section 7 additional terms, whole work, parts, regardless packaged. License gives permission license work way, invalidate permission separately received . d) work interactive user interfaces, must display Appropriate Legal Notices; however, Program interactive interfaces display Appropriate Legal Notices, work need make . compilation covered work separate independent works, nature extensions covered work, combined form larger program, volume storage distribution medium, called “aggregate” compilation resulting copyright used limit access legal rights compilation’s users beyond individual works permit. Inclusion covered work aggregate cause License apply parts aggregate.","code":""},{"path":"https://mjanuario.github.io/evolved/LICENSE.html","id":"id_6-conveying-non-source-forms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"6. Conveying Non-Source Forms","title":"GNU General Public License","text":"may convey covered work object code form terms sections 4 5, provided also convey machine-readable Corresponding Source terms License, one ways: ) Convey object code , embodied , physical product (including physical distribution medium), accompanied Corresponding Source fixed durable physical medium customarily used software interchange. b) Convey object code , embodied , physical product (including physical distribution medium), accompanied written offer, valid least three years valid long offer spare parts customer support product model, give anyone possesses object code either (1) copy Corresponding Source software product covered License, durable physical medium customarily used software interchange, price reasonable cost physically performing conveying source, (2) access copy Corresponding Source network server charge. c) Convey individual copies object code copy written offer provide Corresponding Source. alternative allowed occasionally noncommercially, received object code offer, accord subsection 6b. d) Convey object code offering access designated place (gratis charge), offer equivalent access Corresponding Source way place charge. need require recipients copy Corresponding Source along object code. place copy object code network server, Corresponding Source may different server (operated third party) supports equivalent copying facilities, provided maintain clear directions next object code saying find Corresponding Source. Regardless server hosts Corresponding Source, remain obligated ensure available long needed satisfy requirements. e) Convey object code using peer--peer transmission, provided inform peers object code Corresponding Source work offered general public charge subsection 6d. separable portion object code, whose source code excluded Corresponding Source System Library, need included conveying object code work. “User Product” either (1) “consumer product”, means tangible personal property normally used personal, family, household purposes, (2) anything designed sold incorporation dwelling. determining whether product consumer product, doubtful cases shall resolved favor coverage. particular product received particular user, “normally used” refers typical common use class product, regardless status particular user way particular user actually uses, expects expected use, product. product consumer product regardless whether product substantial commercial, industrial non-consumer uses, unless uses represent significant mode use product. “Installation Information” User Product means methods, procedures, authorization keys, information required install execute modified versions covered work User Product modified version Corresponding Source. information must suffice ensure continued functioning modified object code case prevented interfered solely modification made. convey object code work section , , specifically use , User Product, conveying occurs part transaction right possession use User Product transferred recipient perpetuity fixed term (regardless transaction characterized), Corresponding Source conveyed section must accompanied Installation Information. requirement apply neither third party retains ability install modified object code User Product (example, work installed ROM). requirement provide Installation Information include requirement continue provide support service, warranty, updates work modified installed recipient, User Product modified installed. Access network may denied modification materially adversely affects operation network violates rules protocols communication across network. Corresponding Source conveyed, Installation Information provided, accord section must format publicly documented (implementation available public source code form), must require special password key unpacking, reading copying.","code":""},{"path":"https://mjanuario.github.io/evolved/LICENSE.html","id":"id_7-additional-terms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"7. Additional Terms","title":"GNU General Public License","text":"“Additional permissions” terms supplement terms License making exceptions one conditions. Additional permissions applicable entire Program shall treated though included License, extent valid applicable law. additional permissions apply part Program, part may used separately permissions, entire Program remains governed License without regard additional permissions. convey copy covered work, may option remove additional permissions copy, part . (Additional permissions may written require removal certain cases modify work.) may place additional permissions material, added covered work, can give appropriate copyright permission. Notwithstanding provision License, material add covered work, may (authorized copyright holders material) supplement terms License terms: ) Disclaiming warranty limiting liability differently terms sections 15 16 License; b) Requiring preservation specified reasonable legal notices author attributions material Appropriate Legal Notices displayed works containing ; c) Prohibiting misrepresentation origin material, requiring modified versions material marked reasonable ways different original version; d) Limiting use publicity purposes names licensors authors material; e) Declining grant rights trademark law use trade names, trademarks, service marks; f) Requiring indemnification licensors authors material anyone conveys material (modified versions ) contractual assumptions liability recipient, liability contractual assumptions directly impose licensors authors. non-permissive additional terms considered “restrictions” within meaning section 10. Program received , part , contains notice stating governed License along term restriction, may remove term. license document contains restriction permits relicensing conveying License, may add covered work material governed terms license document, provided restriction survive relicensing conveying. add terms covered work accord section, must place, relevant source files, statement additional terms apply files, notice indicating find applicable terms. Additional terms, permissive non-permissive, may stated form separately written license, stated exceptions; requirements apply either way.","code":""},{"path":"https://mjanuario.github.io/evolved/LICENSE.html","id":"id_8-termination","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"8. Termination","title":"GNU General Public License","text":"may propagate modify covered work except expressly provided License. attempt otherwise propagate modify void, automatically terminate rights License (including patent licenses granted third paragraph section 11). However, cease violation License, license particular copyright holder reinstated () provisionally, unless copyright holder explicitly finally terminates license, (b) permanently, copyright holder fails notify violation reasonable means prior 60 days cessation. Moreover, license particular copyright holder reinstated permanently copyright holder notifies violation reasonable means, first time received notice violation License (work) copyright holder, cure violation prior 30 days receipt notice. Termination rights section terminate licenses parties received copies rights License. rights terminated permanently reinstated, qualify receive new licenses material section 10.","code":""},{"path":"https://mjanuario.github.io/evolved/LICENSE.html","id":"id_9-acceptance-not-required-for-having-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"9. Acceptance Not Required for Having Copies","title":"GNU General Public License","text":"required accept License order receive run copy Program. Ancillary propagation covered work occurring solely consequence using peer--peer transmission receive copy likewise require acceptance. However, nothing License grants permission propagate modify covered work. actions infringe copyright accept License. Therefore, modifying propagating covered work, indicate acceptance License .","code":""},{"path":"https://mjanuario.github.io/evolved/LICENSE.html","id":"id_10-automatic-licensing-of-downstream-recipients","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"10. Automatic Licensing of Downstream Recipients","title":"GNU General Public License","text":"time convey covered work, recipient automatically receives license original licensors, run, modify propagate work, subject License. responsible enforcing compliance third parties License. “entity transaction” transaction transferring control organization, substantially assets one, subdividing organization, merging organizations. propagation covered work results entity transaction, party transaction receives copy work also receives whatever licenses work party’s predecessor interest give previous paragraph, plus right possession Corresponding Source work predecessor interest, predecessor can get reasonable efforts. may impose restrictions exercise rights granted affirmed License. example, may impose license fee, royalty, charge exercise rights granted License, may initiate litigation (including cross-claim counterclaim lawsuit) alleging patent claim infringed making, using, selling, offering sale, importing Program portion .","code":""},{"path":"https://mjanuario.github.io/evolved/LICENSE.html","id":"id_11-patents","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"11. Patents","title":"GNU General Public License","text":"“contributor” copyright holder authorizes use License Program work Program based. work thus licensed called contributor’s “contributor version”. contributor’s “essential patent claims” patent claims owned controlled contributor, whether already acquired hereafter acquired, infringed manner, permitted License, making, using, selling contributor version, include claims infringed consequence modification contributor version. purposes definition, “control” includes right grant patent sublicenses manner consistent requirements License. contributor grants non-exclusive, worldwide, royalty-free patent license contributor’s essential patent claims, make, use, sell, offer sale, import otherwise run, modify propagate contents contributor version. following three paragraphs, “patent license” express agreement commitment, however denominated, enforce patent (express permission practice patent covenant sue patent infringement). “grant” patent license party means make agreement commitment enforce patent party. convey covered work, knowingly relying patent license, Corresponding Source work available anyone copy, free charge terms License, publicly available network server readily accessible means, must either (1) cause Corresponding Source available, (2) arrange deprive benefit patent license particular work, (3) arrange, manner consistent requirements License, extend patent license downstream recipients. “Knowingly relying” means actual knowledge , patent license, conveying covered work country, recipient’s use covered work country, infringe one identifiable patents country reason believe valid. , pursuant connection single transaction arrangement, convey, propagate procuring conveyance , covered work, grant patent license parties receiving covered work authorizing use, propagate, modify convey specific copy covered work, patent license grant automatically extended recipients covered work works based . patent license “discriminatory” include within scope coverage, prohibits exercise , conditioned non-exercise one rights specifically granted License. may convey covered work party arrangement third party business distributing software, make payment third party based extent activity conveying work, third party grants, parties receive covered work , discriminatory patent license () connection copies covered work conveyed (copies made copies), (b) primarily connection specific products compilations contain covered work, unless entered arrangement, patent license granted, prior 28 March 2007. Nothing License shall construed excluding limiting implied license defenses infringement may otherwise available applicable patent law.","code":""},{"path":"https://mjanuario.github.io/evolved/LICENSE.html","id":"id_12-no-surrender-of-others-freedom","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"12. No Surrender of Others’ Freedom","title":"GNU General Public License","text":"conditions imposed (whether court order, agreement otherwise) contradict conditions License, excuse conditions License. convey covered work satisfy simultaneously obligations License pertinent obligations, consequence may convey . example, agree terms obligate collect royalty conveying convey Program, way satisfy terms License refrain entirely conveying Program.","code":""},{"path":"https://mjanuario.github.io/evolved/LICENSE.html","id":"id_13-use-with-the-gnu-affero-general-public-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"13. Use with the GNU Affero General Public License","title":"GNU General Public License","text":"Notwithstanding provision License, permission link combine covered work work licensed version 3 GNU Affero General Public License single combined work, convey resulting work. terms License continue apply part covered work, special requirements GNU Affero General Public License, section 13, concerning interaction network apply combination .","code":""},{"path":"https://mjanuario.github.io/evolved/LICENSE.html","id":"id_14-revised-versions-of-this-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"14. Revised Versions of this License","title":"GNU General Public License","text":"Free Software Foundation may publish revised /new versions GNU General Public License time time. new versions similar spirit present version, may differ detail address new problems concerns. version given distinguishing version number. Program specifies certain numbered version GNU General Public License “later version” applies , option following terms conditions either numbered version later version published Free Software Foundation. Program specify version number GNU General Public License, may choose version ever published Free Software Foundation. Program specifies proxy can decide future versions GNU General Public License can used, proxy’s public statement acceptance version permanently authorizes choose version Program. Later license versions may give additional different permissions. However, additional obligations imposed author copyright holder result choosing follow later version.","code":""},{"path":"https://mjanuario.github.io/evolved/LICENSE.html","id":"id_15-disclaimer-of-warranty","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"15. Disclaimer of Warranty","title":"GNU General Public License","text":"WARRANTY PROGRAM, EXTENT PERMITTED APPLICABLE LAW. EXCEPT OTHERWISE STATED WRITING COPYRIGHT HOLDERS /PARTIES PROVIDE PROGRAM “” WITHOUT WARRANTY KIND, EITHER EXPRESSED IMPLIED, INCLUDING, LIMITED , IMPLIED WARRANTIES MERCHANTABILITY FITNESS PARTICULAR PURPOSE. ENTIRE RISK QUALITY PERFORMANCE PROGRAM . PROGRAM PROVE DEFECTIVE, ASSUME COST NECESSARY SERVICING, REPAIR CORRECTION.","code":""},{"path":"https://mjanuario.github.io/evolved/LICENSE.html","id":"id_16-limitation-of-liability","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"16. Limitation of Liability","title":"GNU General Public License","text":"EVENT UNLESS REQUIRED APPLICABLE LAW AGREED WRITING COPYRIGHT HOLDER, PARTY MODIFIES /CONVEYS PROGRAM PERMITTED , LIABLE DAMAGES, INCLUDING GENERAL, SPECIAL, INCIDENTAL CONSEQUENTIAL DAMAGES ARISING USE INABILITY USE PROGRAM (INCLUDING LIMITED LOSS DATA DATA RENDERED INACCURATE LOSSES SUSTAINED THIRD PARTIES FAILURE PROGRAM OPERATE PROGRAMS), EVEN HOLDER PARTY ADVISED POSSIBILITY DAMAGES.","code":""},{"path":"https://mjanuario.github.io/evolved/LICENSE.html","id":"id_17-interpretation-of-sections-15-and-16","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"17. Interpretation of Sections 15 and 16","title":"GNU General Public License","text":"disclaimer warranty limitation liability provided given local legal effect according terms, reviewing courts shall apply local law closely approximates absolute waiver civil liability connection Program, unless warranty assumption liability accompanies copy Program return fee. END TERMS CONDITIONS","code":""},{"path":"https://mjanuario.github.io/evolved/LICENSE.html","id":"how-to-apply-these-terms-to-your-new-programs","dir":"","previous_headings":"","what":"How to Apply These Terms to Your New Programs","title":"GNU General Public License","text":"develop new program, want greatest possible use public, best way achieve make free software everyone can redistribute change terms. , attach following notices program. safest attach start source file effectively state exclusion warranty; file least “copyright” line pointer full notice found. Also add information contact electronic paper mail. program terminal interaction, make output short notice like starts interactive mode: hypothetical commands show w show c show appropriate parts General Public License. course, program’s commands might different; GUI interface, use “box”. also get employer (work programmer) school, , sign “copyright disclaimer” program, necessary. information , apply follow GNU GPL, see <http://www.gnu.org/licenses/>. GNU General Public License permit incorporating program proprietary programs. program subroutine library, may consider useful permit linking proprietary applications library. want , use GNU Lesser General Public License instead License. first, please read <http://www.gnu.org/philosophy/--lgpl.html>.","code":"<one line to give the program's name and a brief idea of what it does.> Copyright (C) <year>  <name of author>  This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.  This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.  You should have received a copy of the GNU General Public License along with this program.  If not, see <http://www.gnu.org/licenses/>. <program>  Copyright (C) <year>  <name of author> This program comes with ABSOLUTELY NO WARRANTY; for details type 'show w'. This is free software, and you are welcome to redistribute it under certain conditions; type 'show c' for details."},{"path":"https://mjanuario.github.io/evolved/articles/birthdeath_deeptime.html","id":"learning-objectives","dir":"Articles","previous_headings":"","what":"Learning objectives","title":"Birth-death models and deep time","text":"birth-death (BD) model Deterministic expectations birth-death model Estimation simple birth-death Effects variation net diversification rate birth-death model stochastic process Adding extinction Age-richness models empirical richness time","code":""},{"path":"https://mjanuario.github.io/evolved/articles/birthdeath_deeptime.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Birth-death models and deep time","text":"Today work main mathematical model used diversity dynamics: birth-death model. main idea model simple: instant time, species can () split two, (II) go extinct, (III) nothing. model can fully described (.e. parameterized) rate speciation (“births”) rate extinction (“deaths”).","code":"library(evolved)"},{"path":"https://mjanuario.github.io/evolved/articles/birthdeath_deeptime.html","id":"the-birth-death-bd-model","dir":"Articles","previous_headings":"","what":"The birth-death (BD) model","title":"Birth-death models and deep time","text":"birth-death model simple stochastic process widely used quantitatively study diversification (speciation extinction). used contexts well, ecology physics. birth-death model use two parameters: SS, rate speciation (rate one species split two species), EE rate extinction. Usually, rates “per capita” (“per lineage”), meaning total rate speciation clade N species N×SN \\times S N×EN \\times E extinction. compound parameter S−ES - E known net diversification rate: rate new species produced, minus rate go extinct. S−E>0S - E > 0, net production new species positive clade tends increase exponentially diversity time. S−E<0S - E < 0, clade lose species time average, meaning clade strongly biased go extinct.","code":""},{"path":"https://mjanuario.github.io/evolved/articles/birthdeath_deeptime.html","id":"glossary","dir":"Articles","previous_headings":"The birth-death (BD) model","what":"Glossary:","title":"Birth-death models and deep time","text":"S=S = speciation rate (per lineage) E=E = extinction rate (per lineage) S−E=R=S - E = R = net diversification rate K=ES=K = \\frac{E}{S} = relative extinction rate (becomes important later) pure-birth model: special type birth-death model speciation happens (.e., E = 0)","code":""},{"path":"https://mjanuario.github.io/evolved/articles/birthdeath_deeptime.html","id":"deterministic-expectations-of-the-bd-model","dir":"Articles","previous_headings":"","what":"Deterministic expectations of the BD model","title":"Birth-death models and deep time","text":"expected species richness birth-death model : Nt=N0*et(S−E)\\begin{equation} N_t = N_0 * e^{t (S - E)} \\end{equation} N0N_0 starting number species, tt elapsed time, NtN_t number species time tt. just simple exponential growth model ’ve seen (recall intro popgen vignette, discussed Malthusian growth), except now dealing birth death rates species individuals.","code":""},{"path":"https://mjanuario.github.io/evolved/articles/birthdeath_deeptime.html","id":"estimation-under-the-simplest-bd","dir":"Articles","previous_headings":"","what":"Estimation under the simplest BD","title":"Birth-death models and deep time","text":"Let’s imagine interested diversification mammals, currently around 5500 extant species. Can estimate fast mammals diversified time? Assume know first mammals existed 164.9164.9 million years ago. time point, N=1N = 1 species group. Thus, initiate model Nt=5500N_t = 5500, N0=1N_0 = 1, t=164.9t = 164.9. estimate R=S−ER = S - E? can make simple estimator net diversification rate RR birth-death process just rearranging equation (1) . start : Nt=N0*eRt\\begin{equation} N_t = N_0 * e^{Rt} \\end{equation} solve R, giving: R=log(Nt)−log(N0)t\\begin{equation} R = \\frac{log(N_t) - log(N_0)}{t} \\end{equation}","code":""},{"path":[]},{"path":"https://mjanuario.github.io/evolved/articles/birthdeath_deeptime.html","id":"the-birth-death-model-is-a-stochastic-process","dir":"Articles","previous_headings":"","what":"The birth-death model is a stochastic process","title":"Birth-death models and deep time","text":"Let’s imagine RR ’ve computed mammals Q3 fact true RR. replayed tape life mammals many times, allowing clade diversify (always starting one species). think get exact number species every time? explore , simulate evolutionary histories mammals value RR. Fundamentally, birth-death process stochastic. ’ve speaking SS EE rates, appropriate now think relative probabilities – relative probabilities species alive simulation either split two die, respectively. Simulating birth-death process easy, details involve basic probability theory calculus go beyond scope . , given function simulates number species clade, given set parameters. simulate single evolutionary history starting N0=2N_0 = 2 species, t=10t = 10 million years, S=1S = 1 extinction (.e. E=0E= 0), type: Try : Simulate history mammals using function simulateBirthDeathRich(). get something close true value 5500 species?","code":"simulateBirthDeathRich(t = 10, S = 1, E = 0) ## [1] 14759"},{"path":"https://mjanuario.github.io/evolved/articles/birthdeath_deeptime.html","id":"adding-in-extinction","dir":"Articles","previous_headings":"","what":"Adding in extinction","title":"Birth-death models and deep time","text":"previous exercises, ignoring extinction setting E=0E = 0. fossil record tells us extinction rate nearly equal speciation rate much history mammals. , let’s assume E 99% speciation rate, K = E/S = 0.99.","code":""},{"path":"https://mjanuario.github.io/evolved/articles/birthdeath_deeptime.html","id":"age-richness-models-and-empirical-richness-through-time","dir":"Articles","previous_headings":"","what":"Age-richness models and empirical richness through time","title":"Birth-death models and deep time","text":"Now, apply method real richness curve, compare estimates actual data. use dataset provided Rabosky & Benson (2021). First read data. can select among many possible clades run analysis: anth = Anthozoan corals art = Articulata (extant subclass “sea lilies” “feather stars” within Echinodermata) biv = Bivalve mollusks bryo = Bryozoans ceph = Cephalopod mollusks chon = Cartilaginous fishes crin = extinct “sea lilies” “feather stars” ech = Sea urchins gast = Gastropod mollusks ling = class brachiopods ostr = class Crustaceans tril = Trilobites foram = Foraminifers dinosauria = Non-avian, extinct dinosaurs graptoloids = extinct group colonial animals fit birth-death model clade’s diversification trajectory, instead using present reference point NtN_t, calculating diversity trajectory present day, choose arbitrary point past use reference point instead. allow us project birth-death model actual present, see model can properly predict diversity changed since arbitrary reference point past. , following: Step 1: Choose dataset.  Step 2: Choose point time data.  Step 3: Estimate R using methods . saw , estimate R, need know NtN_t, N0N_0, tt. Let’s use arbitrary reference time point, 201 Mya, ‘present’, calculate values terms.  current axis scale allow us properly visualize discrepancy prediction data. let’s plot , re-scaling y-axis:  think? model fit data well? Now, let’s divide error estimates actual data determine scale error , terms percentage.","code":"data(\"timeseries_fossil\") unique(timeseries_fossil$clade) ##  [1] \"anth\"        \"art\"         \"biv\"         \"bryo\"        \"ceph\"        ##  [6] \"chon\"        \"crin\"        \"ech\"         \"gast\"        \"ling\"        ## [11] \"ostr\"        \"tril\"        \"foram\"       \"graptoloids\" \"dinosauria\" # Here we will use dinosaurs: dino_rich <- timeseries_fossil[timeseries_fossil$clade==\"dinosauria\",] head(dino_rich) ##          clade     source stem_age rel_time time_ma richness ## 569 dinosauria Benson2016    251.9    175.9      76      853 ## 570 dinosauria Benson2016    251.9    170.9      81      878 ## 571 dinosauria Benson2016    251.9    165.9      86      840 ## 572 dinosauria Benson2016    251.9    160.9      91      748 ## 573 dinosauria Benson2016    251.9    155.9      96      748 ## 574 dinosauria Benson2016    251.9    150.9     101      791 unique(dino_rich$time_ma) ##  [1]  76  81  86  91  96 101 106 111 116 121 126 131 136 141 146 151 156 161 166 ## [20] 171 176 181 186 191 196 201 206 211 216 221 # We will use the early Jurassic, around 201 Mya, as our reference for this analysis t_obs <- 201  rich_early_J <- dino_rich$richness[dino_rich$time_ma==t_obs]  # species richness from this time point rich_early_J ## [1] 278 # plotting our data and our point of observation: plot(x = dino_rich$time_ma,      y=dino_rich$richness,      xlim=c(max(dino_rich$time_ma), min(dino_rich$time_ma)),      xlab = \"Millions of years ago\", ylab = \"Dino species richness\")  # connecting the dots: lines(x = dino_rich$time_ma,      y=dino_rich$richness)  # highlighting the point we will pick: points(x=t_obs, y=rich_early_J, col=\"red\", pch=16) abline(v=t_obs, col=\"red\") # Richness at the stem age of the dinosaurs: rich_0 <- 1  # The start age of our clade marks time 0 for diversification: t0 = dino_rich$stem_age[1]  # Since we now know N_t, N_0, and the elapsed time, calculate R: R_dino = (log(rich_early_J) - log(1)) / (t0 - t_obs) R_dino ## [1] 0.1105623 # Plot our data and project the richness since the beginning of our time series: time_from_t0 = t0 - dino_rich$time_ma  projected_rich = rich_0 * exp(R_dino * time_from_t0)  # Finally, we calculate the difference between our projections and the data: projected_rich-dino_rich$richness ##  [1]  2.793303e+08  1.607067e+08  9.245907e+07  5.319421e+07  3.060391e+07 ##  [6]  1.760699e+07  1.012955e+07  5.827550e+06  3.352453e+06  1.928400e+06 ## [11]  1.109044e+06  6.377082e+05  3.667199e+05  2.107627e+05  1.210567e+05 ## [16]  6.938300e+04  3.960939e+04  2.265741e+04  1.281673e+04  7.171539e+03 ## [21]  4.070215e+03  2.327329e+03  1.298801e+03  6.788675e+02  2.542010e+02 ## [26] -5.684342e-14 -6.205826e+01 -1.179807e+02 -1.630585e+02 -2.045412e+02 # Plotting the difference between our projections and the data: plot(x = dino_rich$time_ma,      y=dino_rich$richness,      xlim=c(max(dino_rich$time_ma), min(dino_rich$time_ma)),      ) # Connecting the dots: lines(x = dino_rich$time_ma,      y=dino_rich$richness)  # Highlighting our point of observation again: points(x=t_obs, y=rich_early_J, col=\"red\", pch=16)  # Now, we will add the predicted richness curve based on our estimations: lines(x = dino_rich$time_ma,      y=projected_rich, col=\"red\")  #Finally, we plot the differences between our projections and our data using bars: segments(x0 = dino_rich$time_ma,          x1 = dino_rich$time_ma,          y0 = dino_rich$richness,          y1 = projected_rich,          col=\"red\") #we can plot the data again, this time with extra care with the scale of our axes: plot(x = dino_rich$time_ma,      y=dino_rich$richness,      xlim=c(max(dino_rich$time_ma), min(dino_rich$time_ma)),            #we will change the y-axis limits to fit all our calculations:      ylim=c(        min(c(dino_rich$richness, projected_rich)),         max(c(dino_rich$richness, projected_rich))),      )  #connecting the dots: lines(x = dino_rich$time_ma,      y=dino_rich$richness)  #highlighting our observation point: points(x=t_obs, y=rich_early_J, col=\"red\", pch=16)  #adding the predictions of the model: lines(x = dino_rich$time_ma,      y=projected_rich, col=\"red\")  #Finally, we plot the differences between our projections and our data using bars: segments(x0 = dino_rich$time_ma,          x1 = dino_rich$time_ma,          y0 = dino_rich$richness,          y1 = projected_rich,          col=\"red\") perc_error <- (projected_rich - dino_rich$richness)/dino_rich$richness * 100  min(perc_error) ## [1] -87.03881 max(perc_error) ## [1] 32746816 hist(perc_error, xlab = \"Error as a percentage of the data\")"},{"path":"https://mjanuario.github.io/evolved/articles/birthdeath_deeptime.html","id":"some-food-for-thought","dir":"Articles","previous_headings":"","what":"Some food for thought:","title":"Birth-death models and deep time","text":"think estimator can underestimate 87% can overestimate data 32,746,816%? many species dinosaurs model predict immediately asteroid impact (mass extinction) K-Pg boundary? think estimate? answering, consider current estimates total number species Earth fewer 10 million species overall.","code":"proj_rich_dinos_KPg <- (R_dino +1)^(dino_rich$stem_age[1]-66) proj_rich_dinos_KPg ## [1] 292704971"},{"path":"https://mjanuario.github.io/evolved/articles/birthdeath_deeptime.html","id":"references","dir":"Articles","previous_headings":"","what":"References:","title":"Birth-death models and deep time","text":"Rabosky, D. L., & Benson, R. B. (2021). Ecological biogeographic drivers biodiversity resolved using clade age-richness data. Nature communications, 12(1), 1-10.","code":""},{"path":"https://mjanuario.github.io/evolved/articles/birthdeath_phylogenies.html","id":"learning-objectives","dir":"Articles","previous_headings":"","what":"Learning objectives","title":"Birth-death models and molecular phylogenies","text":"Estimating diversification rates pure birth Estimating diversification rates birth-death affects speciation extinction?","code":""},{"path":"https://mjanuario.github.io/evolved/articles/birthdeath_phylogenies.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Birth-death models and molecular phylogenies","text":"First, load required packages:","code":"library(LSD) library(ape) library(BAMMtools) library(evolved)  # Let's also store our par() configs so  # we can restore them whenever we change it in this tutorial oldpar <- par(no.readonly = TRUE)"},{"path":"https://mjanuario.github.io/evolved/articles/birthdeath_phylogenies.html","id":"simulating-phylogenetic-trees","dir":"Articles","previous_headings":"","what":"Simulating phylogenetic trees","title":"Birth-death models and molecular phylogenies","text":"Molecular phylogenies built DNA sequences therefore include extant species. vignette, simulate analyze “ideal” versions molecular phylogenies. know previous vignettes using molecular phylogenies directly (“naively”) can lead spurious conclusions, phylogenies missing lot information. Despite limitation, still lot can learn speciation extinction molecular phylogenies. today. dive realm molecular phylogenies, keep mind groups organisms good fossil records. cases, phylogenetic trees extant species often information ever rates speciation /extinction groups. simulating molecular phylogenies function package evolved, let’s first check arguments simulateTree(). pars = vector containing speciation extinction rates, written c(S, E). max.taxa = Maximum number taxa include tree. min.taxa = Minimum number taxa include tree. max.t = Maximum time simulation. include.extinct = logical (TRUE FALSE) describing phylogeny include lineages went extinct simulation ended. function carries simulation diversification, resulting phylogenetic tree traces relationships taxa speciated went extinct simulation. Speciation simulated one lineage “giving birth” another, bifurcating two new species. Extinction course complete disappearance “death” lineage. Whether events occur occur dependent random number draw. Also, simulation keeps track many time steps passed since initiation. simulation ends either () amount elapsed time surpasses maximum time simulation, given parameter max.t, (b) number lineages existing (“alive”) current time step surpasses maximum number taxa, given parameter max.taxa. two cases “stopping criteria” simulation, either occurs, simulation terminates outputs phylogenetic tree. Now understand going “hood” simulation, let’s try run one. Initiate simulation follows: ape package R provides nice functions visualizing manipulating phylogenetic trees. , use function package plot phylogenetic tree just simulated:  Run another simulation plot . plot others. time , vary values insert speciation extinction rates (vector pass pars argument), particularly focus increasing decreasing difference values. Take note trees vary. , may find absolute magnitude branch lengths (total number lines) depends diversification rate (S−ES - E), though tree shape (general structure, topology) . Tree shape , however, highly sensitive relative extinction rate, K=E/SK = E / S. get sense , simulate phylogeny small relative extinction (E/S=0.05E / S = 0.05), pure-birth tree (E/S=0E / S = 0) comparison. Note: doesn’t make much sense specify E/S>=1E / S >= 1 evolutionary process almost always go extinct speciating, thus leaving tree – omit case. make easier visualization, increase maximum taxa parameter 6 100 tips. Let’s plot trees side side.  Now visualize lineage--time (LTT) plots trees, just like weeks ago. LTT plots contain lot information phylogenetic tree structure. Let’s see can tell us shape trees produced different speciation extinction rates.    plot , grey line represents expected mean lineages time pure-birth process. already know, birth-death process stochastic model, even though average number species tends follow line, usually actual number species (.e., blue line) vary. surprised? Think ’ve just seen: compared two (three) phylogenies, zero extinct species shown… yet, appears something seems different trees! expected? fact trees extant species might information extinction, even though observed extinction tree, potentially useful! extra exercise build intuition, check LTT plots S = 0.001, 0.01, 0.1, 1.0. Now, going apply simplest possible estimator speciation rate simulated phylogenetic trees test much information contain true rates speciation extinction. included simple function, estimateSpeciation(), compute “best” estimate speciation given tree, assuming extinction. wondering, indeed possible allowing extinction nonzero later lab, mathematics complicated. ’ll start simpler model. First, let’s generate couple phylogenies estimate SS see well correspond. Now sense accuracy estimator, let’s simulate 100 phylogenetic trees variable speciation rates apply simple estimator. can ask correlated estimates true rates. words, well can recover true rates using simple estimator? Let’s check estimates (notice warm colors mean points aggregated): speciation rates:  Remember phylogenies created pure-birth process, thus need estimate extinction rates. Now might ask: extinction really zero? bad speciation estimates ? explore , let’s simulate set phylogenies low high relative extinction (E / S = 0.05 E / S = 0.95) thing previously, estimating speciation simple (pure birth) estimator. wait next chunk code run, answer question just : Let’s check estimates E/S=0.05E/S = 0.05 case. speciation rates:  Now, use complex estimation procedure. estimate parameters using sophisticated estimator allows extinction speciation rates nonzero. mathematics beyond scope vignette, provided handy function model-fitting , assuming rates constant (time species): fitCRBD(). example: Let’s repeat simulation procedure, time fit model extinction can nonzero. won’t display plots , feel free copy paste code R console see results ! NOTE: see message Error simulateTree(pars = c(sim_S, sim_E), max.taxa = 50) : many trees going extinct just run chunk code . Don’t forget check estimates speciation rate: extinction-speciation ratio: Note: adequate directly correlate simulated estimated extinction rates. happens can generate phylogenies E<SE < S, thus allow extinction vary way completely independent speciation. However, correlate simulated estimate K=E/SK = E/S, ameliorate particular issue enough (vignette). Think moment result simulation. actually fit constant-rate birth-death model constant-rate simulated phylogeny. reasons expect real phylogenies constant – especially true clades older colonized many different environments. scatterplot just saw ceiling well extinction rates can possibly estimated. empirical example next section focus attention speciation rates can estimated higher precision molecular phylogenies. Remember, though, extinction potentially important speciation terms factors shape temporal diversity dynamics.","code":"args(simulateTree) ## function (pars, max.taxa = Inf, max.t, min.taxa = 2, include.extinct = FALSE)  ## NULL # Set parameters for simulation S <- 1 E <- 0  # Set seed so we all get same results set.seed(1)  # First, generate tree with no extinction and 6 tips tree_pb <- simulateTree(pars = c(S, E), max.taxa = 6, max.t = 10)  # Then we reset the seed. From now on, you will  # have different results each time you run a phylogeny: set.seed(NULL) plot.phylo(tree_pb, show.tip.label=F)  # Add a timescale (in Mya, and zero is the time the simulation stopped): axisPhylo() # Generating tree with high relative extinction and 100 tips tree_lowE <- simulateTree(pars=c(1, 0.05), max.taxa=100, max.t = Inf)  # And a pure birth tree, holding all arguments the same except with no extinction: tree_pb <- simulateTree(pars=c(0.01, 0), max.taxa=100, max.t = Inf) plot.new() par(mfrow=c(1,2), mar=c(0,0,0,0)) plot.phylo(tree_pb, show.tip.label=F) plot.phylo(tree_lowE, show.tip.label=F) # Restoring old par() configs: par(oldpar) # plot lineage through time plots: lttPlot(tree_pb, col = \"blue\", knitr = T) lttPlot(tree_lowE, col = \"red\", knitr = T) # or, in a single plot:  plot(x=c(0,1), y = c(log(2), log(100)), lwd=1, col=\"gray50\", type = \"l\") lttPlot(tree_pb, rel.time=T, add=T, col=\"blue\", lwd=1.5, knitr = T) lttPlot(tree_lowE, rel.time=T, add=T, col=\"red\", lwd=1.5, knitr = T) tree1 <- simulateTree(c(0.5, 0), max.taxa = 40, max.t = Inf)  tree2 <- simulateTree(c(1, 0), max.taxa = 40, max.t = Inf)  tree3 <- simulateTree(c(5, 0), max.taxa = 40, max.t = Inf)  matrix(c(estimateSpeciation(tree1), estimateSpeciation(tree2), estimateSpeciation(tree3),          0.5, 1, 5), ncol = 2, dimnames = list(NULL, c(\"Estimated\", \"True\"))) ##      Estimated True ## [1,] 0.4903825  0.5 ## [2,] 1.0023898  1.0 ## [3,] 6.3873873  5.0 REPS <- 1000 x <- numeric(REPS) res <- data.frame(true_S=x, true_E=x, est_S=x)  for(i in 1:REPS){    # pick a speciation rate with any value between 0 and 2:     sim_S <- runif(1, min = 0, max = 2)     # in the pure birth, extinction rate is always zero     sim_E <- 0          # simulate tree:         tree_sim <- simulateTree(pars=c(sim_S, sim_E),                               max.taxa=50, max.t = Inf)       #fitting the model:     fit <- estimateSpeciation(tree_sim)          res$true_S[i] <- sim_S     res$true_E[i] <- sim_E      res$est_S[i] <- fit } heatscatter(res$true_S, res$est_S,              xlab = \"Simulated speciation rate\",             ylab=\"Estimated speciation rate\")  # Then,we add the 1:1 line  (i.e. a perfect estimation) abline(a = 0, b = 1, lwd=2) REPS <- 1000 x <- numeric(REPS) res <- data.frame(true_S=x, true_E=x, est_S=x)  for(i in 1:REPS){    # Pick a speciation rate with any value between 0 and 2:     sim_S <- runif(1, min = 0, max = 2)     # Now we will change the extinction fraction to always equal 0.05     sim_E <- sim_S * 0.05          # simulate tree:         tree_sim <- simulateTree(pars=c(sim_S, sim_E),                               max.taxa=50, max.t = Inf)       #fitting the model:     fit <- estimateSpeciation(tree_sim)          res$true_S[i] <- sim_S     res$true_E[i] <- sim_E      res$est_S[i] <- fit } heatscatter(res$true_S, res$est_S,              xlab = \"Simulated speciation rate\",             ylab=\"Estimated speciation rate\")  #Then,we add the 1:1 line  (i.e. a perfect estimation) abline(a = 0, b = 1, lwd=2) tree <- simulateTree(c(1, 0.95), max.taxa = 50, max.t = Inf)  # estimating: fitCRBD(tree) ##        S        E  ## 1.577785 1.515479 REPS <- 1000 x <- numeric(REPS) res <- data.frame(true_S=x, true_E=x, est_S=x, est_E=x)  for(i in 1:REPS){    # pick a speciation rate with any value between 0 and 2:     sim_S <- runif(1, min = 0, max = 2)     # pick a relative extinction rate:     rel_ex <- runif(1  , 0, 0.95)     # calculate E from that extinction fraction     sim_E <- sim_S * rel_ex           # simulate tree:         tree_sim <- simulateTree(pars=c(sim_S, sim_E),                               max.taxa=50, max.t = 1000)       # fitting the model:     fit <- fitCRBD(tree_sim)          res$true_S[i] <- sim_S     res$true_E[i] <- sim_E      res$est_S[i] <- fit[\"S\"]     res$est_E[i] <- fit[\"E\"] } heatscatter(res$true_S, res$est_S,              xlab = \"Simulated speciation rate\",             ylab=\"Estimated speciation rate\")  # Then,we add the 1:1 line  (i.e. a perfect estimation) abline(a = 0, b = 1, lwd=2)  # Making a simple linear model: S_lm <- lm(res$est_S~res$true_S)  # And checking how much variation is explained summary(S_lm)$r.squared sim_K = res$true_E/res$true_S est_K = res$est_E/res$est_S  LSD::heatscatter(sim_K, est_K,                   xlab = \"Simulated E/S\",                  ylab=\"Estimated E/S\")  #making a simple linear model: K_lm <- lm(est_K~sim_K) summary(K_lm)$r.squared  #Then,we add the 1:1 line  (i.e. a perfect estimation) abline(a = 0, b = 1, lwd=2)"},{"path":"https://mjanuario.github.io/evolved/articles/birthdeath_phylogenies.html","id":"what-affects-speciation-and-extinction","dir":"Articles","previous_headings":"","what":"What affects speciation and extinction?","title":"Birth-death models and molecular phylogenies","text":"Another layer complexity real phylogenies might possibility diversification rates can vary among lineages. may happen traits differ lineages affect speciation extinction rates. test , use molecular, time-calibrated phylogeny whales, already included dataset package BAMMtools. can access typing: Note many different types whales included :  One might argue species high dispersal capacity less likely speciate, can maintain population connectivity (.e., high gene flow) larger geographic areas (similarly disucssed Kisel Barraclough 2010). general, body size correlates dispersal distance across vertebrates, might expect large-bodied whales higher dispersal capacity small-bodied whales. Thus, might predict association body size speciation rate across whales, given significant variation whale body size. Now, let’s test correlation. , first load data whale mass (originally downloaded PanTheria; Jones et al, 2009) species-specific speciation rates (originally downloaded Rabosky, 2014)). Species-specific speciation rates estimated fitting birth-death models molecular phylogenies allowing diversification rates vary time among clades. provide Rabosky’s (2014) results quick exploration analysis using model might conducted. Let’s make simple scatterplot, coloring points clade. , add simple linear model body mass speciation rate.  think? relationship support hypothesis size influences speciation rate? answer, let’s plot data phylogeny.","code":"data(\"whale_phylo\") par(cex=0.6) plotPaintedWhales(knitr = T) ## no colors provided. using the following legend: ##                    1        Baleen whales        Beaked whales  ##              \"black\"            \"#DF536B\"            \"#61D04F\"  ## Belugas and narwhals             Dolphins     Other mysticetes  ##            \"#2297E6\"            \"#28E2E5\"            \"#CD0BBC\"  ##            Porpoises  ##            \"#F5C710\" # Restoring old par() configs: par(oldpar) data(data_whales) head(data_whales) ##                      species log_mass          S   color ## 1         Balaena_mysticetus 18.19367 0.07272368 #CD0BBC ## 2 Balaenoptera_acutorostrata 15.53597 0.07111798 #DF536B ## 3      Balaenoptera_borealis 16.91137 0.07108088 #DF536B ## 4         Balaenoptera_edeni 16.81124 0.07075967 #DF536B ## 5      Balaenoptera_musculus 18.85455 0.07173890 #DF536B ## 6      Balaenoptera_physalus 17.67637 0.07172809 #DF536B plot(x=data_whales$log_mass, data_whales$S, pch = 16,      xlab=\"Mass (log(g))\", ylab=\"Speciation rate\", col=data_whales$color) legend(x=\"topright\",legend=c(\"other odontocetes\",\"Baleen whales\",       \"Beaked whales\",\"Belugas and narwhals\",       \"Dolphins\",\"Other mysticetes\",\"Porpoises\"),     pch=16,pt.cex=1.5,pt.bg=c(\"black\", \"#DF536B\",\"#61D04F\",\"#2297E6\",\"#28E2E5\", \"#CD0BBC\",\"#F5C710\"),bty=\"n\")  # Then we construct a linear model: whales_lm <- lm(data_whales$S~data_whales$log_mass) summary(whales_lm) ##  ## Call: ## lm(formula = data_whales$S ~ data_whales$log_mass) ##  ## Residuals: ##       Min        1Q    Median        3Q       Max  ## -0.111355 -0.038805  0.004617  0.047447  0.090063  ##  ## Coefficients: ##                       Estimate Std. Error t value Pr(>|t|)     ## (Intercept)           0.372832   0.036345  10.258 8.51e-16 *** ## data_whales$log_mass -0.017881   0.002662  -6.716 3.48e-09 *** ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 ##  ## Residual standard error: 0.052 on 73 degrees of freedom ## Multiple R-squared:  0.3819, Adjusted R-squared:  0.3735  ## F-statistic: 45.11 on 1 and 73 DF,  p-value: 3.483e-09 abline(whales_lm, col=\"red\")"},{"path":"https://mjanuario.github.io/evolved/articles/birthdeath_phylogenies.html","id":"shifts-in-diversification-rates","dir":"Articles","previous_headings":"What affects speciation and extinction?","what":"Shifts in diversification rates","title":"Birth-death models and molecular phylogenies","text":"Recall real phylogenies, diversification rates can vary among clades time, one possible question : shifts phylogeny? can use datasets whales package BAMMtools explore possibility. Let’s read files draw color-coded phylogeny warmer colors indicate higher speciation rates. , phylogeny right contains information speciation rate, one right merely color-coded clade.","code":"data(whales) data(events.whales) x <- getEventData(whales, events.whales, burnin = 0.1) ## Processing event data from data.frame ##  ## Discarded as burnin: GENERATIONS <  995000 ## Analyzing  1801  samples from posterior ##  ## Setting recursive sequence on tree... ##  ## Done with recursive sequence par(mfrow=c(1,2)) #making a panel  plotPaintedWhales(ftype=\"off\", direction=\"rightwards\", mar=c(5.1,0,2.1,2.1), show.legend = TRUE, knitr = T) ## no colors provided. using the following legend: ##                    1        Baleen whales        Beaked whales  ##              \"black\"            \"#DF536B\"            \"#61D04F\"  ## Belugas and narwhals             Dolphins     Other mysticetes  ##            \"#2297E6\"            \"#28E2E5\"            \"#CD0BBC\"  ##            Porpoises  ##            \"#F5C710\" plot.bammdata(x, lwd = 3, mar=c(5.1,0,2.1,2.1), direction = \"leftwards\")  # Restoring old par() configs: par(oldpar)"},{"path":"https://mjanuario.github.io/evolved/articles/birthdeath_phylogenies.html","id":"references","dir":"Articles","previous_headings":"","what":"References:","title":"Birth-death models and molecular phylogenies","text":"Jones, K. E., Bielby, J., Cardillo, M., Fritz, S. ., O’Dell, J., Orme, C. D. L., … & Purvis, . (2009). PanTHERIA: species‐level database life history, ecology, geography extant recently extinct mammals: Ecological Archives E090‐184. Ecology, 90(9), 2648-2648. Kisel, Y., & Barraclough, T. G. (2010). Speciation spatial scale depends levels gene flow. American Naturalist, 175(3), 316-334. Rabosky, D. L. (2014). Automatic detection key innovations, rate shifts, diversity-dependence phylogenetic trees. PloS one, 9(2), e89543.","code":""},{"path":"https://mjanuario.github.io/evolved/articles/deeptime_clocks.html","id":"learning-objectives","dir":"Articles","previous_headings":"","what":"Learning objectives","title":"DNA sequence evolution","text":"Exploring sequence data simple measure genetic distance Poisson correction Building molecular clock Molecular clocks inferences deep time Jukes-Cantor correction uncertainty molecular clock","code":""},{"path":"https://mjanuario.github.io/evolved/articles/deeptime_clocks.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"DNA sequence evolution","text":"encountered many processes change allele frequency population, today study actual genetic differences among species. also learn use genetic information reconstruct evolutionary past lineages -called “molecular clock”. , use real data molecules estimate divergence (numbers substitutions) homologous proteins different organisms. Homologous sequences, together information fossil record, used “calibrate” rate amino acid substitutions occur protein evolution. specifically, given estimate amount divergence, plus estimate rate divergence occurs, can estimate much time passed since divergence.","code":"#loading packages we will need today: library(ape) library(evolved)"},{"path":"https://mjanuario.github.io/evolved/articles/deeptime_clocks.html","id":"exploring-sequence-data","dir":"Articles","previous_headings":"","what":"Exploring sequence data","title":"DNA sequence evolution","text":"assembled set protein sequences cytochrome oxidase 1 gene. gene, often known CO1 (“see-oh-one”), mitochondrial gene plays key role cellular respiration (e.g., primary aerobic pathway energy ATP generation). CO1 contains approximately 513 amino acids used many studies construct phylogenetic trees estimate divergence times taxa. manually downloaded full-length genes number focal taxa public database GenBank (general info GenBank can found Benson et al., 2012). aligned sequences using CLUSTAL (info Sievers et al., 2011), widely-used sequence alignment tool. dataset included R package, can access simply typing: Now can pull sequence single organism typing: Now, let’s explore sequences little. many sequences ? organisms dataset? long sequence? can access particular sequence typing: can compute number differences typing: Finally, can get length specific sequence typing:","code":"data(\"cytOxidase\") cytOxidase[\"human\"] length(cytOxidase) ## [1] 17 names(cytOxidase) ##  [1] \"cnidaria\"   \"snake\"      \"echinoderm\" \"mollusk\"    \"alligator\"  ##  [6] \"lamprey\"    \"shark\"      \"bird\"       \"frog\"       \"fish\"       ## [11] \"platypus\"   \"human\"      \"chimpanzee\" \"bryozoa\"    \"annelid\"    ## [16] \"insect\"     \"crustacea\" unlist(lapply(cytOxidase, nchar)) ##   cnidaria      snake echinoderm    mollusk  alligator    lamprey      shark  ##        513        513        513        513        513        513        513  ##       bird       frog       fish   platypus      human chimpanzee    bryozoa  ##        513        513        513        513        513        513        513  ##    annelid     insect  crustacea  ##        513        513        513 cytOxidase[\"platypus\"] ##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            platypus  ## \"NRWLFSTNHKDIGTLYLLFGAWAGMAGTALSILIRSELGQPGSLLGDDQIYNVIVTAHAFVMIFFMVMPIMIGGFGNWLVPLMIGAPDMAFPRMNNMSFWLLPPSFLLLLVSSTVEAGAGTGWTVYPPLAGNLAHAGASVDLAIFSLHLAGVSSILGAINFITTIINMKPPAMSQYQTPLFVWSVLITAVLLLLSLPVLAAGITMLLTDRNLNTTFFDPAGGGDPILYQHLFWFFGHPEVYILILPGFGIISHIVTYYSGKKEPFGYMGMVWAMMSIGFLGFIVWAHHMFTVGMDVDTRAYFTSATMIIAIPTGVKVFSWLATLHGGDIKWTPPMLWALGFIFLFTVGGLTGIVLANSSLDIILHDTYYVVAHFHYVLSMGAVFAIMGGFVHWFPLLSGFTLHPTWAKVHFTLMFVGVNLTFFPQHFLGLAGMPRRYSDYPDAYTLWNALSSLGSFVSLTAVMVMIFMIWEAFASKREVLS--VELTTTNIEWLHGC-PPPYHTFEQPVYIKA\" countSeqDiffs(cytOxidase, \"human\", \"alligator\") ## [1] 77 nchar(cytOxidase[\"platypus\"]) ## platypus  ##      513"},{"path":"https://mjanuario.github.io/evolved/articles/deeptime_clocks.html","id":"a-simple-measure-of-genetic-distance","dir":"Articles","previous_headings":"","what":"A simple measure of genetic distance","title":"DNA sequence evolution","text":"mentioned class, simplest genetic distance two sequences just proportion differences (.e., p-distance). Now, lets focus pairs taxa: unfamiliar creating matrices named vectors R, tutorial walk . make named vector, access names attribute vector function names(). assign another vector contains names names attribute vector like : Note repeat names, name must unique. seen , now vector whose values labeled unique identifier. done many times labs, can also access particular value within vector unique name using format: make matrix, use handy function matrix(). Say wanted build matrix counts differences 3 pairs: snake-human, insect-snake, insect-human. First, build skeleton matrix hold data: Let’s take look skeleton matrix. Looks good! Now, fill cell values currently say NA data containing sequence differences pair, can directly subset matrix row, column, cell want using base subsetting R. important thing note matrix symmetric, meaning upper lower triangles . symmetric two cells pair taxa, one value sequence differences pair. Thus, may choose either leave one half matrix blank, repeat values. Like , can manually alter matrix. can also nested loop, though complicated.","code":"human-bird human-chimp human-platypus human-echinoderm cnidaria-insect insect-crustacean annelid-insect chimpanzee-insect chimpanzee-fish platypus-cnidaria frog-lamprey snake-shark insect-mollusk bird-alligator seq_diff_vec <- c(4, 8, 3, 6, 0) # note that these numbers are completely made up names(seq_diff_vec) <- c(\"snake-chimp\", \"human-echinoderm\", \"alligator-insect\",                           \"chimp-echinoderm\", \"human-chimp\")  seq_diff_vec ##      snake-chimp human-echinoderm alligator-insect chimp-echinoderm  ##                4                8                3                6  ##      human-chimp  ##                0 seq_diff_vec[\"snake-chimp\"] ## snake-chimp  ##           4 m <- matrix(data = NA,  # placeholder value for each matrix's cell will be NA                     # (later will be replaced by real data)        nrow = 3,  # one row for each taxon group        ncol = 3,  # one col for each taxon group        dimnames = list(c(\"snake\", \"human\", \"insect\"), # these are the row names                        c(\"snake\", \"human\", \"insect\")) # these are the column names ) m ##        snake human insect ## snake     NA    NA     NA ## human     NA    NA     NA ## insect    NA    NA     NA m[1,] <- c(0, 5, 2) # replacing the entire first row with fake numbers m[2,] <- c(5, 0, 80) # replacing the entire second row with fake numbers m[3,] <- c(2, 80, 0) # repalcing the entire third row with fake numbers m ##        snake human insect ## snake      0     5      2 ## human      5     0     80 ## insect     2    80      0"},{"path":"https://mjanuario.github.io/evolved/articles/deeptime_clocks.html","id":"the-poisson-correction","dir":"Articles","previous_headings":"","what":"The Poisson correction","title":"DNA sequence evolution","text":"extra hints Q8: Hint (1): Make sure entered data correctly! good thing always make sure lengths vectors : Hint (2): can add 1:1 line (perfect correspondence axes) typing following code creates scatterplot:","code":"length(p_dist) # assuming your p-distance vector is named like this length(poiss_dist) # same as above for the poisson-corrected distance abline(a=0, b=1) # note that the arguments are the parameters of the line equation"},{"path":"https://mjanuario.github.io/evolved/articles/deeptime_clocks.html","id":"some-food-for-thought","dir":"Articles","previous_headings":"The Poisson correction","what":"Some food for thought:","title":"DNA sequence evolution","text":"estimate average number substitutions per site occurred since humans chimpanzees shared common ancestor? assumption make get estimate?","code":""},{"path":"https://mjanuario.github.io/evolved/articles/deeptime_clocks.html","id":"building-a-molecular-clock","dir":"Articles","previous_headings":"","what":"Building a molecular clock","title":"DNA sequence evolution","text":"Now, going calibrate molecular clock apply distances computed . rate metaphorical clock “ticks” used compute expected number substitutions per million years. Just reference, phylogeny species dataset:  Note manually set branches equal lengths figure . want now make branches proportional time. calibration, going use single fossil calibrate age -recent ancestor humans birds. Fortunately, extremely useful fossil taxon, Hylonomus known Nova Scotia, thought extremely closely related common ancestor birds mammals. Researchers used age fossil (312 Ma) calibrate molecular clocks. Now, use Poisson-corrected distance birds humans dating estimate rate protein evolution (substitutions per site per million years).","code":""},{"path":[]},{"path":[]},{"path":"https://mjanuario.github.io/evolved/articles/deeptime_clocks.html","id":"some-food-for-thought-1","dir":"Articles","previous_headings":"The Jukes-Cantor correction","what":"Some food for thought:","title":"DNA sequence evolution","text":"happens Jukes-Cantor distance p≥0.75p \\geq 0.75? happen? Hint: Think “multiple hits” means.","code":""},{"path":"https://mjanuario.github.io/evolved/articles/deeptime_clocks.html","id":"the-uncertainty-of-your-molecular-clock","dir":"Articles","previous_headings":"","what":"The uncertainty of your molecular clock","title":"DNA sequence evolution","text":"Now, going look confident original rate estimate, implications . specifically, going generate profile plot “log-transformed probability” (case, log likelihood, term might heard ) function substitution rate parameter. get probability observing specific number mutations, can use dpois() function:","code":"# For instance, what is the probability of observing 10 substitutions in a 37-long  # AA sequence after 10 million years of divergence # if the substitution rate is equal to 0.1 substitutions # per site per million years?  rate_A <- 0.1 AA_seq_length <- 37  obs_subs <- 10  # amount of substitutions that have occurred obs_time <- 10  # amount of time that has passed  prob_given_rate_A <- dpois(   x = obs_subs, lambda = obs_time * rate_A * AA_seq_length)  prob_given_rate_A # this is the likelihood ## [1] 1.130729e-07 # finally, we take the (natural) log, to get # the log-likelihood of observing the data # given the model and the rate value: log(prob_given_rate_A) ## [1] -15.99523 # the questions is, then: what is the likelihood of observing >the same< data  # under different values of substitution rate?"},{"path":"https://mjanuario.github.io/evolved/articles/deeptime_clocks.html","id":"brief-introduction-to-intervals-derived-from-log-likelihood","dir":"Articles","previous_headings":"The uncertainty of your molecular clock","what":"Brief introduction to intervals derived from log-likelihood","title":"DNA sequence evolution","text":"estimating single parameter, likelihood theory shows likelihood value parameter θ\\theta given data xx (.e. L(θ|x)L(\\theta | x)) satisfies following inequality: L(θ|x)≥(MAX(L(θ|x))−1.92)\\begin{equation} L(\\theta | x) \\geq ( MAX(L(\\theta | x)) - 1.92) \\end{equation} provide estimate 95% confidence interval parameter value.","code":""},{"path":"https://mjanuario.github.io/evolved/articles/deeptime_clocks.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"DNA sequence evolution","text":"Benson, D. ., Cavanaugh, M., Clark, K., Karsch-Mizrachi, ., Lipman, D. J., Ostell, J., & Sayers, E. W. (2012). GenBank. Nucleic acids research, 41(D1), D36-D42. Hedges, S. B., & Kumar, S. (2003). Genomic clocks evolutionary timescales. TRENDS Genetics, 19(4), 200-206. Sievers, F., Wilm, ., Dineen, D., Gibson, T. J., Karplus, K., Li, W., … & Higgins, D. G. (2011). Fast, scalable generation high‐quality protein multiple sequence alignments using Clustal Omega. Molecular systems biology, 7(1), 539.","code":""},{"path":"https://mjanuario.github.io/evolved/articles/deeptime_rocks.html","id":"learning-objectives","dir":"Articles","previous_headings":"","what":"Learning objectives","title":"Introduction to the fossil record","text":"Exploring fossil occurrences Diversity patterns deep time spatial distribution record Drawing conclusions fossil record Technical note: Dating fossils absolute time","code":""},{"path":"https://mjanuario.github.io/evolved/articles/deeptime_rocks.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Introduction to the fossil record","text":"Thus far, ’ve typically dealing evolutionary processes occur short timescales – mostly hundred generations. generational scale evolutionary change pales comparison vastness geological time. lab, explore evolutionary history clades tens (sometimes hundreds) millions years, via major source direct evidence deep time: fossil record. tutorial, must install palebioDB R package. , load packages required workspace:","code":"install.packages(\"paleobioDB\") library(evolved) library(paleobioDB)"},{"path":"https://mjanuario.github.io/evolved/articles/deeptime_rocks.html","id":"exploring-fossil-occurrences","dir":"Articles","previous_headings":"","what":"Exploring fossil occurrences","title":"Introduction to the fossil record","text":"’ve downloaded fossil dataset work today (dinos_fossil). occurrence data originally obtained Paleobiology database, free--use resource standard repository data used hundreds thousands researchers study history dynamics biodiversity deep time. kept many occurrences possible original datasets, removed extraneous data (e.g. notes preservation, notes paleoenvironment, original reference data, etc.) make easier use. also removed occurrences poor time resolution (.e., timespan maximum minimum ages strata associated fossil), removed fossil occurrences identified species level. illustrate data look like, let’s read view part dinosaur occurrence data. First, ’ll read file: , ’ll check basic properties dinos dataframe: can see 15527 rows (row occurrence) 13 columns (column attribute occurrence). columns? always good check rows columns (just ) verify data correctly loaded. data, see columns : phylum, class, order, family, genus, species = taxon associated occurrence hierarchical level. early_interval, late_interval = name early (furthest present) name late (closest present) intervals associated occurrence. intervals appear GSA geologic timescale (link ). min_ma, max_ma = maximum (oldest; farthest time present) minimum (youngest; closest present) ages associated occurrence. Note ages units millions years ago (abbreviated “mya”), absolute time. midpoint = date (millions years ago) exact halfway point interval fossil found . explain variable bit tutorial. lng, lat = longitude latitude location fossil found . coordinates fossil’s location present. “paleo” latitude longitude (removed prior loading data package) fossil occurrence estimate location organism actually lived, given know plate tectonics age fossil. fossil dating works (.e., can determine min_ma max_ma) limitations technical note “Dating fossils absolute time” end tutorial. Now, using function head(), can view first n rows dataset: notice head() output wraps around console output screen wide displayed one viewing frame. functions dim(), colnames(), head() useful inspecting datasets ’ve loaded. exercises use dinosaur data illustrative purposes, functions ’ve provided (associated exercises) work datasets (trilobites, ammonites, mammals). warm-, let’s count many occurrences famous dinosaur genus, like Majungasaurus. interesting quick note Majungasaurus full skeleton reconstruction University Michigan Museum Natural History anyone can visit. Now let’s try famous relative, T-rex. many occurrences T-rex dataset? Important consider: know T-rex comes 70 fossil specimens!","code":"data(\"dinos_fossil\") dim(dinos_fossil) ## [1] 15527    13 colnames(dinos_fossil) ##  [1] \"phylum\"         \"class\"          \"order\"          \"family\"         ##  [5] \"genus\"          \"species\"        \"early_interval\" \"late_interval\"  ##  [9] \"max_ma\"         \"min_ma\"         \"midpoint\"       \"lng\"            ## [13] \"lat\" head(dinos_fossil, n = 5) ##     phylum        class              order              family ## 1 Chordata Ornithischia NO_ORDER_SPECIFIED    Chaoyangsauridae ## 2 Chordata   Saurischia       Avetheropoda NO_FAMILY_SPECIFIED ## 3 Chordata   Saurischia       Avetheropoda NO_FAMILY_SPECIFIED ## 4 Chordata   Saurischia       Avetheropoda     Tyrannosauridae ## 5 Chordata   Saurischia       Avetheropoda     Tyrannosauridae ##               genus                   species early_interval late_interval ## 1    Chaoyangsaurus     Chaoyangsaurus youngi Late Tithonian   Valanginian ## 2 Protarchaeopteryx Protarchaeopteryx robusta Late Barremian  Early Aptian ## 3       Caudipteryx          Caudipteryx zoui Late Barremian  Early Aptian ## 4       Gorgosaurus      Gorgosaurus libratus Late Campanian               ## 5       Gorgosaurus      Gorgosaurus libratus Late Campanian               ##   max_ma min_ma midpoint       lng      lat ## 1  150.8 132.90   141.85  123.9667 42.93330 ## 2  130.0 122.46   126.23  120.7333 41.80000 ## 3  130.0 122.46   126.23  120.7333 41.80000 ## 4   83.5  70.60    77.05 -111.5287 50.74073 ## 5   83.5  70.60    77.05 -111.5493 50.73701 sum(dinos_fossil$genus == \"Majungasaurus\") ## [1] 25 sum(dinos_fossil$species == \"Tyrannosaurus rex\") ## [1] 70"},{"path":"https://mjanuario.github.io/evolved/articles/deeptime_rocks.html","id":"a-brief-introduction-to-temporal-ranges","dir":"Articles","previous_headings":"Exploring fossil occurrences","what":"A brief introduction to temporal ranges","title":"Introduction to the fossil record","text":"able date time boundaries rock section, can determine midpoint age rock section, marks exact halfway point interval. illustrate , take closer look fossil occurrences Tyranossaurus rex. First, let’s make copy occurrences assign new R object. Now, let’s look occurrences.  plot, horizontal black line segment represents fossil occurrence. leftmost end line segment represents maximum (oldest) estimated age occurrence, rightmost end line segment represents minimum (youngest) estimated age occurrence. Thus, segment captures full temporal range possible ages fossil occurrence. 70 total occurrences T-rex, 70 line segments. Looking occurrences, think T-rex actually appeared maximum age oldest occurrence (bottommost line segment spans 83.5 Ma 70.6 Ma)? Instead plotting early late boundaries stages species occurs, can get reasonable duration T-rex considering just time spanning earliest latest midpoints occurrences. Let’s re-draw fossil record T-rex, time let’s use midpoints fossil occurrences see can get better idea actual duration species.  think? better approximation length time T-rex lived (“temporal range”)? graded question, discuss fellow students GSI moment. many ways try reconstruct ages temporal ranges species fossil record. reconstructions present amount error, error smaller fossil records better time resolution. main caveats techniques : still know exact date appearance extinction taxon (!) Taxa fossils dated stage temporal ranges (see taxa B F panels II fig 1 ), therefore difficult know exactly within stage lived, consequently co-occurred. Imprecisely-dated occurrences can still influence midpoint technique (instance, look much temporal range T-rex affected just one occurrence). Problems associated midpoint technique can gleaned comparing panels II figure 1. purposes lab, assume reconstructing ages using interval midpoints, T-rex, good enough. Now plot dinosaurs dataset, estimating temporal range (error) interval midpoints. species horizontal line graph.  record look , instead looking species level, plot temporal ranges taxonomic level family (even uncertainties mentioned )?  taxonomic order level?  , maybe interesting: many species (, even higher proportion higher taxonomic levels) disappear abruptly around 66 Mya?","code":"Trex <- dinos_fossil[dinos_fossil$species == \"Tyrannosaurus rex\",]  #this still has the same columns as the dinosaur dataset: colnames(Trex) ##  [1] \"phylum\"         \"class\"          \"order\"          \"family\"         ##  [5] \"genus\"          \"species\"        \"early_interval\" \"late_interval\"  ##  [9] \"max_ma\"         \"min_ma\"         \"midpoint\"       \"lng\"            ## [13] \"lat\" plotRawFossilOccs(Trex, use.midpoint =  F, knitr = T) plotRawFossilOccs(Trex, use.midpoint = F, knitr = T) segments(x0 = min(Trex$midpoint),          x1 = max(Trex$midpoint),          y0 = 35, y1 = 35, lwd=3, col=\"red\"           ) plotRawFossilOccs(dinos_fossil, tax.lvl = \"species\", knitr = T) plotRawFossilOccs(dinos_fossil, tax.lvl  = \"family\", knitr = T) plotRawFossilOccs(dinos_fossil, tax.lvl  = \"order\", knitr = T)"},{"path":"https://mjanuario.github.io/evolved/articles/deeptime_rocks.html","id":"the-k-pg-mass-extinction","dir":"Articles","previous_headings":"Exploring fossil occurrences","what":"The K-Pg mass extinction","title":"Introduction to the fossil record","text":"K-Pg mass extinction caused collision bolide Earth. can date event relatively precisely magnitude impact left conspicuous layer iridium (mineral rare Earth, common meteors) throughout planet. characteristics, can securely conclude K-Pg mass extinction occurred 66 million years ago. can annotate K-Pg mass extinction event plot made using function: abline(v = 66)","code":""},{"path":"https://mjanuario.github.io/evolved/articles/deeptime_rocks.html","id":"something-to-think-about","dir":"Articles","previous_headings":"Exploring fossil occurrences > The K-Pg mass extinction","what":"Something to think about:","title":"Introduction to the fossil record","text":"K-Pg mass extinction impact diversity species, genus, family levels equally, see different patterns diversity loss among taxonomic levels? pattern different, might biological meaning?","code":""},{"path":"https://mjanuario.github.io/evolved/articles/deeptime_rocks.html","id":"the-pull-of-the-recent","dir":"Articles","previous_headings":"Exploring fossil occurrences","what":"The pull of the recent","title":"Introduction to the fossil record","text":"One question might make : temporal pattern fossil preservation? change across millions years? can quickly (superficially) test plotting histogram fossil occurrence midpoints.  Paleontologists call increase fossil preservation towards present “pull recent”. reasonable imagine every species ever existed left fossil. can quantify fraction species become fossils? estimate , look number current dinosaur species (.k.. birds; species list Jetz et al, 2012) left least one fossil occurrence.","code":"hist(dinos_fossil$midpoint,      breaks=100, #increasing breaks to see data in a better precision      xlab=\"Absolute time (Mya)\", main = \"Fossil Occurrence midpoints\",            #reversing axis to represent past -> present      xlim=c(rev(range(dinos_fossil$midpoint)))       ) # first we load the species list: data(\"birds_spp\")  # then we count the number of extant dinosaurs within our fossil dataset: n_fossilized_dinos <- sum(birds_spp %in% dinos_fossil$species)  #then we calculate the proportion: n_fossilized_dinos/length(birds_spp) ## [1] 0.1139798"},{"path":"https://mjanuario.github.io/evolved/articles/deeptime_rocks.html","id":"diversity-patterns-in-deep-time","dir":"Articles","previous_headings":"","what":"Diversity patterns in deep time","title":"Introduction to the fossil record","text":"can use two simple methods calculate diversity curves fossil record (see fig 1-III): standard method, simply sums taxa occur interval, thus calculates diversity within interval. range-method, sums species observed given stratigraphic interval, thus calculates diversity interval boundaries. method guarantees measuring diversity co-occurs time. methods interpolate (“fill ”) gaps species’ fossil record occurrences, counting species present interval first last fossil occurrences (FAD LAD, respectively). Meaning: interval occurrence, first last intervals containing occurrences, counted containing species; see taxon D Figure 1 visual example. function calcFossilDivTT calculations , can use argument method decide method employed.  can see, even calculate diversity corrected methods, pull recent still distorts perception diversity trends: number bird fossils increases diversity line much limits ability visualize changes deeper past. can account two ways. first simpler way manually restrict y-axis. also add mark representing time K-Pg mass extinction red vertical line following plot.  Instead restricting y-axis, use log scale highlight proportional changes diversity. plot, plot species richness log base 2. means every increment 1 unit log scale equals doubling number species, unit decrease scale equals halving number species.","code":"# This line calculates diversity through the standard method: SM <- calcFossilDivTT(dinos_fossil, method = \"stdmethod\")  # and this one calculates diversity using the range-through method: RG <- calcFossilDivTT(dinos_fossil, method = \"rangethrough\")   # Now we can create an empty plot to store our estimates: plot(NA,       xlim=rev(range(c(RG$age, SM$age))),      ylim=range(c(RG$div, SM$div)),      xlab=\"Absolute time (Mya)\",      ylab=\"Diversity\"      )    # and then add the standard method diversity: lines(x=SM$age, y = SM$div, type = \"l\", lwd=2)    # and finally add the range-through diversity: lines(x=RG$age, y = RG$div, type = \"l\", col=\"blue\", lwd=2) #Creating a plot: plot(NA,       xlim=rev(range(c(RG$age, SM$age))),            ylim=c(0,700), # here is the part of the code I changed, in                     # comparison with the former chunk of code            xlab=\"Absolute time (Mya)\",      ylab=\"Diversity\"      )    # adding the standard method diversity: lines(x=SM$age, y = SM$div, type = \"l\", lwd=2)    # adding the range-through diversity: lines(x=RG$age, y = RG$div, type = \"l\", col=\"blue\", lwd=2)   # Here, red line marks the K-Pg mass extinction: abline(v=66, col=\"red\") # Plotting again our diversity curves (note # this is exactly what we did in the previous section), but in log scale plot(NA,       xlim=rev(range(c(RG$age, SM$age))),      ylim=range(c(0, max(log(c(RG$div, SM$div), base = 2)))), # note the base 2      xlab=\"Absolute time (Mya)\",      ylab=\"Diversity\")    # adding the standard method diversity: lines(x=SM$age,        y = log(SM$div, base=2),       type = \"l\", lwd=2)   # adding the range-through diversity: lines(x=RG$age,        y = log(RG$div, base = 2),       type = \"l\", col=\"blue\", lwd=2)  # Here, red line marks the K-Pg mass extinction: abline(v=66, col=\"red\")"},{"path":"https://mjanuario.github.io/evolved/articles/deeptime_rocks.html","id":"the-spatial-distribution-of-the-record","dir":"Articles","previous_headings":"","what":"The spatial distribution of the record","title":"Introduction to the fossil record","text":"density fossil occurrences also varies space. can plot unevenness using function pbdb_map_occur paleobioDB R package.  Just curiosity, can also plot spatial distribution T-rex using dataset created earlier tutorial.","code":"# Plotting number of occurrences in space:  # you can change the size of the cells using the  argument \"res\" pbdb_map_occur(dinos_fossil, res = 1, cex = 0.3) ## class       : SpatRaster  ## size        : 169, 370, 1  (nrow, ncol, nlyr) ## resolution  : 1, 1  (x, y) ## extent      : -180, 190, -85.19218, 83.80782  (xmin, xmax, ymin, ymax) ## coord. ref. : lon/lat WGS 84 (CRS84) (OGC:CRS84)  ## source(s)   : memory ## name        : sum  ## min value   :   1  ## max value   : 459 pbdb_map_occur(Trex, res = 1, cex=0.7) ## class       : SpatRaster  ## size        : 169, 370, 1  (nrow, ncol, nlyr) ## resolution  : 1, 1  (x, y) ## extent      : -180, 190, -85.19218, 83.80782  (xmin, xmax, ymin, ymax) ## coord. ref. : lon/lat WGS 84 (CRS84) (OGC:CRS84)  ## source(s)   : memory ## name        : sum  ## min value   :   1  ## max value   :  22"},{"path":"https://mjanuario.github.io/evolved/articles/deeptime_rocks.html","id":"drawing-conclusions-from-the-fossil-record","dir":"Articles","previous_headings":"","what":"Drawing conclusions from the fossil record","title":"Introduction to the fossil record","text":"tutorial, briefly explored fossil record dinosaurs , gave 3 datasets: Trilobites, Mammals, Ammonites. Explore using set functions techniques used , answer: Apart incompleteness record, may realized another layer complexity fossil record lack temporal resolution fossil occurrences . Sometimes imprecision larger 20 million years, large amount time – much imprecision estimates? explore last section tutorial.","code":""},{"path":"https://mjanuario.github.io/evolved/articles/deeptime_rocks.html","id":"technical-note-dating-fossils-in-absolute-time","dir":"Articles","previous_headings":"","what":"Technical note: Dating fossils in absolute time","title":"Introduction to the fossil record","text":"may know, can use U238−Pb206U^{238}-Pb^{206} decay series estimate absolute ages igneous rocks (e.g., granite, basalt, volcanic ash, “frozen lava”, etc). Zircon silicate mineral widely-used radiometric dating, forms crystals (e.g., magma cools rock) selectively include U238U^{238} exclude decay products. happens U238U^{238} trapped zircon crystal forms. , crystal begins accumulate decay products, case, products kept trapped within crystal structure. Physicists determined 4.5 billion years (4,500,000,000 years; 4×1094 \\times 10^9 years), roughly 50% sample pure U238U^{238} decayed Pb206Pb^{206}. Thus, looking ratio U238U^{238} Pb206Pb^{206} sample, can estimate ages igneous rock thus gain insights age fossil-bearing sedimentary layers. apply method, first estimate decay rate U238U^{238}. exponential decay process can modeled Ut=U0e−kt\\begin{equation} U_t = U_0 e^{-kt} \\end{equation} UtU_t amount U238U^{238} time tt, U0U_0 starting amount, tt elapsed time (since formation zircon crystal), kk radioactive decay constant U238U^{238}. Consequently, need estimate kk dating may wish . can estimate kk know half-life ( = t12t_{\\frac{1}{2}}) U238U^{238}: value tt initial quantity U0U_0 = 1 decayed half, Ut=0.5U_t = 0.5. Rearranging equation gives: k=log2t12k = \\frac{log 2}{t_{\\frac{1}{2}}} Note use natural log (.e. base = ee) equation . method half-lives can found . Now, using decay constant kk obtained , can apply equation (1) date rock layers given estimate ratio U238U^{238} Pb206Pb^{206}. estimates typically made using ionizing mass spectrometry; note also need ratio number atoms U Pb, ratio masses. Suppose, zircon crystal, estimated ratios uranium lead WUW_U : WPbW_{Pb}. lets us directly estimate UtU_t U0U_0 decay equation . think WUW_U amount uranium currently sample, total amount started WUW_U plus WPbW_{Pb}, every Pb206Pb^{206} atom result decay exactly one U238U^{238} atom. Thus, WUW_U = UtU_t U0U_0 = WU+WPbW_U + W_{Pb}. Know, can come back equation (1), solve tt, get equation allow estimate age rock layer, given measured certain amounts WUW_U WPbW_{Pb}. extra reading, can find interesting outreach article zircon dating . last important point fossiliferous sites conditions allow us zircon dating, means paleontologists use techniques date fossils. involves lot work usually adds uncertainty dating process. 14 minutes free time, want see important yet difficult date fossil, watch short video youtube channel PBS Eons.","code":""},{"path":"https://mjanuario.github.io/evolved/articles/deeptime_rocks.html","id":"references","dir":"Articles","previous_headings":"","what":"References:","title":"Introduction to the fossil record","text":"Jetz, W., Thomas, G. H., Joy, J. B., Hartmann, K., & Mooers, . O. (2012). global diversity birds space time. Nature, 491(7424), 444-448. Upham, N. S., Esselstyn, J. ., & Jetz, W. (2019). Inferring mammal tree: species-level sets phylogenies questions ecology, evolution, conservation. PLoS biology, 17(12), e3000494.","code":""},{"path":"https://mjanuario.github.io/evolved/articles/install_r.html","id":"if-you-never-used-r-before","dir":"Articles","previous_headings":"","what":"If you never used R before…","title":"If you never used R before...","text":"’re new R, “pre-vignette” tutorial serves introduction using evolved. largely inspired first tutorials EEB 485 EEB 391/516 (Population Community Ecology & Evolutionary processes Macroevolution), extended modified work context. document meant serve first contact tools major importance vignettes evovled. Nothing related tutorial required use R package, using tools explained , please make sure completed (genrlly familiar R). tutorial somewhat long, first time using R, also bit confusing. reasonable part see pretty abstract. ask trust learning process keep reading end. highly encourage reach peers knowledgeable R, needed. know different folks come different levels comfort R – means learn lot colleagues, however comfortable may currently R.","code":""},{"path":"https://mjanuario.github.io/evolved/articles/install_r.html","id":"what-is-r-and-how-can-i-install-it","dir":"Articles","previous_headings":"If you never used R before…","what":"What is R and how can I install it?","title":"If you never used R before...","text":"R (1) open source software, (2) programming language, (3) programming environment. first one means computer program can freely download, use, modify needs. second means language allows humans machines communicate. third means gives everything need create programs specific language. Scientists, especially biological sciences, widely use R run simulations analyze datasets, . ’re using computer yet installed R, can download install free pasting web browser: http://cran.us.r-project.org/ download , install program – installer program direct though major steps. open R, see something close Figure 1. Please download install R progressing install RStudio. Example recently-opened R Apple computer. interface looks slightly different Windows computer, main features . Note depending details, may may see warnings errors screenshot.","code":""},{"path":"https://mjanuario.github.io/evolved/articles/install_r.html","id":"what-is-rstudio-and-how-can-i-install-it","dir":"Articles","previous_headings":"If you never used R before…","what":"What is RStudio and how can I install it?","title":"If you never used R before...","text":"RStudio development environment R. coarse simplification, can think RStudio complement R makes tasks easier – “shell” enveloping R makes communications R easier. However, many say RStudio much helpful resource . never worked R , encouraged try RStudio just “plain” R separately make conclusion makes comfortable. required use RStudio use evolved, can use think help learning process (required use R, though). class use programming learning tool, programming also skill develop quantitative ability make better scientist. really want train skill get really good , highly recommend point career, get used programming just R – invited use class one opportunity . However, intention use R occasionally, might worth jumping straight RStudio, cost limited series details constraints RStudio . need RStudio personal machine, can download install free pasting web browser: http://rstudio.org download , install program – installer program direct though major steps. intend use RStudio, please download install progressing install RMarkdown. cover RMarkdown later tutorial.","code":""},{"path":"https://mjanuario.github.io/evolved/articles/install_r.html","id":"starting-r-and-rstudio","dir":"Articles","previous_headings":"If you never used R before…","what":"Starting R and RStudio:","title":"If you never used R before...","text":"start R, see something like figure 1. start RStudio instead, open R inside RStudio environment, look like figure 2. Example recently-opened Rstudio. Note appearance RStudio customizable, interface might look RStudio instructors fellow students Just looking figures 1 2, easy see RStudio gives lot information. briefly walk items shown figure 2 familiarize quadrant RStudio environment. Note figures showing upper part screen (containing tabs “File”, “Edit”, “Code”, “View”, etc.), sometimes use options . Upper-left: script. view, edit, save text files, including R scripts (.R files) RMarkdown (.Rmd) files. use quadrant learning activities. Lower-left: console (.k.terminal, .k.. command line). lines script get processed computed. , can see code actually input run, computer’s output . can also paste execute commands directly console, instead script file. space also used exhaustively. Upper-right: Four tabs: Environment: loading/saving/examining data (may may use one much, depend habits) History: list commands ’ve typed (, use depend habits) Connections: linking specific database types (basically use vignettes) Tutorial: useful resource tutorial demonstrations R code functions (used evolved) Lower-right: Five tabs: Files: list files “working directory” (later tutorial) Plots: plots/figures create appear (use extensively vignettes) Packages: area managing installed R packages (probably use much vignettes) Help: access official documentation R (use extensively) Viewer: viewing web content (probably used frequently vignettes) want use RStudio, series configurations highly recommend . can access going upper part screen (one contains tabs “File”, “Edit”, “Code”, “View”, etc), clicking Tools > Global Options, editing options. Opinions best configuration vary, link blog post shows possible configuration might helpful classes: (link: https://www.r-bloggers.com/2019/05/-rstudio-configuration/) Use time get used new software.","code":""},{"path":"https://mjanuario.github.io/evolved/articles/install_r.html","id":"working-routine-in-r","dir":"Articles","previous_headings":"If you never used R before…","what":"Working Routine in R","title":"If you never used R before...","text":"short tutorial help navigate files. can think checklist use start labs class. Steps 1-4 done lab. Steps 5 6 needed depending lab. start revising “Desktop” computer – standard folder computer operating systems (.e., Windows, MacOS, Linux…) . first “place” computer puts turn , seen screen shot , Desktop:   comfortable coding R, suggest create folder storing classwork “Desktop” computer, like screen shot . comfortable programming, work wish.","code":""},{"path":"https://mjanuario.github.io/evolved/articles/install_r.html","id":"step-1-setting-work-directory","dir":"Articles","previous_headings":"If you never used R before… > Working Routine in R","what":"Step 1: Setting work directory","title":"If you never used R before...","text":"working directory folder computer R navigate session. time import files write files folder, R automatically use folder set working directory. set working directory, open R click, upper bar, Session > Set Working Directory > Choose Directory figure (notice .Rmd file left panel R console, different RStudio default, right – notice also minimized panels RStudio):   clicking Choose Directory, see something like screenshot :  , can navigate folder storing files class, subfolder folder, set working directory. ’s important keep working folders lab organized, include several different files types, including R scripts (.R files) data files (e.g., .txt, .csv, etc.). instance downloaded files cyt-oxidase1-mt-aligned.txt R_functions.R added working directory folder, look like :  following steps, set directory working current R “session”. folder R use reference, now close R change directory.","code":""},{"path":"https://mjanuario.github.io/evolved/articles/install_r.html","id":"step-2-checking-working-directory","dir":"Articles","previous_headings":"If you never used R before… > Working Routine in R","what":"Step 2: Checking working directory","title":"If you never used R before...","text":"() check working directory , type getwd() console script file. function tell folder currently set working directory giving path name folder. decided store folder Desktop, see something following format (note follows Mac/Linux formatting, Windows write slightly differently): \".../[username]/Desktop/[name_of_your_folder]\" things put inside brackets line things expect different case, given operational system names folders. computer (Mac/Linux system), get: R can also return “compacted” version exact line, : contraction particular occurs Linux MacOS systems. Windows may show similar contraction, can vary version version, welcome reach GSI case problems. contraction resource helps advanced programmers (cost slightly confusing newcomers). recommend : finished step 1 working directory set, run getwd() paste output setwd() function. Insert line “setup” code chunk. help RMarkdown compile smoothly. look less like following screenshot:  Another strange behavior RMarkdown might automatically change folder every chunk code run. extremely counterproductive, end (step 7) provide guide possible way solve . (II) check files inside working directory, type dir() console script file. list names every file subfolder within working directory. example, two files working directory named cyt-oxidase1-mt-aligned.txt R_functions.R, see following output typing dir(): (III) check R objects currently workspace, type ls(), gives list objects currently loaded R environment. start lab, results always character(0), means currently nothing workspace – call “cleaned” workspace.  steps helped set everything check files objects available . troubleshooting tips case things went awry previous steps. result getwd() different , try step 1 (setting work directory) . result dir() different , either wrong folder (go back step 1) files correct folder – correct moving files computer. ls() returns thing \"character(0)\" clean workspace R typing rm(list=ls()) console, careful erase everything previously created within R (although things can preserved previously saved file external R .txt .csv file). clean workspace important working properly R – many problems arise forgetting start completely clean workspace.","code":"getwd() [1] \"/Users/matheus/Desktop/EEB516_labs/lab_05\" getwd() [1] \"~/Desktop/EEB516_labs/lab_05\" [1] \"cyt-oxidase1-mt-aligned.txt\" [2] \"R_functions.R\""},{"path":"https://mjanuario.github.io/evolved/articles/install_r.html","id":"step-3-saving-files","dir":"Articles","previous_headings":"If you never used R before… > Working Routine in R","what":"Step 3: Saving files","title":"If you never used R before...","text":"Make sure files saved correctly. important lose work R crashes, class time ends, stop reason. Go upper bar click File > Save figure .  window pop folder working . can save .Rmd file , file. Now, run dir() , see saved file. saved file name lab_05_answers.Rmd, got:","code":"[1] \"cyt-oxidase1-mt-aligned.txt\" [2] \"lab_05_answers.Rmd\"          [3] \"R_functions.R\""},{"path":"https://mjanuario.github.io/evolved/articles/install_r.html","id":"step-4-compilingknitting-your-rmarkdown","dir":"Articles","previous_headings":"If you never used R before… > Working Routine in R","what":"Step 4: Compiling/knitting your RMarkdown","title":"If you never used R before...","text":"Now time make sure RMarkdown compiles. can compile clicking just script window RStudio Knit:  Now, run dir() , see new compiled .html document working folder: Note: strongly recommend always knit/compile .Rmd finishing question. nothing disappointing finishing RMarkdown able compile . knitting along way eliminate possibility.","code":"[1] \"cyt-oxidase1-mt-aligned.txt\" [2] \"lab_05_answers.html\"          [3] \"lab_05_answers.Rmd\"          [4] \"R_functions.R\""},{"path":"https://mjanuario.github.io/evolved/articles/install_r.html","id":"step-5-sourcing-r-scripts","dir":"Articles","previous_headings":"If you never used R before… > Working Routine in R","what":"Step 5: Sourcing R scripts","title":"If you never used R before...","text":"might need source files – just reading .R file, importing functions data script file current script file. files folder working, followed previous steps, just type: source(\"name_of_file.R\") (“name_of_file” merely placeholder). errors typing , script just sourced ran end issue. sourced file crashed printed error, something wrong, please revise steps things continue work, ask GSI.","code":""},{"path":"https://mjanuario.github.io/evolved/articles/install_r.html","id":"step-6-loading-external-data","dir":"Articles","previous_headings":"If you never used R before… > Working Routine in R","what":"Step 6: Loading external data","title":"If you never used R before...","text":"might need load external files, .csv files. probably tell , tutorial, function use. general format : object <- function_that_reads_file(\"file_name\") instance, spreadsheet called data.csv read correctly followed steps , run: check data read correctly, something like :","code":"data <- read.csv(\"data.csv\") head(data)"},{"path":"https://mjanuario.github.io/evolved/articles/install_r.html","id":"step-7-debbuging-one-specific-strange-behavior-some-students-found","dir":"Articles","previous_headings":"If you never used R before… > Working Routine in R","what":"Step 7: Debbuging one specific strange behavior some students found","title":"If you never used R before...","text":"strange behavior RMarkdown might automatically change working directory folder every chunk code run. extremely counterproductive, can fix going upper bar clicking Tools > Global Options figure :  go RMarkdown > Evaluate chunks directory set option “Document”, figure :  configurations see screenshot used Matheus – feel free try well want. RStudio keeps changing directory done steps , reach GSI. ways try solve problem may encounter look Google, R RStudio big, helpful, kind online community usually helps kinds problems – us regularly troubleshoot things looking online.","code":""},{"path":"https://mjanuario.github.io/evolved/articles/install_r.html","id":"what-is-rmarkdown-and-how-can-i-install-it-optional","dir":"Articles","previous_headings":"","what":"What is RMarkdown and how can I install it (optional)?","title":"If you never used R before...","text":"RMarkdown programming language environment generates reporting documents. makes easy mix decently formatted document (nice-looking equations) R code, want use RMarkdown studying ecology evolutionary biology. know LaTeX, familiar RMarkdown’s syntax (.e., way functions written used programming language) resemble . don’t know LaTeX means, problem – time familiarize kind tool. Downloading RStudio automatically downloads RMarkdown . Otherwise, can download RMarkdown directly R console, typing. Please check knitr package installed computer, RMarkdown needs . can create new RMarkdown file RStudio going upper tabs, clicking File > New > R Markdown. can create .html files code clicking “Knit” button just script window (shown figure 2, since file open script file, .R, RMarkdown file, .Rmd).","code":"install.packages('rmarkdown') # Using the code above, you will install RMarkdown from The Comprehensive R  # Archive Network (a.k.a. CRAN)."},{"path":"https://mjanuario.github.io/evolved/articles/install_r.html","id":"more-on-rmarkdown","dir":"Articles","previous_headings":"What is RMarkdown and how can I install it (optional)?","what":"More on RMarkdown","title":"If you never used R before...","text":"RMarkdown result philosophy called “literate programming”, first idealized Donald Knuth ’70s. Doctor Knuth believed programmers think programs lists commands, also works literature. One quotes approach coding “Instead imagining main task instruct computer , let us concentrate rather explaining human beings want computer ”. clear positive consequences teaching science, feel comfortable RMarkdown follow Dr. Knuth’s ideas studying using evolved, use RMarkdown intrinsic part learning process generally. experience worthwhile use RMarkdown create notes scientific practices, data analyses, model making/testing, etc. understand, however, learning curve R (maybe RStudio) + RMarkdown might little steep. can also just give little time learn tool. recommended routine work evolved: lab tutorial available vignette evovled. recommend skimming text starting tutorial. rest studies reading tutorial answering questions . highly recommend everyone read vignette completely starting answer questions. can use RMarkdown knit answers PDF files (, time, prove useful science), depending operational system might bit headache. can also use Microsoft Word Google Docs, long usful .","code":""},{"path":"https://mjanuario.github.io/evolved/articles/install_r.html","id":"rmarkdown-advantages","dir":"Articles","previous_headings":"What is RMarkdown and how can I install it (optional)?","what":"RMarkdown advantages","title":"If you never used R before...","text":"addition plotting integrating comments code, RMarkdown also allows easily write equations beautiful notation. , write equations see evolved. need understand mean (biologically speaking) now – just want show RMarkdown equation-writing feature. likely reading PDF/html file, major point file built can visualize “sides” writing PDF RMarkdown file: “public-facing” side PDF file currently reading, “internal” side code generates PDF. .Rmd file generated PDF document posted MJ’s github can see two files communicate (Markdown works “hood”). point following text example idea nicely-written equations, code, text can merged single, organized document RMarkdown. Download open .Rmd file name PDF (posted MJ’s github learn syntax associated everything .","code":""},{"path":"https://mjanuario.github.io/evolved/articles/install_r.html","id":"an-example-of-why-rmarkdown-is-so-neat","dir":"Articles","previous_headings":"What is RMarkdown and how can I install it (optional)?","what":"An example of why RMarkdown is so neat:","title":"If you never used R before...","text":"effective population size time-varying population size (.e., bottlenecks expansions) : Ne=11t∑=1t1NiN_e = \\frac{1}{\\frac{1}{t}\\sum_{=1}^{t} \\frac{1}{N_i}} probability identity--descent two alleles : ft=12N+(1−12N)ft−1f_t = \\frac{1}{2N} + (1-\\frac{1}{2N})f_{t-1} rate heterozygosity loss : HtH0=(e−12N)t\\frac{H_t}{H_0} = (e^{-\\frac{1}{2N}})^t also equal e−t2Ne^{-\\frac{t}{2N}}. course, assumes diploid organism, census size population NN. RMarkdown can also easily merge R plots text. instance want graph equation 3, simply write:","code":"#create a numeric vector representing time: t=seq(from=0, to=200, by=0.001)  #insert population size: N=20  Ht_Ho=exp(-1/(2*N))^t  plot(x=t, y=Ht_Ho, type=\"l\", lwd=4,       ylab=\"Rate of heterozygosity loss\",      xlab=\"Time\", main=\"Plot of equation (3)\")"},{"path":"https://mjanuario.github.io/evolved/articles/install_r.html","id":"rmarkdown-practice-part-i","dir":"Articles","previous_headings":"What is RMarkdown and how can I install it (optional)?","what":"RMarkdown practice (part I)","title":"If you never used R before...","text":"Please take look RMarkdown used make file (MJ’s github try locate code responsible part just read, putting special attention codes, plots, equations.","code":""},{"path":"https://mjanuario.github.io/evolved/articles/install_r.html","id":"rmarkdown-practice-part-ii","dir":"Articles","previous_headings":"What is RMarkdown and how can I install it (optional)?","what":"RMarkdown practice (part II)","title":"If you never used R before...","text":"Now let’s something hands-. Create brand new .Rmd file insert text pasting contents tutorial new file. run “test” one piece pasted code, click line R code document choose Code > Run Selected Line(s) run line R console. Alternatively, can also click Run button top left pane, quickest way Command+Return Mac keyboard, Control+Return Windows keyboard. Test works best Linux, use . Select Run Region > Run Current Chunk run entire “chunk” R code. Save changes .Rmd, knit HTML. future, note RStudio automatically saves .Rmd file whenever knit HTML PDF file - recall purposes class accept PDF submissions.","code":""},{"path":"https://mjanuario.github.io/evolved/articles/intro_r.html","id":"learning-objectives","dir":"Articles","previous_headings":"","what":"Learning objectives","title":"Introduction to R","text":"Learn R basic syntax Learn R basic coding: objects, vector calculations, etc Learn basic plotting annotation functions Learn basic object classes use Learn expected lab","code":""},{"path":"https://mjanuario.github.io/evolved/articles/intro_r.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Introduction to R","text":"assume successfully installed R RMarkdown, RStudio, intend use . installed required software already, please check “Installing Software” tutorial available supplementary PDF article describing package. output R show included file along input code, still recommend actually run code R . tutorial peppered questions/exercises test comprehension guide experimentation R. order better understand tools concepts talked .","code":""},{"path":"https://mjanuario.github.io/evolved/articles/intro_r.html","id":"r-basics","dir":"Articles","previous_headings":"","what":"R basics","title":"Introduction to R","text":"“>” symbol bottom console means R waiting send command. However, R calculating, operation, see last line completely blank. R thinks finished typing, change “>” “+”, indicating waiting finish command order run . occurs unintentionally, probably means forgot close parenthesis ( = ( )), quotation mark ( = ” “), curly bracket ( = { }). Let’s start sending R classic command, message printed console. Copy paste line code (monospaced text within light gray box ) console, click Enter Ctrl/Command + Enter. action sending commands console (whether copy-pasting directly typing) called “running” code. following command prints message console: running anything else, let’s talk R run – lines called “comments”. hashtag (#) code line signals R comment begins. Anything right hashtag within line never run R. instance, run: Important: highly encouraged annotate code answers comments. saying programming “one programs worse 6 months ago” – nice idea fill future R scripts comments allow remember reasoning (scripts later tutorial). Comprehension Question: happens put “#” middle character string saw line code (.e. “printed console”)? Figure ! Add hashtag wherever want, press enter try figure hashtag character works.","code":"print(x = \"hello world\") ## [1] \"hello world\" print(x = \"This will be printed in the console\") #\"This will not\" ## [1] \"This will be printed in the console\""},{"path":"https://mjanuario.github.io/evolved/articles/intro_r.html","id":"r-as-a-vector-calculator","dir":"Articles","previous_headings":"","what":"R as a vector calculator","title":"Introduction to R","text":"Vectors multiple meanings class. lab selection (#03), instance, vectors meaning usually physics: arrows represent something direction magnitude (e.g., natural selection ). classes, use vectors mathematical objects allow us matrix multiplication. R, however, vectors series elements class ordered one (order may meaning ). instance, vectors might made numbers. create one numeric vector using seq() (“sequence”) function. worry understanding “<-” now. explain tutorial. say now stored number sequence. can access “stored” content typing console: can check class vector (.e. data type) confirm numeric. can create many different numeric vectors changing parameters (“”, “”, “”). instance: Character vectors also exist. Let’s use one already pre-created R, “LETTERS” character vector. , mean put things parentheses? commas matter? details make R syntax functions. R, following format always used: function( first_argument =  value , second_argument =  value , third_argument =  value , …) , arguments function inside parentheses, separated commas, explicit order. R read spaces (.e., ” ” ) tabs, can use spaces tabs improve human readability code. can also operations vectors. instance, can calculate mean numeric vector using mean() function: Though every function argument name, can omit explicitly including name function () write argument inputs order arguments . example, mean function’s first argument vector calculate mean, argument’s name “x”. can specify “x” argument input explicitly like : , put desired input “x” first thing inside function, don’t explicitly name argument writing “x =” . can simply write: Note full list arguments function (can use correct order) look help page particular function. topic approach tutorial. R, order mathematical operations follows rules algebra. recap showing differences following commands: mathematical functions worth noting: operations can made vectors, makes R powerful tool quick calculation: can also “nest” functions, means putting one function inside another. can avoid clogging environment many intermediary objects, however comes cost making code less readable - recommend using technique parsimoniously. quick tip: make mistake (everyone programming), shortcut type paste everything terminal put cursor console, press arrow keyboard. using arrows able navigate history typed commands (since start current R session). shortcut also allows try new things small changes faster (try instance press arrow now, change something argument since last time used seq() function). work like predicted ? advise , however, use shortcut shortcut, standard practice R. standard practice use scripts.","code":"one_to_thirteen <- seq(from = 1, to = 13, by = 1) one_to_thirteen ##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 class(one_to_thirteen) ## [1] \"numeric\" seq(from = -0.56, to = 1, by = 0.2) ## [1] -0.56 -0.36 -0.16  0.04  0.24  0.44  0.64  0.84 LETTERS ##  [1] \"A\" \"B\" \"C\" \"D\" \"E\" \"F\" \"G\" \"H\" \"I\" \"J\" \"K\" \"L\" \"M\" \"N\" \"O\" \"P\" \"Q\" \"R\" \"S\" ## [20] \"T\" \"U\" \"V\" \"W\" \"X\" \"Y\" \"Z\" class(LETTERS) ## [1] \"character\" # Numbers can be converted to characters as well: one_to_thirteen_character <- as.character(x = one_to_thirteen)  # Characters are always marked with quotation marks.  one_to_thirteen_character ##  [1] \"1\"  \"2\"  \"3\"  \"4\"  \"5\"  \"6\"  \"7\"  \"8\"  \"9\"  \"10\" \"11\" \"12\" \"13\" # Even if you can read  # something as a number, R interprets as a character everything # that is inside quotation marks. class(one_to_thirteen_character) ## [1] \"character\" mean(x = one_to_thirteen) ## [1] 7 mean(x = one_to_thirteen) ## [1] 7 mean(one_to_thirteen) ## [1] 7 2 + 3 ## [1] 5 2 * 3 + 1 ## [1] 7 2 * (3 + 1) ## [1] 8 9 ^ 2 #this is exponentiation ## [1] 81 log(8, base = 2) #taking the logarithm of a number given a specific base ## [1] 3 one_to_ten <- 1:10 one_to_ten^2 ##  [1]   1   4   9  16  25  36  49  64  81 100 # Code below will take the log2 of numbers from 2 to # 100 by an even space of 2 units log(seq(2, 100, by = 2), base = 2) ##  [1] 1.000000 2.000000 2.584963 3.000000 3.321928 3.584963 3.807355 4.000000 ##  [9] 4.169925 4.321928 4.459432 4.584963 4.700440 4.807355 4.906891 5.000000 ## [17] 5.087463 5.169925 5.247928 5.321928 5.392317 5.459432 5.523562 5.584963 ## [25] 5.643856 5.700440 5.754888 5.807355 5.857981 5.906891 5.954196 6.000000 ## [33] 6.044394 6.087463 6.129283 6.169925 6.209453 6.247928 6.285402 6.321928 ## [41] 6.357552 6.392317 6.426265 6.459432 6.491853 6.523562 6.554589 6.584963 ## [49] 6.614710 6.643856"},{"path":"https://mjanuario.github.io/evolved/articles/intro_r.html","id":"objects-in-r","dir":"Articles","previous_headings":"","what":"Objects in R","title":"Introduction to R","text":"R, can also store values elements (e.g., numbers, letters, strings, etc). call stored things “objects”. term pretty vague, many different types objects. numbers characters, spanning matrices, functions, phylogenies, many others. Actually, fact R open source means many potential classes “objects” creativity R programmers throughout world can create. store object using “<-” character (.k.. “attribution arrow”). can check stored inside object typing name console: can also use “=” synonym “<-”. Finally, can also use arrow backwards (.e. “->”), tip arrow must always point object’s name - object’s contents. However, usage controversial, R users consider bad practice. Objects can also modified. can : overwriting object (assigning different thing name): mathematical operations object: passing object compatible functions: types modifications change class object. Note , using “<-” lines code , haven’t actually stored changes object. However, modifications stored using “<-” assigning modified object name (even name old object, though overwrite ). Important: Whenever assign something object, R store unique copy information. Two object names never point data. equal contents, ’s simply two objects containing indistinguishable content. means variables automatically recalculated Excel-like formulas . change object used script, ’ll need re-run calculation/usage object get new result.","code":"zero_to_ten <- seq(from = 0, to = 10, by = 2) #here we use the seq() function,  # attributed to the \"zero_to_ten\" object  # Note we also use the \"from\", \"to\", and \"by\" arguments. zero_to_ten ## [1]  0  2  4  6  8 10 one_to_ten <- seq(from = 1, to = 10, by = 0.5)   one_to_ten ##  [1]  1.0  1.5  2.0  2.5  3.0  3.5  4.0  4.5  5.0  5.5  6.0  6.5  7.0  7.5  8.0 ## [16]  8.5  9.0  9.5 10.0 # Note that the elements themselves  # (and the number of elements) changed one_to_ten + 0.56 #addition (or) subtraction ##  [1]  1.56  2.06  2.56  3.06  3.56  4.06  4.56  5.06  5.56  6.06  6.56  7.06 ## [13]  7.56  8.06  8.56  9.06  9.56 10.06 10.56 one_to_ten*2 #multiplication ##  [1]  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 one_to_ten/2 #division ##  [1] 0.50 0.75 1.00 1.25 1.50 1.75 2.00 2.25 2.50 2.75 3.00 3.25 3.50 3.75 4.00 ## [16] 4.25 4.50 4.75 5.00 paste(\"text pasted to\", one_to_ten) ##  [1] \"text pasted to 1\"   \"text pasted to 1.5\" \"text pasted to 2\"   ##  [4] \"text pasted to 2.5\" \"text pasted to 3\"   \"text pasted to 3.5\" ##  [7] \"text pasted to 4\"   \"text pasted to 4.5\" \"text pasted to 5\"   ## [10] \"text pasted to 5.5\" \"text pasted to 6\"   \"text pasted to 6.5\" ## [13] \"text pasted to 7\"   \"text pasted to 7.5\" \"text pasted to 8\"   ## [16] \"text pasted to 8.5\" \"text pasted to 9\"   \"text pasted to 9.5\" ## [19] \"text pasted to 10\" class(paste(\"text pasted to\", one_to_ten)) ## [1] \"character\""},{"path":"https://mjanuario.github.io/evolved/articles/intro_r.html","id":"appending-elements","dir":"Articles","previous_headings":"","what":"Appending elements","title":"Introduction to R","text":"can also append elements vector using c() (“concatenate”) function note might modify class vector, depending . R try guess class vector , sometimes class want vector . Usually, can convert object different class. , converting new_one_to_ten object, currently character vector, factor vector. “factor” class object helps R categorize data. important now, intention show class conversions simple. sometimes lose information try convert vector, depending details: , last element (“word”) converted NA. “word” analogous numerical value, R assigns NA value. conversion overwrite object converted values, previous value (.e. “word”) lost forever. might noted sometimes R “guesses” mean. R “reflective programming language”, means give incomplete information R, try figure blanks mean. Sometimes helpful, sometimes . understanding details important, can troubleshoot small problems (skill improve time practice).","code":"c(one_to_ten, NA, 34) ##  [1]  1.0  1.5  2.0  2.5  3.0  3.5  4.0  4.5  5.0  5.5  6.0  6.5  7.0  7.5  8.0 ## [16]  8.5  9.0  9.5 10.0   NA 34.0 new_one_to_ten <- c(one_to_ten, NA, \"word\")  class(new_one_to_ten) ## [1] \"character\" new_one_to_ten <- as.factor(new_one_to_ten)  class(new_one_to_ten) ## [1] \"factor\" new_one_to_ten <- as.character(new_one_to_ten)  class(new_one_to_ten) ## [1] \"character\" as.numeric(new_one_to_ten) ## Warning: NAs introduced by coercion ##  [1]  1.0  1.5  2.0  2.5  3.0  3.5  4.0  4.5  5.0  5.5  6.0  6.5  7.0  7.5  8.0 ## [16]  8.5  9.0  9.5 10.0   NA   NA"},{"path":"https://mjanuario.github.io/evolved/articles/intro_r.html","id":"indexing","dir":"Articles","previous_headings":"","what":"Indexing","title":"Introduction to R","text":"dealt vectors lines, might seen bracketed numbers (e.g., “[1]”) output R printed console. numbers mark position element object printed console. R always tell reference position element whenever break line console printing visualization purposes. instance: can also use element positions refer specific elements inside object. can also modify specific elements inside object.","code":"#Pay attention to the bracketed numbers:  onehundred_to_twohundred <- 100:200  onehundred_to_twohundred <- onehundred_to_twohundred + 1.53  onehundred_to_twohundred ##   [1] 101.53 102.53 103.53 104.53 105.53 106.53 107.53 108.53 109.53 110.53 ##  [11] 111.53 112.53 113.53 114.53 115.53 116.53 117.53 118.53 119.53 120.53 ##  [21] 121.53 122.53 123.53 124.53 125.53 126.53 127.53 128.53 129.53 130.53 ##  [31] 131.53 132.53 133.53 134.53 135.53 136.53 137.53 138.53 139.53 140.53 ##  [41] 141.53 142.53 143.53 144.53 145.53 146.53 147.53 148.53 149.53 150.53 ##  [51] 151.53 152.53 153.53 154.53 155.53 156.53 157.53 158.53 159.53 160.53 ##  [61] 161.53 162.53 163.53 164.53 165.53 166.53 167.53 168.53 169.53 170.53 ##  [71] 171.53 172.53 173.53 174.53 175.53 176.53 177.53 178.53 179.53 180.53 ##  [81] 181.53 182.53 183.53 184.53 185.53 186.53 187.53 188.53 189.53 190.53 ##  [91] 191.53 192.53 193.53 194.53 195.53 196.53 197.53 198.53 199.53 200.53 ## [101] 201.53 onehundred_to_twohundred[56] #if you want the 56th element ## [1] 156.53 onehundred_to_twohundred[24] #if you want the 24th element ## [1] 124.53 onehundred_to_twohundred[13] #if you want the 13th element ## [1] 113.53 onehundred_to_twohundred[22] <- 0  onehundred_to_twohundred[22] ## [1] 0 onehundred_to_twohundred ##   [1] 101.53 102.53 103.53 104.53 105.53 106.53 107.53 108.53 109.53 110.53 ##  [11] 111.53 112.53 113.53 114.53 115.53 116.53 117.53 118.53 119.53 120.53 ##  [21] 121.53   0.00 123.53 124.53 125.53 126.53 127.53 128.53 129.53 130.53 ##  [31] 131.53 132.53 133.53 134.53 135.53 136.53 137.53 138.53 139.53 140.53 ##  [41] 141.53 142.53 143.53 144.53 145.53 146.53 147.53 148.53 149.53 150.53 ##  [51] 151.53 152.53 153.53 154.53 155.53 156.53 157.53 158.53 159.53 160.53 ##  [61] 161.53 162.53 163.53 164.53 165.53 166.53 167.53 168.53 169.53 170.53 ##  [71] 171.53 172.53 173.53 174.53 175.53 176.53 177.53 178.53 179.53 180.53 ##  [81] 181.53 182.53 183.53 184.53 185.53 186.53 187.53 188.53 189.53 190.53 ##  [91] 191.53 192.53 193.53 194.53 195.53 196.53 197.53 198.53 199.53 200.53 ## [101] 201.53"},{"path":"https://mjanuario.github.io/evolved/articles/intro_r.html","id":"time-for-a-pause-and-ponder","dir":"Articles","previous_headings":"","what":"Time for a pause and ponder","title":"Introduction to R","text":"Now good moment ponder bit. Make sure understand everything typed console . Go back re-read things like. things printed console still make sense, ask experienced user help .","code":""},{"path":"https://mjanuario.github.io/evolved/articles/intro_r.html","id":"matrices","dir":"Articles","previous_headings":"","what":"Matrices","title":"Introduction to R","text":"Just algebra, can think matrix series vectors bound together: Comprehension Question: options follow linear algebra rules multiplication matrices? Make sure know difference.","code":"vector1 <- c(1,3)  class(vector1) ## [1] \"numeric\" vector2 <- c(4,5)  class(vector2) ## [1] \"numeric\" # You can bind vectors (or matrices) by rows... tentative_matrix1 <- rbind(vector1, vector2)   class(tentative_matrix1) ## [1] \"matrix\" \"array\" #... or by columns tentative_matrix2 <- cbind(vector1, vector2)   class(tentative_matrix2) ## [1] \"matrix\" \"array\" #and each action generates different outputs:  tentative_matrix1 ##         [,1] [,2] ## vector1    1    3 ## vector2    4    5 tentative_matrix2 ##      vector1 vector2 ## [1,]       1       4 ## [2,]       3       5 # Note also that doing... tentative_matrix1 * tentative_matrix2 ##         [,1] [,2] ## vector1    1   12 ## vector2   12   25 #... is different from doing: tentative_matrix1 %*% tentative_matrix2 ##         vector1 vector2 ## vector1      10      19 ## vector2      19      41"},{"path":"https://mjanuario.github.io/evolved/articles/intro_r.html","id":"logical-tests","dir":"Articles","previous_headings":"","what":"Logical tests","title":"Introduction to R","text":"can make logical tests evaluate contents vector. logical test, result binary “TRUE” “FALSE”. Logical tests useful evaluating things R “control flow” (.k.. decision making) inside function (future).","code":"numbers <- seq(-10, 10, by = 1) numbers ##  [1] -10  -9  -8  -7  -6  -5  -4  -3  -2  -1   0   1   2   3   4   5   6   7   8 ## [20]   9  10 test_result <- numbers > 0 # here we are asking which numbers are larger then 0 test_result ##  [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE ## [13]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE numbers == 10 # here we are asking which number is exactly equal to 10 ##  [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [13] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE # Note that the \"is equal\" test is created by two consecutive equal signs  # (i.e., \"==\"), since just one equal sign (\"=\") has the same meaning as the  # attribution arrow (i.e., \"<-\")."},{"path":"https://mjanuario.github.io/evolved/articles/intro_r.html","id":"data-frames","dir":"Articles","previous_headings":"","what":"Data frames","title":"Introduction to R","text":"can think data frame matrix whose contents can multiple classes. can access column names data frame using function colnames(). Thus, can change name columns data frame reassigning object new names, . example data frame df, column storing information different class. two handy functions print first last couple rows data frame: Indexing matrices data frames analogous vector indexing, difference include two numbers separated comma: first refers row, second number column object. omit numbers either side comma, R assume meant every row every column. Thus, line return line : Indexing matrices data frames like called “subsetting”, taking subset full object. forget include comma subsetting matrices data frames, R return error stating didn’t specify correctly dimensions object. recommend try get familiarized type error, forgetting type comma (typing incorrectly) common error getting familiar programming.","code":"df <- data.frame(test_result, numbers)  class(df) ## [1] \"data.frame\" colnames(df) <- c(\"is_positive\", \"number\")  df ##    is_positive number ## 1        FALSE    -10 ## 2        FALSE     -9 ## 3        FALSE     -8 ## 4        FALSE     -7 ## 5        FALSE     -6 ## 6        FALSE     -5 ## 7        FALSE     -4 ## 8        FALSE     -3 ## 9        FALSE     -2 ## 10       FALSE     -1 ## 11       FALSE      0 ## 12        TRUE      1 ## 13        TRUE      2 ## 14        TRUE      3 ## 15        TRUE      4 ## 16        TRUE      5 ## 17        TRUE      6 ## 18        TRUE      7 ## 19        TRUE      8 ## 20        TRUE      9 ## 21        TRUE     10 # First column stores a logical vector: class(df[,1]) ## [1] \"logical\" # Second column stores a numerical vector: class(df[,2]) ## [1] \"numeric\" # First 7 rows printed: head(df, n = 7) ##   is_positive number ## 1       FALSE    -10 ## 2       FALSE     -9 ## 3       FALSE     -8 ## 4       FALSE     -7 ## 5       FALSE     -6 ## 6       FALSE     -5 ## 7       FALSE     -4 # Last 5 rows printed: tail(df, n = 5) ##    is_positive number ## 17        TRUE      6 ## 18        TRUE      7 ## 19        TRUE      8 ## 20        TRUE      9 ## 21        TRUE     10 df[7,1] # selecting the object in the 7th row and 1st column ## [1] FALSE df[7:15, 1:2] # taking objects in the 7th to the 15th rows and in both columns ##    is_positive number ## 7        FALSE     -4 ## 8        FALSE     -3 ## 9        FALSE     -2 ## 10       FALSE     -1 ## 11       FALSE      0 ## 12        TRUE      1 ## 13        TRUE      2 ## 14        TRUE      3 ## 15        TRUE      4 df[7:15,] ##    is_positive number ## 7        FALSE     -4 ## 8        FALSE     -3 ## 9        FALSE     -2 ## 10       FALSE     -1 ## 11       FALSE      0 ## 12        TRUE      1 ## 13        TRUE      2 ## 14        TRUE      3 ## 15        TRUE      4"},{"path":"https://mjanuario.github.io/evolved/articles/intro_r.html","id":"functions","dir":"Articles","previous_headings":"","what":"Functions","title":"Introduction to R","text":"now used lot functions, though haven’t yet defined . Functions objects can (depending specifics) modify another object, always return (“output”) something. instance, mean() function returns one number, average numbers inside inputted vector. returns printed console. Sometimes returned object printed console (graph, instance, see later). commonly, see anything printed console assign output function directed object. can create functions (class), can download package functions created someone else (something also ). second option also called “installing package”.","code":""},{"path":"https://mjanuario.github.io/evolved/articles/intro_r.html","id":"installing-and-running-packages","dir":"Articles","previous_headings":"","what":"Installing and running packages","title":"Introduction to R","text":"One main advantages R open source software people across whole world can contribute new software uses R language. Usually, new software come literal packages functions. instance, can install package “Analysis Phylogenetic Evolution” (ape; Popescu et al, 2012) running following command R’s console: Note install package . Note also packages might “dependencies”, basically packages. install package, R always install dependencies well. Even though don’t install R computers universities, indeed almost always install packages using university computer. always install packages CRAN using install.packages() function, problems. Downloading packages using functions usually require work success guaranteed, don’t recommend unless otherwise stated. use package, first installed computer. , time open R start new session, load package current session using library() function, . need reload package every time restart R. read people’s scripts, usually start loading packages needed run whole script (considered good practice, least – everyone follow, unfortunately).","code":"# Running the code below, you will install ape from The Comprehensive R Archive  # Network (a.k.a. CRAN - more about it in the additional reading). install.packages(\"ape\") library(ape) #note the lack of quotation marks in the use of this function"},{"path":"https://mjanuario.github.io/evolved/articles/intro_r.html","id":"scripts","dir":"Articles","previous_headings":"","what":"Scripts","title":"Introduction to R","text":"Scripts series programming steps. usually text files whose extension denotes language file written (scripts R language .R files RMarkdown scripts .Rmd files). usually exist either execute task create/store information. can ask R run script end running function source(), specifying file path script. information “Working Routine R” PDF within tutorial available supplementary files article describing package. However, note vignettes package.","code":""},{"path":"https://mjanuario.github.io/evolved/articles/intro_r.html","id":"file-paths-and-directories","dir":"Articles","previous_headings":"","what":"File paths and directories","title":"Introduction to R","text":"computer organized series directories (sometimes known “folders”) within directories. can small glance organization typing R: line asks R current working directory . means directory computer R use file importing exporting within R session. words, path suffix R use type absolute (.e. full) path file. information working directory “Working Routine R” PDF posted Canvas. can make new folder using function dir.create(): lines code create directory inside current working directory. absolute path written Windows computer, haven Apple computer double back-slashes (“\\\\”) changed forward slashes (“/”). Also, please note absolute path need modified fit computer’s directory structure, based computer. can check computer’s file explorer folders indeed created specified folder. can treat way treat directory. Important note: ’re using computer university, can create directories save files machine work class. However, want save files, ’ll need somehow copy/send/save personal computer, USB drive, Cloud platform leaving lab (needed directories created code section, though, just show). common mistake dealing paths convert file path syntax computer’s operating system. getting errors trying run line includes file paths, make sure syntax used correct computer (e.g., different type slash used Windows Apple, discussed ).","code":"getwd() #no argument is needed here - a small number of functions work like that # the relative path: dir.create(\"subfolder_relative\")  # This is a directory that is being created  # inside your current working directory  # But you could have done the same thing using the absolute path: dir.create(\"/Users/matheus/evolved/subfolder_absolute\")"},{"path":"https://mjanuario.github.io/evolved/articles/intro_r.html","id":"getting-help","dir":"Articles","previous_headings":"","what":"Getting help","title":"Introduction to R","text":"Sometimes need help handling functions R. Luckily, R already function deals . called help() – hope sticks head. arguably important, used, function R. run , put first argument function want help . open help page briefly describe function, returning values, arguments, details. end help page, find examples use function, showcasing syntax. ’s tough understand help page (.k.. function documentation), worry much. Sometimes help pages require previous understanding computing general, often involving specific jargon R, computer science, mathematics, scientific field generally. especially true field-specific functions, though can apply even basic functions. time practice, become familiar terminology. basic help page documentation sum() function – give try read help. shorthand, using ? character function name synonymous explicitly writing help(). code’s output exactly equal shorthand : reading sum help page, please note don’t need know “S4” object purposes class.","code":"help(sum) ?sum"},{"path":"https://mjanuario.github.io/evolved/articles/intro_r.html","id":"generation-of-random-numbers","dir":"Articles","previous_headings":"","what":"Generation of random numbers","title":"Introduction to R","text":"Many times class need generate numbers following given probability distribution (formally called “random numbers”). can using “r-family” functions. want draw 10 numbers normal curve mean = 0 standard deviation = 1, type: want draw just one completely random number 0 1, can taking random number uniform distribution zero one: countless probability distributions, R similar random-generation functions many . can recognize functions always start letter “r” (random) followed shortened name desired probability distribution (, “rnorm” normal).","code":"rnorm(n = 10, mean = 0, sd = 1) ##  [1] -1.400043517  0.255317055 -2.437263611 -0.005571287  0.621552721 ##  [6]  1.148411606 -1.821817661 -0.247325302 -0.244199607 -0.282705449 runif(n = 1, min = 0, max = 1) ## [1] 0.2898923"},{"path":"https://mjanuario.github.io/evolved/articles/intro_r.html","id":"plotting-and-plot-annotation","dir":"Articles","previous_headings":"","what":"Plotting (and plot annotation)","title":"Introduction to R","text":"can easily visualize variables R. can use histograms:  can create scatterplots:  can also draw fancier plots needed. instance, “Lots Superior Depictions” (LSD) package installed, use:  :: specifies package function drawn , without need load package using library() function used – just showing something might see tutorials. can draw boxplots :  can also draw mathematical functions using R. instance, can draw squared function:  can add visual information plots using color types annotations. , demonstrate neat trick “conditionally” coloring points (meaning, color point dependent value/category point).  can also annotate plots using function abline().","code":"normalNumbers <- rnorm(n = 10000, mean = 0, sd = 1) hist(normalNumbers) anotherNormalNumbers <- rnorm(n = 10000, mean = 3, sd = 1) plot(x = normalNumbers, y = anotherNormalNumbers) LSD::heatscatter(x = normalNumbers, y = anotherNormalNumbers) dt <- cbind(normalNumbers, anotherNormalNumbers) boxplot(dt) # xx <- seq(from = 0, to = 20, by = 0.01)  #we will only draw some of the points in the real number line  plot(x = xx, y = xx ^ 2, type = \"l\",       main = \"Simple function drawing\",       ylab = \"Squared value\", xlab = \"value\") # The \"type\" argument specifies that I want to connect the points  # with a line. The \"ylab\", \"xlab\", and \"main\" arguments provide the labels # Conditionally coloring specific points:  high_10 <- normalNumbers > 1  # The \"condition\" will be whether the point's value is larger than 1 # Here we will use a logical test (is the point's value > 1)  # to evaluate each element in a vector of numbers (\"normalNumbers\")  cols <- rep(\"black\", times = length(normalNumbers))  # We will create a vector of color names of the same length  # as the length of the \"normalNumbers\" object  cols[high_10] <- \"grey75\"  # We will use the logical vector we created (\"high_10\") # to specify which elements in the \"cols\" vector should be changed to grey75 # (this changes only the elements listed as \"TRUE\" in the logical vector)  # Then, with all this information, we can draw a new plot, with the colors  # specifying something we are interested in visualizing: plot(normalNumbers, col = cols) # Note that the points are added in the order of their position in the # vector - which creates the \"grainy\" look around y=1 plot(normalNumbers, col = cols)  abline(h = 1, col = \"red\", lwd = 6) # Draws a horizontal line at y=0  # (note the \"line width\" argument is named lwd)  # Drawing a vertical, thinner line (added after the red line, because of the  # order of the commands) separating the points at each half of the  # \"normalNumbers\" object abline(v = length(normalNumbers)/2, col = \"blue\", lwd = 3)"},{"path":"https://mjanuario.github.io/evolved/articles/intro_r.html","id":"loops","dir":"Articles","previous_headings":"","what":"Loops","title":"Introduction to R","text":"Finally can create loops, important tutorials. can think loops series lines code repeated many times. instance, can make loop counts one ten: Comprehension Question: Now, : write loop counts 30 45, skips even numbers.","code":"count <- 1:10 # what do this line do?  # Now, we will use loop syntax: for(number in count){   # In each \"lap\" (also known as \"iteration\") of the loop,   # the value of the object \"number\" will be updated   # to one of the values in the vector \"count\". These    # updates will follow the order of the numbers in the    # vector \"count\"      print(paste(\"The count is at\", number, \"right now\"))      # If you don't get what the function \"paste\" does,    # check its help page by typing \"help(paste)\" in    # the console    } # To finish the loop, you have to close these brackets here ## [1] \"The count is at 1 right now\" ## [1] \"The count is at 2 right now\" ## [1] \"The count is at 3 right now\" ## [1] \"The count is at 4 right now\" ## [1] \"The count is at 5 right now\" ## [1] \"The count is at 6 right now\" ## [1] \"The count is at 7 right now\" ## [1] \"The count is at 8 right now\" ## [1] \"The count is at 9 right now\" ## [1] \"The count is at 10 right now\""},{"path":"https://mjanuario.github.io/evolved/articles/intro_r.html","id":"last-remarks","dir":"Articles","previous_headings":"","what":"Last remarks","title":"Introduction to R","text":"short introduction many things R can . many things R can , like plotting panels running simulations. get worthwhile display R’s abilities labs. difficulties passing tasks now finished, first : congratulations! easy task. certainly learned lot, sure give treat rest.","code":""},{"path":"https://mjanuario.github.io/evolved/articles/intro_r.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Introduction to R","text":"Popescu, . ., Huber, K. T., & Paradis, E. (2012). ape 3.0: New tools distance-based phylogenetics evolutionary analysis R. Bioinformatics, 28(11), 1536-1537.","code":""},{"path":"https://mjanuario.github.io/evolved/articles/phylogenies_and_diversification.html","id":"molecular-phylogenies","dir":"Articles","previous_headings":"","what":"Molecular phylogenies:","title":"Phylogenies and diversification","text":"Using data molecular variation multiple species, can build date molecular phylogeny. instance, can look whale phylogeny: check “plain” phylogeny following code: particular phylogeny, build-function help visualize subclades:  Now visualize lineage--time (LTT) plots phylogenetic tree. LTT plots contain lot information phylogenetic tree structure, instance tell lot shape trees produced different speciation extinction rates.  Ok, plot stores info phylogeny?","code":"data(\"whale_phylo\") plot(whale_phylo, cex = 0.6) axisPhylo() plotPaintedWhales(knitr = TRUE) ## no colors provided. using the following legend: ##                    1        Baleen whales        Beaked whales  ##              \"black\"            \"#DF536B\"            \"#61D04F\"  ## Belugas and narwhals             Dolphins     Other mysticetes  ##            \"#2297E6\"            \"#28E2E5\"            \"#CD0BBC\"  ##            Porpoises  ##            \"#F5C710\" lttPlot(whale_phylo, knitr = T)"},{"path":"https://mjanuario.github.io/evolved/articles/phylogenies_and_diversification.html","id":"diversification","dir":"Articles","previous_headings":"","what":"Diversification","title":"Phylogenies and diversification","text":"figure students can use pure-birth (=“Yule”) model, predicts rate can generate large number species. show first estimate speciation (.e., birth rate) know whale originated ~36 million years ago, can simulate many alternative diversification scenarios, following parameters estimated:  Now know Yule model can generate many species. Let’s check LTT’s model can generate:  empirical phylogeny different simulated. hypotheses can students make explain discrepancy? Maybe Yule model simplistic (.e., model extinction )? can test , instance replacing estimateSpeciation() function thefitCRBD(), re-simulations, extra layer complexity.","code":"whalerate = estimateSpeciation(whale_phylo) sims=vector()  for(i in 1:10000){   sims = c(sims, simulateBirthDeathRich(S = whalerate, E=0, t = 36)) }  hist(sims, breaks = 100) t = simulateTree(c(whalerate, 0), max.taxa = 40, max.t = Inf) ape::ltt.plot(t, col=\"white\", ylim=c(0,87))  for(i in 1:100){   t = simulateTree(c(whalerate, 0), max.taxa = 40, max.t = Inf)   ape::ltt.lines(t, col=\"#FF000032\")   }  #Now, we add the actual whale phylogeny: ape::ltt.lines(whale_phylo, col=\"black\")"},{"path":"https://mjanuario.github.io/evolved/articles/popgen_drift.html","id":"learning-objectives","dir":"Articles","previous_headings":"","what":"Learning objectives","title":"Sampling alleles, genetic drift and effective population size","text":"Genetic drift: qualitative expectation Genetic drift: building intuition Dissecting variability outcomes Genetic drift heterozygosity decay Effective population size Historical note Let’s load package:","code":"library(evolved)  # Let's also store our par() configs so  # we can restore them whenever we change it in this tutorial oldpar <- par(no.readonly = TRUE)"},{"path":"https://mjanuario.github.io/evolved/articles/popgen_drift.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Sampling alleles, genetic drift and effective population size","text":"previous labs, introduced simple way applying probability rules allele change small number generations. lab, extrapolate qualitatively quantitatively insights, see happens genetic diversity time.","code":""},{"path":"https://mjanuario.github.io/evolved/articles/popgen_drift.html","id":"genetic-drift-qualitative-expectation","dir":"Articles","previous_headings":"","what":"Genetic drift: qualitative expectation","title":"Sampling alleles, genetic drift and effective population size","text":"may know, Peter Buri experiment genetic drift 1956. started many flask populations Drosophila melanogaster applied simple method keep track genetic drift. words (Buri, 1956): “method consists observations changes gene frequency generations large number small cultures size breeding population controlled. initial culture founds line successive generation initiated random sample uniform size taken among flies preceding generation. form fairly large experimental population divided number small completely isolated subunits.” Thus, experiment involves sampling adults random flask placing new flask mate. offspring reach adulthood sampled, thus producing new generation. , keep track relative frequencies genotypes time. Now, imagine Buri’s lab run experiment using 1000 flasks (tracked 212 total). individuals flask become able reproduce, randomly uniformly (.e. individuals equally likely sampled) pick 8 virgin females flask generation mate 8 random males flask generation. mating successful generates many viable offspring. Assume males females diverge genotypic frequencies. Recall also Drosophila melanogaster diploid organism. familiar inserting image RMarkdown file: First, make sure image inside current working directory, .e. inside reference folder R use knit RMarkdown file. , can use following syntax, replacing file_name.jpg specific name image.","code":"![](file_name.jpg)"},{"path":"https://mjanuario.github.io/evolved/articles/popgen_drift.html","id":"genetic-drift-building-intuition","dir":"Articles","previous_headings":"","what":"Genetic drift: building intuition","title":"Sampling alleles, genetic drift and effective population size","text":"Now computer simulation Buri . use rbinom() function draw allele counts population diploid organism time. function applying following algorithm: Start certain probability pp sampling specific allele (e.g., A1A_1) based allele’s frequency population. Generate next generation taking random draws binomial distribution given probability pp sampling copies allele A1A_1. Recalculate new allele frequency. just observed drift! Remember binomial distribution applies binary processes number “successes”. binary process sampling alleles – organisms diploid, 2 alleles either A1A_1 A2A_2, exceptions. number “successes” total number A1A_1 alleles (.e., allele frequency, pp) next flask. , single flask first generation experiment can simulated : Now, next generation, just redo process, time using p1p_1, allele frequency generation 1, new probability sampling A1A_1 alleles: third generation ? fourth : fifth : happening code result generation? Let’s plot results now. Note results different generating different random numbers us .  Repeat lines code times get feeling happening. simulations behave way? Can identify different “archetypes” dynamics? Instead tediously copying pasting code console, can run large numbers simulations quite easily using function WFDriftSim(): Run chunk code many times get feeling . changing Ne, n.gen, p0, n.sim affect simulations? function calculate simulation’s alleles fixed.","code":"N <- 32 #population size n_alleles <- 2*N  p_gen0 <- 0.25 #Frequency of allele A1 in the first gen p_gen1 <- rbinom(1, n_alleles, p_gen0) / n_alleles p_gen1 ## [1] 0.171875 p_gen2 <- rbinom(1, n_alleles, p_gen1) / n_alleles p_gen2 ## [1] 0.21875 p_gen3 <- rbinom(1, n_alleles, p_gen2) / n_alleles p_gen3 ## [1] 0.234375 p_gen4 <- rbinom(1, n_alleles, p_gen3) / n_alleles p_gen4 ## [1] 0.1875 p_gen5 <- rbinom(1, n_alleles, p_gen4) / n_alleles p_gen5 ## [1] 0.078125 generations <- seq(from = 0, to = 5, by = 1) p_through_time <- c(p_gen0, p_gen1, p_gen2, p_gen3, p_gen4, p_gen5) plot(generations, p_through_time, type=\"l\", lwd = 2, col = \"darkorchid3\",      ylab = \"p\", xlab = \"generations\", las = 1) #We will simulate five flasks through 10 generations: WFDriftSim(Ne = 32, n.gen = 10, p0 = 0.5, n.sim = 5) # R will not return anything in the console when you run this, but  # after running you should have this function in your R session # as an object. Note that if you name another object as \"isFixed\" # the function will be overwritten.  isFixed <- function(p, tol = 0.00000000001){          if (p <= tol | p >= (1 - tol)){         return(TRUE)     } else{         return(FALSE)     }  }  # Assuming your current allele frequency is stored in the p_t object, the # line below uses the function created above to test if p_t is equal to  # zero OR equal to one isFixed(p_t) # The function will return `TRUE` if p_t is equal to zero or one."},{"path":"https://mjanuario.github.io/evolved/articles/popgen_drift.html","id":"dissecting-the-variability-in-outcomes","dir":"Articles","previous_headings":"Genetic drift: building intuition","what":"Dissecting the variability in outcomes","title":"Sampling alleles, genetic drift and effective population size","text":"simulations contain many independent flasks (.e. n.sim > 40), hard keep track whole history allele frequency change flask. histogram right line plot output WFDriftSim becomes particularly helpful. Take look histogram section output plot typing following console:","code":"WFDriftSim(Ne = 32, n.gen = 10, p0 = 0.5, n.sim = 100)"},{"path":"https://mjanuario.github.io/evolved/articles/popgen_drift.html","id":"genetic-drift-and-heterozygosity-decay","dir":"Articles","previous_headings":"","what":"Genetic drift and heterozygosity decay","title":"Sampling alleles, genetic drift and effective population size","text":"lecture, learned analytic formula calculate heterozygosity decay time due drift. Example store (handle) simulation results:  Notice actual generation number match column numbers!","code":"data = WFDriftSim(Ne = 8, n.gen = 50, p0 = 0.5, n.sim = 50,                   print.data = T, plot.type = \"none\")  #then, if we want to see the 2nd to 5th generations of  # the simulations number 14, 17 and 18, we type: sims <- c(14,17,18) gens <- 3:6 subset_data <- data[sims, gens] subset_data ##         gen2   gen3   gen4   gen5 ## sim14 0.4375 0.3125 0.3125 0.3125 ## sim17 0.5625 0.8125 0.8125 0.6875 ## sim18 0.1875 0.1250 0.0625 0.0000 #and we can also plot those results:  #first opening an empty plot: plot(NA, ylab = \"Alleleic frequency\", xlab = \"Generation\",      xlim = c(2, 5), ylim = c(0, 1))  #creating a set of colors to paint our lines cols <- rainbow(n = nrow(subset_data))  #then we finally add the lines to our plot: for (i in 1:nrow(subset_data)) {   lines(x = gens - 1, y = subset_data[i,], col = cols[i]) }"},{"path":"https://mjanuario.github.io/evolved/articles/popgen_drift.html","id":"effective-population-size","dir":"Articles","previous_headings":"","what":"Effective population size","title":"Sampling alleles, genetic drift and effective population size","text":"know real populations, census size might different effective population size. Ne=11t∑=1t1Ni\\begin{equation} N_e = \\frac{1}{\\frac{1}{t}\\sum_{=1}^t \\frac{1}{N_i}} \\end{equation}","code":""},{"path":"https://mjanuario.github.io/evolved/articles/popgen_drift.html","id":"some-food-for-thought","dir":"Articles","previous_headings":"Effective population size","what":"Some food for thought:","title":"Sampling alleles, genetic drift and effective population size","text":"Assuming equal number females males, equal number generations, bottlenecks equal magnitude (equally drastic changes census size), options greatest influence NeN_e given equation (1)? ? large census size prior bottleneck Experiencing bottleneck brief large census size bottleneck nice -depth discussion effective population size means can found Waples (2022).","code":""},{"path":"https://mjanuario.github.io/evolved/articles/popgen_drift.html","id":"historical-note","dir":"Articles","previous_headings":"","what":"Historical note","title":"Sampling alleles, genetic drift and effective population size","text":"Kimura’s (1955) diffusion approximation distribution allele frequencies populations drift elegant difficult. Understanding derivation requires fairly sophisticated mathematics. However, much easier way generate visualize expectation distribution allele frequencies across populations drift, assume population size reasonably small. solution described involves Markov chain model drift. Fundamentally, probability model use binomial sampling model. nothing “coin-toss” distribution: probability getting (say) kk heads nn coin tosses, given probability heads given toss pp? formally denote probability P(k|n;p)P(k|n; p). binomial sampling model, can estimate probability P(k|n;p)P(k|n; p) using binomial probability, : P(k|n;p)=(nk)pk(1−p)n−k\\begin{equation} P(k | n; p) = \\binom{n}{k} p^k (1-p)^{n-k} \\end{equation} Let’s say population alleles AA aa, respective frequencies pp 1−p1 - p. relationship binomial model genetic drift , finite population, can use compute exact probability sample kk alleles given type given generation, given initial frequency pp. , example, consider Buri’s genetic drift data, 2N=322N = 32, initial allele frequencies equal (p=0.5p = 0.5). Given starting configuration time t0t_0 (e.g., n=32n = 32, p=0.5p = 0.5), can use binomial probability compute exact probability sampling kk alleles generation t1t_1. ’m going switch notation . shorthand, ’m going use expression Pi,kP_{, k} denote probability population kk type AA alleles ii copies one generation drift (sampling). necessarily depends particular population size. example, P13,16P_{13, 16} probability given generation random mating Wright-Fisher population gives 13 AA alleles given population currently 16 alleles, obviously, probability critically dependent population size. Buri data, 2N=322N = 32, probability P13,16P_{13 , 16} corresponds binomial parameters p=0.5p = 0.5 n=32n = 32. probability obviously differ nn. Now, imagine forming matrix 2N+12N + 1 columns 2N+12N + 1 rows. , element (,k)(, k) gives probability – transition probability – associated sampling ii alleles type AA generation t+1t+1 given currently kkAA alleles generation tt. matrix 2N+12N + 1 rows columns also extra row column account state 00 alleles. [P0,0P0,1P0,2⋯P0,nP1,0P1,1P1,2⋯P1,nP2,0P2,1P2,2⋯P2,nP3,0P3,1P3,2⋯P3,n⋮⋮⋮⋱⋮Pn,0Pn,1Pn,2⋯Pn,n]\\begin{bmatrix} P_{0,0} & P_{0,1} & P_{0,2}  & \\cdots & P_{0, n}\\\\ P_{1,0} & P_{1,1} & P_{1,2}  & \\cdots & P_{1, n}\\\\ P_{2,0} & P_{2,1} & P_{2,2}  & \\cdots & P_{2, n}\\\\ P_{3,0} & P_{3,1} & P_{3,2}  & \\cdots & P_{3, n}\\\\ \\vdots & \\vdots   & \\vdots   & \\ddots & \\vdots \\\\  P_{n,0} & P_{n,1} & P_{n,2}  & \\cdots & P_{n, n}\\\\ \\end{bmatrix} course, probability going 00AA alleles number alleles greater 00 also 00 (0 absorbing state – allele lost population, increase frequency). first column necessarily zero, exception P0,0P_{0,0}, 11 (00AA alleles time tt, 00AA alleles time t+1t + 1 probability 11). general idea holds last column: maximum number AA alleles, e.g., nnAA alleles, can’t sample 22 following generation. example, 2N=322N = 32, 00 3232 absorbing states. matrix : [1P0,1P0,2⋯00P1,1P1,2⋯00P2,1P2,2⋯00P3,1P3,2⋯0⋮⋮⋮⋱⋮0Pn,1Pn,2⋯1]\\begin{bmatrix} 1 & P_{0,1} & P_{0,2}  & \\cdots & 0\\\\ 0 & P_{1,1} & P_{1,2}  & \\cdots & 0\\\\ 0 & P_{2,1} & P_{2,2}  & \\cdots & 0\\\\ 0 & P_{3,1} & P_{3,2}  & \\cdots & 0\\\\ \\vdots & \\vdots   & \\vdots   & \\ddots & \\vdots \\\\  0 & P_{n,1} & P_{n,2}  & \\cdots & 1\\\\ \\end{bmatrix} Let’s call matrix PP. transition matrix, really nice properties. matrix includes probabilities possible pairwise transitions states. , columns matrix must sum 11. ’ve defined matrix, can fill individual elements binomial probabilities. , example, assuming 2N=322N = 32, can fill P3,5P_{3, 5} first noting frequency AA time tt p=532p = \\frac{5}{32}. P3,5=(323)(532)3(1−532)32−3\\begin{equation} P_{3,5} = \\binom{32}{3} \\binom{5}{32}^3 (1-\\frac{5}{32})^{32-3} \\end{equation} amazing thing transition matrix PP can use compute distribution alleles generation random mating, given initial vector allele counts N0N_0. , N0N_0 vector property element ii vector gives number populations ii alleles. example, N0[0]N_0[0] gives number initial populations 00AA alleles. Buri data, roughly 100 populations equal allele frequencies, N0[16]=100N_0[16] = 100 (100 populations, 16 AA alleles time t=0t = 0) elements vector equal zero. can now construct Markov chain, compute probability distribution populations given allele count, N1=PN0\\begin{equation} N_1 = PN_0 \\end{equation} PN0P N_0 involves matrix multiplication column vector N0N_0 square matrix PP. N1N_1 mean number populations allele count category. example, N1[7]N_1[7] number populations generation t=1t = 1 77 alleles (remember: starting state given vector N0N_0). generally, : Nt+1=PNt\\begin{equation} N_{t+1} = PN_t \\end{equation} can see going. ’s recursive relationship whereby: Nt+2=P(PN0)\\begin{equation} N_{t+2} = P (P N_0) \\end{equation} Nt+3=P(P(PN0))\\begin{equation} N_{t+3} = P ( P (P N_0)) \\end{equation} Etc etc. Thus, computing distribution allele frequencies can easily done iterating equation given , provided PP N0N_0. R code implements model uses compute distribution populations possible number alleles, using Buri’s Drosophila study guide. Finally, plot :   visually resembles figure 6 Buri (1956) – please remember analytical expectation. little history mathematical model can found initial parts Tran et al (2013) – note mathematics developed later parts paper may challenging. original references Wright-Fisher population model Fisher (1922) Wright (1931).","code":"# A simple genetic drift simulator as a Markov process N       <- 16 popsize <- 2*N  # Now we define a transition matrix, such that: # Each element of the transition matrix is a transition probability #   Specifically: element Pi,j is the probability of going from #   j alleles to i alleles in a single sampling step  #    tmat <- matrix(0, nrow = popsize + 1, ncol = popsize + 1) # along rows: current allele count; along cols: future allele count  # Fill in elements with probabilities from the binomial distribution # If you have j alleles in generation t-1, then this defines the probability # of sampling (0,1....2N) alleles in the next generation, under a binomial  # sampling process:  # Note also that first column and row are absorbing states of 0  # Here is the vector of frequencies: probvec <- (1:popsize) / popsize    # What is the probability of getting to 0 allele copies, given  # that you have 1? This is P01, and the transition probability  # would be computed using 1/2N (=1/32) as the sampling probability  # for the allele.  # Here, this is computed using the function dbinom, which is a shortcut  #   to the analytical binomial probability: dbinom(1, popsize, prob = 1/32) ## [1] 0.3737345 # Now we will set up the full matrix by iterating this over rows:  for (ii in 1:nrow(tmat)){     tmat[ii, 2:ncol(tmat)] <- dbinom(ii - 1, size = popsize, prob = probvec) }  # Note: we ignore the first column and let almost all elements equal zero,  # because the probability of sampling k alleles given that you currently have zero # is zero everywhere except the special case of P00, which is 1  # (if you have zero now, you will have zero in the next gen with probability 1) # To address this, we manually set element P00 equal to 1: tmat[1,1] <- 1  #Now, all the columns should sum to 1: colSums(tmat) ##  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 # Pt <- tmat^2*P0   # Initial vector of population frequencies: # Like Buri, suppose we do an experiment with 100 populations # each with equal allele frequencies (p = q = 0.5) initially. p_init <- rep(0, popsize + 1)  # note, in this indexing: #   p_init[1] is the number of populations with 0 alleles #   p_init[2] is the number with 1 allele #   p_init[popsize + 1] is the number with 2N alleles  # we want the initial population to have 2N/2 = N p alleles (for 50:50 proportion of alleles) #  so we fill in the N+1 element of p_init vector with the  #  number of populations  p_init[N+1] <- 100 #Now, we will introduce drift in our simulation # after 1 generation of random mating in Wright-Fisher (WF) population,  #  the distribution of populations is: tmat %*% p_init   # and after 2 generations, it is: tmat %*% (tmat %*% p_init)  # and after 3 generations, it is: tmat %*% (tmat %*% (tmat %*% p_init)) # This is easy enough to iterate. # Here, we will make a matrix to hold  # the results, for up to ngen generations  ngen    <- 20 freqmat <- matrix(NA, nrow=popsize+1, ncol=ngen)  curr_pop <- p_init   for (ii in 1:ngen){          # recompute the new pop frequency distribution     curr_pop <- tmat %*% curr_pop     # store it:     freqmat[,ii] <- curr_pop } # setting the axes of our plot: x <- c(0, probvec) y <- seq_len(ncol(freqmat)) z <- freqmat  # apply a colorscale: cols <- colorRampPalette(c(\"blue\", \"yellow\", \"red\"))(100) # averaging facet for coloring zfacet <- (z[-1, -1] + z[-1, -ncol(z)] + z[-nrow(z), -1] + z[-nrow(z), -ncol(z)]) / 4 facetcol <- cols[cut(zfacet, 100)]  persp(   x, y, z,   theta = 45, phi = 20,   col = facetcol,   border = NA,   xlab = \"Allele frequency\",   ylab = \"Generations\",   zlab = \"Number of populations\" ) ########## ##########  # Plotting selected generations: plot.new() par(oma=c(1,1,1,1), mfrow=c(2,2), mar=c(2,2,2,0))  pfx <- function(gen){     plot.new()     plot.window(xlim=c(0,33), ylim=c(0, 15))     axis(1, at=seq(-4, 36, by=4))     axis(2, at=seq(-2, 16, by=2), las=1)     lines(x=c(16,16), y=c(0, 18), lwd=5, col=\"gray60\")     title(main = paste(\"After\", gen, ifelse(gen == 1, \"gen\", \"gens\"))) }  # Expectation after 1 generation of drift: pfx(1) points(x=0:32, y=freqmat[,1], pch=21, bg=\"red\", cex=1.5)  # Expectation after 5 generations of drift pfx(5) points(x=0:32, y=freqmat[,5], pch=21, bg=\"red\", cex=1.5)  # Expectation after 10 generations of drift pfx(10) points(x=0:32, y=freqmat[,10], pch=21, bg=\"red\", cex=1.5)  # Expectation after 15 generations of drift pfx(15) points(x=0:32, y=freqmat[,15], pch=21, bg=\"red\", cex=1.5) # Restoring old par() configs: par(oldpar)"},{"path":"https://mjanuario.github.io/evolved/articles/popgen_drift.html","id":"references","dir":"Articles","previous_headings":"Historical note","what":"References:","title":"Sampling alleles, genetic drift and effective population size","text":"Buri, P. (1956). Gene frequency small populations mutant Drosophila. Evolution, 367-402. Fisher RA (1922) dominance ratio. Proc. R. Soc. Edinb 42:321–341 Kimura, M. (1955). Solution process random genetic drift continuous model. Proceedings National Academy Sciences United States America, 41(3), 144. Tran, T. D., Hofrichter, J., & Jost, J. (2013). introduction mathematical structure Wright–Fisher model population genetics. Theory Biosciences, 132(2), 73-82. [good historical review, math can challenging] Waples, R. S. (2022). Ne, anyway?. Journal Heredity, 113(4), 371–379. Wright S (1931) Evolution Mendelian populations. Genetics 16:97–159","code":""},{"path":"https://mjanuario.github.io/evolved/articles/popgen_intro.html","id":"learning-objectives","dir":"Articles","previous_headings":"","what":"Learning objectives","title":"Introduction to evolutionary genetics","text":"Simple math notation Probability independent events Random number generators density/mass probability functions Malthusian growth Mendelian genetics Hardy-Weinberg Equilibrium single locus Heterozygosity HWE, deleterious alleles, mutation Mendelian genetics multiple loci Describing genetic variation DNA segments First, load packages:","code":"library(evolved)"},{"path":"https://mjanuario.github.io/evolved/articles/popgen_intro.html","id":"introduction","dir":"Articles","previous_headings":"Learning objectives","what":"Introduction","title":"Introduction to evolutionary genetics","text":"Since now familiar R, can proceed first lab evolutionary processes. Today, focus fundamental entity evolution: genes. first review laws probability can used build simple (powerful!) models genotypic evolutionary change. calculate properties test hypotheses change. finish lab introducing methods measure genetic diversity generated processes. important note change conventions quickly tutorial, meaning letter might different meanings different equations, mindful section .","code":""},{"path":"https://mjanuario.github.io/evolved/articles/popgen_intro.html","id":"simple-math-notation","dir":"Articles","previous_headings":"Learning objectives","what":"Simple math notation","title":"Introduction to evolutionary genetics","text":"first notation introduce summation, denoted uppercase Greek letter sigma (∑\\sum_{}). Usually, subscript letter tells element start operation, upperscript tells element summation ends. instance notation: ∑=1nxi\\begin{equation} \\sum_{=1}^{n}x_i \\end{equation} indicates summation elements starting first (= 1) going n-th element (upperscript). left implicit notation summation made element element, sometimes information might appear explicitly. familiar R’s loops, may useful think summation representing loop iterates sub- upperscript, time applying operation adding result running sum. familiar example formula calculate arithmetic mean: X‾=1n×∑=1nxi\\begin{equation} \\bar{X} = \\frac{1}{n} \\times \\sum_{=1}^{n}x_i \\end{equation} another example, take following equation, describes expected number heterozygotes diploid population kk alleles Hardy-Weinberg equilibrium: H=∑=1;≠jkpipj\\begin{equation} H = \\sum_{=1 ; \\neq{j}}^{k}p_ip_j \\end{equation} kk number alleles, pip_i pjp_j frequencies iith jjth alleles. Note right side equality, sum product allele frequencies. inequality ≠ji\\neq{j} tells apply summation =ji=j. kind explicit information may appear summation. , case k=3k=3, following equation: Hk=3=∑=1;≠j3pipj=(p1×p2)+(p1×p3)+(p2×p1)+(p2×p3)+(p3×p1)+(p3×p2)H_{k=3} = \\sum_{=1 ; \\neq{j}}^{3}p_ip_j = (p_1 \\times p_2) + (p_1 \\times p_3) + (p_2 \\times p_1) + (p_2 \\times p_3) +  (p_3 \\times p_1) + (p_3 \\times p_2) Just sake completion, one also say : H=1−G=1−(∑=1kpi2)H = 1-G = 1- (\\sum_{=1}^{k}p_i^2) equivalent summation multiplication, symbolized uppercase Greek letter pi (∏\\prod_{}). , probability PP nn independent events vv, probability PvP_v : P=∏=1nPv\\begin{equation} P = \\prod_{=1}^{n}P_{v} \\end{equation} vv representing event. Note upper- subscript read way summation.","code":""},{"path":"https://mjanuario.github.io/evolved/articles/popgen_intro.html","id":"probability-of-independent-events","dir":"Articles","previous_headings":"Learning objectives","what":"Probability of independent events","title":"Introduction to evolutionary genetics","text":"joint probability independent events multiplication respective probability (quick video recap ). , probability seeing “snake eyes” (.e. two “ones”) throw two dice : 16×16=∏=vn=216=136\\begin{equation} \\frac{1}{6} \\times \\frac{1}{6} = \\prod_{=v}^{n=2} \\frac{1}{6} = \\frac{1}{36} \\end{equation} notation middle equality might seem overly complicated compared left side equality, compactness notation becomes clear want multiply many elements. R functions allow “throw dice” study probability events. functions generate random numbers probability functions.","code":""},{"path":"https://mjanuario.github.io/evolved/articles/popgen_intro.html","id":"random-number-generators-and-densitymass-probability-functions","dir":"Articles","previous_headings":"Learning objectives","what":"Random number generators and density/mass probability functions","title":"Introduction to evolutionary genetics","text":"Using functions generate random numbers, can simulate much just coins dice. R functions generate random draws famous probability distributions. explore concept, focus one famous distributions: binomial distribution. binomial distribution applies samples events binomial outcome, coin flips result either “heads” “tails” outcome. jargon field, call one outcomes “success” one “failure”; makes sense coin flip analogy imagine using coin determine result outcome, one sides favorable outcome (e.g. eat piece chocolate coin lands heads, chocolate tails). binomial distribution two major properties: counts number “successes” resulting sample binomial events probability success events binomial distribution therefore distribution integers represent many successes within sample binomial events. distribution made taking many repeated samples. time generate random number binomial distribution, generating integer xx 0 (successes occurred) total number coin flips nn (successes occurred). coin tossing example, xx equivalent counting heads nn coin tosses. Like probability functions, binomial distribution certain parameters. : pp, probability success single binary event, nn, total number binary events. coin flip example, pp 0.5, representing 50% chance getting heads. nn however many times flip coin. Let’s simulate coin flip. Recall binomial distribution outputs number successes sample events, generated random number represents. use rbinom function randomly generate numbers binomial distribution. rbinom r-family functions, collection functions randomly generate numbers probability distributions. potential point confusion , rbinom, argument size represents parameter nn discussed , argument n actually represents total number times repeated sampling. argument prob represents parameter pp discussed , probability success – much straightforward. line code represents flipping coin (50% chance heads) 10 times counting number heads flipped total rr times. check object binom_nbrs contains, see… … bunch integers 0 10. integers represents number heads flipped sample 10 coin tosses. binomial discrete probability function, meaningful tabulate frequencies number got random draw just made: can also plot easily.  random numbers generated – .e., stochastic realizations process follows distribution chose. number represents summation number successes per sample. instead stochastic realization binomial process, wanted know fixed probability associated specific number successes? , use d-family functions! calculate probability density associated event. event case number successes. instance, directly calculate probability observing, say, 3 heads sample 10 coin tosses, write: function basically just applies probability mass function binomial distribution, Px=(nx)px(1−p)n−x\\begin{equation} P_x = \\binom{n}{x} p^x (1-p)^{n-x} \\end{equation} : (nx)=n!x!(n−x)!\\binom{n}{x} = \\frac{n!}{x!(n-x)!} Knowing dinom simply using function written , manually calculate expected probability density x=3x=3, check make sure dbinom gives . , use equation (6) substitute nn 10 xx 3 – get exactly number output dbinom, 0.1171875. difference stochastic realization process, acquired rbinom, theoretically expected outcome process, acquired dbinom. draw many random numbers, able approximate expected probability calculating proportion outcome. think? good approximation? improve ? can also plot random draws made:","code":"# Define how many samples we want: rr <- 10000 binom_nbrs <- rbinom(n = rr, size = 10, prob = 0.5)  # taking 10000 samples of 10 head(binom_nbrs, 10) ##  [1] 3 7 5 3 1 5 5 4 6 6 table(binom_nbrs) ## binom_nbrs ##    0    1    2    3    4    5    6    7    8    9   10  ##    9   84  390 1191 2050 2437 2118 1182  439   92    8 plot(   table(binom_nbrs),   ylab=\"Frequency\", xlab=\"Number of successes\") P_x3_s10_p0.5 <- dbinom(x = 3, size = 10, prob = 0.5)  # x is the integer value we want to know the probability density of  P_x3_s10_p0.5 ## [1] 0.1171875 # comparing the stochastic realization of x = 3 with the expectation for x = 3 table(binom_nbrs)[4] / rr #why the division? ##      3  ## 0.1191 P_x3_s10_p0.5 ## [1] 0.1171875 plot(   table(binom_nbrs)/rr,    ylab=\"Probability\", xlab=\"Number of heads\")  # Finally, we can mark the probability we are interested in # by using a red dot in our plot: points(x = 3, y = P_x3_s10_p0.5, col = \"red\", cex = 2)"},{"path":"https://mjanuario.github.io/evolved/articles/popgen_intro.html","id":"malthusian-growth","dir":"Articles","previous_headings":"Learning objectives","what":"Malthusian growth","title":"Introduction to evolutionary genetics","text":"idea geometric/exponential/Malthusian growth major importance evolutionary biology. probably learnt concept , reiterate . Although often called “Malthusian growth”, basic analytic approach first developed Euler published 1748. modeled population growth equation (7): Nt+1=(1+x)Nt\\begin{equation} N_{t+1} = (1 + x)N_t \\end{equation} xx growth rate population fractional increase per year, NN population size (number individuals), tt time.","code":""},{"path":"https://mjanuario.github.io/evolved/articles/popgen_intro.html","id":"calculating-and-visualizing-exponential-growth-in-r","dir":"Articles","previous_headings":"Learning objectives > Malthusian growth","what":"Calculating and visualizing exponential growth in R","title":"Introduction to evolutionary genetics","text":"Instead relying function determine population size future, can simulate population growth across time. First decide initial value population size. number hermaphrodite individuals, number reproductive females population. Let’s also construct vector store time. need decide value RR. also decide far time projections population size go. Let’s also create vector stores generations simulate . Now construct programming called loop. just series similar steps repeated. like running chunk code , small changes inputs parameter values (explanation can found ). create loop . Notice way loop works completely dependent way set objects (.e., popsize, time, R, tmax, ) . change loop change objects structured/organized, code may return error message (give right result). safe though change numeric values objects explore exponential growth behaves different values. Now, visualize results simulation just . Let’s first create empty plot, includes providing numerical range x y axes plot. , add line describing size population time.  Try change numbers inside arguments xlim ylim. change plot? Now, make plot exponential growth four populations: one R<1R < 1, one R=1R = 1, one R>1R > 1, one R>xR > x, x number choice must greater 1. Color populations using increasing darker shades chosen color. (Names colors R can found ). Choose x y limits (arguments xlim ylim, respectively, plot() function) think best describes qualitatively difference(s) 4 lines. Repeat plot , time plot y axis log scale.","code":"popsize <- 10 time <- 0 R <- 1.05 tmax <- 100 # this is the number of generations all_generations <- seq(from = 1, to = tmax, by = 1) # For each generation, beginning in the generation = 1 and: for(generation in all_generations){       N_t <- popsize[length(popsize)] # by indexing    # the vector in this way (i.e. using \"[length()]\"),   # we guarantee we are always taking the last value of    # this vector.      N_t_plus_one <- N_t * R # this is the application of Euler's formula      #Now, let's store the population size at that generation:   popsize <- c(popsize, N_t_plus_one)      #let's not forget to record the time that we are on:   time <- c(time, generation)  } # plot(NA, xlim=c(0,tmax), ylim=c(0,1500),      xlab=\"time\", ylab=\"Population size\",      main=\"Malthusian growth\") lines(x = time, y = popsize, col = \"blue\", lwd = 3)"},{"path":"https://mjanuario.github.io/evolved/articles/popgen_intro.html","id":"mendelian-genetics-and-hardy-weinberg-equilibrium-hwe-at-a-single-locus","dir":"Articles","previous_headings":"Learning objectives","what":"Mendelian genetics and Hardy-Weinberg Equilibrium (HWE) at a single locus","title":"Introduction to evolutionary genetics","text":"now use simulations test observed set genotype counts consistent see sampled genotypes random. first create null pattern using R functions, contrast pattern observed genotype frequencies compare expectations Hardy-Weinberg equilibrium (hereafter, HWE, Hardy, 1908; Weinberg, 1908). historical perspective HWE, recommend reading Mayo (2008). purposes lab, look bear population Canada.","code":""},{"path":"https://mjanuario.github.io/evolved/articles/popgen_intro.html","id":"kermode-bear-from-british-columbia","dir":"Articles","previous_headings":"Learning objectives > Mendelian genetics and Hardy-Weinberg Equilibrium (HWE) at a single locus","what":"Kermode bear from British Columbia","title":"Introduction to evolutionary genetics","text":"Hedrick & Ritland (2012) studied population Ursus americanus “single nucleotide change G , resulting replacement Tyr Cys codon 298 melanocortin 1 receptor gene (mc1r)” created whole new phenotype related color: “Spirit bear” variety (see figure 1, Hedrick & Ritland (2012)). previous study (Ritland et al, 2001), following frequencies genotypes observed: 42 individuals dominant homozygote phenotype, 24 heterozygotes, 21 recessive genotypes. Hedrick & Ritland (2012) asks: Spirit bear frequencies result neutral processes? equivalent asking genotype frequency simple reflex Hardy-Weinberg Equilibrium (HWE)?","code":""},{"path":"https://mjanuario.github.io/evolved/articles/popgen_intro.html","id":"calculating-allele-frequencies-from-genotypes","dir":"Articles","previous_headings":"Learning objectives > Mendelian genetics and Hardy-Weinberg Equilibrium (HWE) at a single locus","what":"Calculating allele frequencies from genotypes","title":"Introduction to evolutionary genetics","text":"Let’s start investigation simpler question: allele frequency population? idea, need count allele’s relative frequency population genetic pool. Let’s consider A1A_1 (dominant allele): first need count number A1A_1 alleles finding () many copies allele genotype carries, (b) multiplying number individuals relevant genotype. , applying data Spirit bear: counts(A1)=(42*2)+(24*1)+(21*0)=108counts(A_1) = (42 * 2) + (24 *1) + (21*0) = 108 sum terms divide sum total number alleles population get allele frequency. gene two alleles, get: f(A1)=counts(A1)counts(A1)+counts(A2)\\begin{equation} f(A_1) = \\frac{counts(A_1)}{counts(A_1) + counts(A_2)}  \\end{equation} : f(A1)=108(108+66)=0.617f(A_1) = \\frac{108}{(108+66)} = 0.617","code":""},{"path":"https://mjanuario.github.io/evolved/articles/popgen_intro.html","id":"a-statistical-approach-to-test-for-hwe-and-a-given-allele-frequency","dir":"Articles","previous_headings":"Learning objectives > Mendelian genetics and Hardy-Weinberg Equilibrium (HWE) at a single locus","what":"A statistical approach to test for HWE and a given allele frequency","title":"Introduction to evolutionary genetics","text":"Using allele frequencies calculated , can use statistics answer question posed Hedrick & Ritland (2012). , test resembles chi-square test. first step decide upon test statistic – .e., measure care . instance, pick sum squared difference observed genotype frequency HWE expected frequency: Estat=∑g=1A(Og−Eg)2\\begin{equation} E_{stat} = \\sum_{g=1}^{} (O_g - E_g)^2 \\end{equation} OgO_g observed number individuals EgE_g expected number individuals. calculation performed genotype gg (AA total number genotypes). Considering HWE assumptions, expect frequencies p2p^2 one homozygote, q2q^2 second homozygote, 2pq2pq heterozygotes. p=0.617p =0.617, q=1−pq = 1-p, statistic calculated : Estat=(42−(0.38*87))2+(24−(0.47*87))2+(21−(0.15*87))2=428.3982E_{stat} = (42 - (0.38 * 87))^2 + (24 - (0.47 * 87))^2 + (21 - (0.15 * 87))^2 = 428.3982 Note value uses rounded allele frequencies simplicity. However, calculate frequencies using R, calculation precise lack rounding change number EstatE_{stat}. calculate value, need know: value statistic big enough reject HWE? know yet. proceed, create null distribution statistic interest (EstatE_{stat}). construct null distribution, just know distribution statistic interest assumptions HWE met. meet assumptions simulations. Note basically construction virtual Wright-Fisher population (details future lectures). make easier simulate data, use built-simulations evolved, function OneGenHWSim. takes three arguments: n.ind: number individuals population n.sim: number simulations want p: allele frequency one two alleles , want study HWE frequencies (Wright-Fisher) using 5 simulated populations 100 individuals , allele frequency f(A1)=0.467f(A_1) = 0.467, write: result shows table number individuals genotype end simulations. can use calculate statistic interest. following steps walk process. many simulations populations number individuals allele frequencies Kermode bear population studied Hedrick & Ritland (2012). Calculate EstatE_{stat} every single one many populations. good tip remember R vector calculator, can apply operation elements column data frame. don’t remember R vectorized calculations, can check Lab_00.pdf file, see : Visualize . , first use function hist() plot histogram set EstatE_{stat} values came simulations. represents distribution likely values EstatE_{stat} population following HW assumptions, adjusted particularities (.e., “parameters”) empirical population. empirical (observed) value EstatE_{stat} x axis? Measure quantitatively likelihood empirical value EstatE_{stat} generated pure chance. equivalent asking: probability , pure chance alone, observing empirical value statistic (value even extreme )? Can think simple code quantifies proportion simulations EstatE_{stat} value equal larger empirical value? Maybe one uses logical test? proportion EstatE_{stat} values equal extreme empirical value can interpreted “pseudo p-value”. one-tailed test. “p-value” called “pseudo” formal probability distribution , just approximated distribution EstatE_{stat} values created simulating data. Still, “pseudo p-value” smaller 0.05, usually feel confident rejecting null hypothesis data came distribution analogous one simulated. Note also p-value depends number simulations , number decimals p-value calculation proportional number simulations (.e., precision equal 1/n.sim) Use function abline mark relevant values histogram using vertical (argument v) horizontal (argument h) lines. Hint: make sure line plot inside values axes! manually change axes, use argument xlim = c(,B), left limit x axis, B right limit x axis. Now, use procedure answer question number five: first challenge lab recommended students feel confident R skills:","code":"sim_pops <- OneGenHWSim(n.ind = 100, n.sim = 5, p = 0.467)  #now, checking the result of our simulations: sim_pops ##       A1A1 A1A2 A2A2 ## sim_1   22   49   29 ## sim_2   21   51   28 ## sim_3   23   48   29 ## sim_4   20   54   26 ## sim_5   26   41   33 # To remember how this works, let's imagine you want to  # arbitrarily calculate (f(A1) + 3) / 4.5 for all your simulations.  #You should run:  freqs_A1 <- sim_pops$A1A1 / (sim_pops$A1A1 + sim_pops$A1A2 + sim_pops$A2A2)  result <- (freqs_A1 + 3) / 4.5 result ## [1] 0.7155556 0.7133333 0.7177778 0.7111111 0.7244444 # the above has no biological \"meaning\".  # it is just to remind you how vectorized calculation works"},{"path":"https://mjanuario.github.io/evolved/articles/popgen_intro.html","id":"heterozygosity","dir":"Articles","previous_headings":"Learning objectives","what":"Heterozygosity","title":"Introduction to evolutionary genetics","text":"defined lecture, “heterozygosity” might mean two things: probability 2 alleles sampled population different. actual frequency heterozygotes population.","code":""},{"path":[]},{"path":[]},{"path":"https://mjanuario.github.io/evolved/articles/popgen_intro.html","id":"describing-genetic-variation-in-dna-segments","dir":"Articles","previous_headings":"Learning objectives","what":"Describing genetic variation in DNA segments","title":"Introduction to evolutionary genetics","text":"saw lecture, remarkable first studies genetic variation Hubby & Lewontin (1966) Lewontin & Hubby (1966). deepen perspective studies historical current applications, recommend reading Charlesworth et al (2016). Genetic diversity important role study biological diversity. purposes class, take extremely simplifying approach calculate different, simple statistics “genetic diversity”. Consider following aligned DNA sequences 3 genes (genes separated space):","code":"Individual 1    ACCGTA   AAAAAT   CTTATA      Individual 2    AGCGGA   CATAAT   CTTATA      Individual 3    ACCGTA   AAAAAT   CTACTA      Individual 4    ACCGGA   AAAAAT   CTACTA"},{"path":"https://mjanuario.github.io/evolved/articles/popgen_intro.html","id":"references","dir":"Articles","previous_headings":"","what":"References:","title":"Introduction to evolutionary genetics","text":"Charlesworth, B., Charlesworth, D., Coyne, J. ., & Langley, C. H. (2016). Hubby Lewontin protein variation natural populations: molecular genetics came rescue population genetics. Genetics, 203(4), 1497-1503. Hardy, G. H. (1908). Mendelian proportions mixed population. Science, 28, 49–50. Hedrick, P. W., & Ritland, K. (2012). Population genetics white‐phased “Spirit” black bear British Columbia. Evolution: International Journal Organic Evolution, 66(2), 305-313. Hubby, J. L., & Lewontin, R. C. (1966). molecular approach study genic heterozygosity natural populations. . number alleles different loci Drosophila pseudoobscura. Genetics, 54(2), 577. Lewontin, R. C., & Hubby, J. L. (1966). molecular approach study genic heterozygosity natural populations. II. Amount variation degree heterozygosity natural populations Drosophila pseudoobscura. Genetics, 54(2), 595. Mayo, O. (2008). century Hardy–Weinberg equilibrium. Twin Research Human Genetics, 11(3), 249-256. Ritland, K., C. Newton, H. D. Marshall. 2001. Inheritance population structure white-phased “Kermode” black bear. Curr. Biol. 11:1468–1472. Weinberg, W. (1908). Uber den Nachweis der Vererbung beim Menschen. Jahreshefte des Vereins fur vaterlandische Naturkunde Wurttemberg, Stuttgart 64:369–382. [demonstration inheritance humans]. Translation R. . Jameson printed D. L. Jameson (Ed.), (1977). Benchmark papers genetics, Volume 8: Evolutionary genetics (pp. 115–125). Stroudsburg, PA: Dowden, Hutchinson & Ross.","code":""},{"path":"https://mjanuario.github.io/evolved/articles/popgen_selection.html","id":"learning-objectives","dir":"Articles","previous_headings":"","what":"Learning objectives","title":"Allele frequency change and selection","text":"Breeding effective population size Mutation-drift equilibrium Selection case peppered moths First, load packages:","code":"library(evolved)"},{"path":"https://mjanuario.github.io/evolved/articles/popgen_selection.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Allele frequency change and selection","text":"already saw popgen vignettes due sampling , allele frequencies predicted change time finite population – process call genetic drift. Still, many things drift also change allele frequency. work today.","code":""},{"path":"https://mjanuario.github.io/evolved/articles/popgen_selection.html","id":"breeding-effective-population-size","dir":"Articles","previous_headings":"","what":"Breeding effective population size","title":"Allele frequency change and selection","text":"Following Wright (1931), breeding effective size calculated : Ne=4NmNfNm+Nf\\begin{equation} N_e = \\frac{4N_m N_f}{N_m+N_f} \\end{equation}","code":""},{"path":[]},{"path":"https://mjanuario.github.io/evolved/articles/popgen_selection.html","id":"selection","dir":"Articles","previous_headings":"","what":"Selection","title":"Allele frequency change and selection","text":"Using function NatSelSim() (evolved) can explore selection occurs bi-allelic gene diploid organism, given set arguments: p0 initial frequency focal allele (labeled A1A_1 output plots), w11 fitness homozygote focal allele, w12 heterozygote fitness. function also requires number generations simulated (n.gen). question describes situation dominant allele higher fitness. many possibilities. Tweak parameters explore selection behaves different situations. Now, simulate biological scenarios. said , running code, try come expectations system behave – fundamental build intuition selection works. Try also vary initial frequency – important? results correspond hypotheses?","code":""},{"path":"https://mjanuario.github.io/evolved/articles/popgen_selection.html","id":"the-case-of-the-peppered-moths","dir":"Articles","previous_headings":"","what":"The case of the peppered moths","title":"Allele frequency change and selection","text":"long time, melanic individuals Biston betularia (peppered moth) considered rare. first dark morph deposited museum 1811 (Berry, 1990), 53 years species first described. first live specimen caught 37 years R.S. Edleston 1848. 16 years later, however, Edleston say dark (.k.. carbonaria) morph common morph caught garden (Berry, 1990). time many hypotheses drawn explain phenomenon (Cook & Turner, 2020), good hypothesis light-colored morphs able camouflage easier lichenous tree barks (see figure 1), dark morph easily seen birds background. However, industrial revolution, many lichen died, exposing darker tree bark underneath supposedly changing morph visible birds. Light carbonaria morphs peppered moth lichenous tree. Image wikicommons. Almost century ago, J. B. S. Haldane performed calculations peppered moth morphs estimate selection coefficient (ss) natural populations face (Haldane, 1924). , use similar approach also estimate ss, departing data assumptions Haldane used. Haldane made estimate using analytic calculations, can approach results using procedure similar one : Multiply frequency genotype population relative fitness, obtaining frequency genotypes actually reproduce. Get new allele frequency selection. , assume genotypes mate randomly, lead offspring genotypes follow frequencies expected HWE new allelic frequency (one selection). Repeat steps -II selection characteristic (.e., s=0s = 0) genetic variation anymore. Note different function NatSelSim() “hood” (can check typing function name without parenthesis R console). need data help us calculate estimates. Drawing literature, Haldane assumed carbonaria morph alelle frequency roughly 1% 1848 frequency increased 99% 50 generations. Taking Haldane’s assumptions granted, using procedure explained , going estimate intensity selection favoring dark morph. : (1) Assume carbonaria allele dominant, begin allele frequency given carbonaria allele industrial revolution. (2) , use step -III compute final frequency allele 50 generations selection. simulation, value ss fixed. (3) many simulations across range relative fitness values light morph allele. (4) Using final pp frequencies simulations, generate “profile plot”, x-axis relative fitness light morph, y-axis final frequency carbonaria allele 50 generations. , designed questions guide procedure. Since Haldane approximation, subsequent research greatly improved knowledge peppered moth evolution. fact good temporal records period melanic individuals increasing frequency obscures many details, several possibilities considered observed change, linkage disequilibrium melanic alleles heterozygote advantage (Cook & Turner, 2020). Still, Haldane’s point clear: selection can really strong natural populations! However, even though melanic morph high frequency early 20th century, allele fixed. Influx alleles via mating migrants elsewhere considered good hypothesis time , much later, DNA-based evidence favor hypothesis found (Cook & Turner, 2020). surprised natural populations, even “simple” scenarios, complex?","code":""},{"path":"https://mjanuario.github.io/evolved/articles/popgen_selection.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Allele frequency change and selection","text":"Berry, R. J. (1990). Industrial melanism peppered moths (Biston betularia (L.)). Biological Journal Linnean Society, 39(4), 301-322. Cook, L. M., & Turner, J. R. (2020). Fifty per cent : Haldane actually said. Biological Journal Linnean Society, 129(3), 765-771. Edleston, R. S., 1864. Amptydasis betularia. Entomologist, 2: 150 Haldane JBS. 1924. mathematical theory natural artificial selection. Transactions Cambridge Philosophical Society 23: 19–41. Wright, S. (1931). Evolution Mendelian populations. Genetics, 16(2), 97.","code":""},{"path":"https://mjanuario.github.io/evolved/articles/population_genetics.html","id":"hardy-weinberg-equilibrium","dir":"Articles","previous_headings":"","what":"Hardy-Weinberg equilibrium","title":"Tools for population genetics","text":"Hardy-Weinberg equilibrium (HWE) deterministic model maintenance allele-level biodiversity. However, stochastic thinking already well-established important aspect studying evolutionary biology - clear advantages introducing kind thinking students. However, typical HWE equations study material related address stochastic variation coming finite numbers individuals. function OneGenHWSim() addresses issue. , students can graph explore stochasticity HWE:  course, object generated simulations can also manipulated “data” type object, students can also simulate closed populations specific size, thus instance testing (using e.g. chi-square tests) actual hypotheses HWE adequacy explain certain genotypic frequency.","code":"nsims = 1000 sims <- OneGenHWSim(n.ind = 57, p = .2, n.sim = nsims)  boxplot(sims, frame.plot=F,         ylab=\"Number of individuals\", xlab=\"Genotype\") for(i in 1:nrow(sims)){   lines(x=1:3, y=sims[i, ], col=\"#A020F064\")   } head(sims) ##       A1A1 A1A2 A2A2 ## sim_1    2   18   37 ## sim_2    5   12   40 ## sim_3    1   20   36 ## sim_4    2   18   37 ## sim_5    4   14   39 ## sim_6    3   16   38"},{"path":"https://mjanuario.github.io/evolved/articles/population_genetics.html","id":"genetic-drift","dir":"Articles","previous_headings":"","what":"Genetic drift","title":"Tools for population genetics","text":"Students can also simulate genetic drift Wright-Fisher populations, using function WFDriftSim()  argument printData = T creates object can also handled “data”, students can use calculate drift processes, instance, amount time needed fixation:  types manipulations measurements.","code":"drifting = WFDriftSim(Ne = 10, n.gen = 100, p0 = .5, n.sim = 1000,                          print.data = T, plot.type = \"static\", knitr = TRUE) #View the first 10 generation of a few simulations. drifting[1:6, 1:11] ##      gen0 gen1 gen2 gen3 gen4 gen5 gen6 gen7 gen8 gen9 gen10 ## sim1  0.5 0.60 0.65 0.75  0.6 0.70 0.70 0.80 0.90 0.90  0.80 ## sim2  0.5 0.25 0.25 0.35  0.6 0.70 0.80 0.80 0.85 0.75  0.85 ## sim3  0.5 0.40 0.30 0.35  0.4 0.35 0.35 0.35 0.25 0.30  0.40 ## sim4  0.5 0.65 0.65 0.50  0.5 0.55 0.40 0.50 0.45 0.30  0.25 ## sim5  0.5 0.40 0.50 0.50  0.4 0.55 0.40 0.45 0.55 0.30  0.30 ## sim6  0.5 0.40 0.35 0.20  0.2 0.10 0.10 0.05 0.00 0.00  0.00 fixchecker <- function(x){   res = suppressWarnings(       min(which(x %in% 0:1), na.rm = T)     )     return(res)   }  hist(x = apply(X = drifting, MARGIN = 1, fixchecker),      main=\"Time until fixation\", xlab = \"Fixation time\")"},{"path":"https://mjanuario.github.io/evolved/articles/population_genetics.html","id":"natural-selection","dir":"Articles","previous_headings":"","what":"Natural selection","title":"Tools for population genetics","text":"Just like previously mentioned functions, NatSelSim() can generate objects can handled students “data”.  Note default function provides 4 animated plots, can changed using argument plot_type (see function help details). Now, can ask: Assuming simulated dynamics enough time, genotype simulation reached equilibrium frequency faster? result, tabulating number dominant homozygotes (“AA”), hetrozygotes (“Aa”), recessive homozygotes (“aa”). Students can manipulate objects freely, thus educators can allow use simulations explore relevant scenarios investigative manner (see types inquiries Banchi & Bell, 2008)","code":"selected = NatSelSim(w11 = .2, w12 = .3, w22 = .1,             n.gen = 20, print.data = T, plot.type = \"static\", knitr= TRUE) # a numeric tolerance to accept some frequency as close enough to equilibrium tol = 0.0001   aux = abs(apply(selected, 2, diff))  # answer (in number of generations) apply(aux>tol, 2, which.min) ## AA Aa aa  ## 20 18 18"},{"path":"https://mjanuario.github.io/evolved/articles/population_genetics.html","id":"references","dir":"Articles","previous_headings":"","what":"References:","title":"Tools for population genetics","text":"Banchi, H., & Bell, R. (2008). many levels inquiry. Science children, 46(2), 26.","code":""},{"path":"https://mjanuario.github.io/evolved/articles/rocks_and_clocks.html","id":"the-fossil-record","dir":"Articles","previous_headings":"","what":"The fossil record:","title":"Clocks and Rocks","text":"use data fossilized organism, call “fossil occurrences”. data originally obtained Paleobiology database, free--use resource standard repository data used hundreds thousands scientific research articles study history dynamics biodiversity Deep Time. Students can use functions package calculate diversity certain taxonomic rank, plot time. make fun, compare tow different taxonomic levels, plot relative, log scale:  can also visualize fossil records running:    different? test? Hint: look column names fossil object: Now, complete record? can use another dataset explored : see proportion living species fossil occurrence. Students can instance explore varies across different mammal groups, type factors (e.g. biological, geological factors) seem influencing . Results dataset can also compared (relevant) fossil records, like one can download Paleobiology Database. can also compare temporal trends species number, instance. help way, also provide biodiversity timeseries clades: contains many fossil datasets, plot first 4  Students can explore dataset, compare previously discussed ones. can compare richness thought time, calculate statistics related richness change. Explore factors (e.g. mass extinction) might affected clades, among learning problems. fossils way explore timescale evolution. , going show functions use type data work.","code":"data(\"dinos_fossil\") head(dinos_fossil) ##     phylum        class              order              family ## 1 Chordata Ornithischia NO_ORDER_SPECIFIED    Chaoyangsauridae ## 2 Chordata   Saurischia       Avetheropoda NO_FAMILY_SPECIFIED ## 3 Chordata   Saurischia       Avetheropoda NO_FAMILY_SPECIFIED ## 4 Chordata   Saurischia       Avetheropoda     Tyrannosauridae ## 5 Chordata   Saurischia       Avetheropoda     Tyrannosauridae ## 6 Chordata Ornithischia NO_ORDER_SPECIFIED        Ceratopsidae ##               genus                   species early_interval late_interval ## 1    Chaoyangsaurus     Chaoyangsaurus youngi Late Tithonian   Valanginian ## 2 Protarchaeopteryx Protarchaeopteryx robusta Late Barremian  Early Aptian ## 3       Caudipteryx          Caudipteryx zoui Late Barremian  Early Aptian ## 4       Gorgosaurus      Gorgosaurus libratus Late Campanian               ## 5       Gorgosaurus      Gorgosaurus libratus Late Campanian               ## 6      Centrosaurus      Centrosaurus apertus Late Campanian               ##   max_ma min_ma midpoint       lng      lat ## 1  150.8 132.90   141.85  123.9667 42.93330 ## 2  130.0 122.46   126.23  120.7333 41.80000 ## 3  130.0 122.46   126.23  120.7333 41.80000 ## 4   83.5  70.60    77.05 -111.5287 50.74073 ## 5   83.5  70.60    77.05 -111.5493 50.73701 ## 6   83.5  70.60    77.05 -111.5289 50.73730 spDTT = calcFossilDivTT(dinos_fossil, tax.lvl = \"species\") genusDTT = calcFossilDivTT(dinos_fossil, tax.lvl = \"genus\") famDTT = calcFossilDivTT(dinos_fossil, tax.lvl = \"family\")  # And to allow comparisons, we will use relative richness: plot(x=genusDTT$age, xlim = rev(range(genusDTT$age)),      y=log(genusDTT$div)-log(max(genusDTT$div)),       xlab=\"Time (Million years ago)\",      ylab=\"Log relative diversity\",      type=\"l\", col=\"blue\", ylim=c(-7,0))  lines(x=famDTT$age,      y=log(famDTT$div)-log(max(famDTT$div)),       col=\"red\")  lines(x=spDTT$age,      y=log(spDTT$div)-log(max(spDTT$div)),       col=\"black\") # Family-level: plotRawFossilOccs(dinos_fossil, tax.lvl = \"family\", knitr = TRUE) # Genus level: plotRawFossilOccs(dinos_fossil, tax.lvl = \"genus\", knitr = TRUE) # Species level: plotRawFossilOccs(dinos_fossil, tax.lvl = \"species\", knitr = TRUE) colnames(dinos_fossil) ##  [1] \"phylum\"         \"class\"          \"order\"          \"family\"         ##  [5] \"genus\"          \"species\"        \"early_interval\" \"late_interval\"  ##  [9] \"max_ma\"         \"min_ma\"         \"midpoint\"       \"lng\"            ## [13] \"lat\" data(\"birds_spp\") sum_w_fossil = sum(birds_spp %in% dinos_fossil$species)  sum_w_fossil / length(birds_spp) ## [1] 0.1139798 data(\"timeseries_fossil\") head(timeseries_fossil) ##   clade    source stem_age rel_time time_ma richness ## 1  anth Alroy2010      617  617.000   0.000     7138 ## 2  anth Alroy2010      617  609.754   7.246     7246 ## 3  anth Alroy2010      617  601.030  15.970    12673 ## 4  anth Alroy2010      617  593.970  23.030     8485 ## 5  anth Alroy2010      617  583.100  33.900    14475 ## 6  anth Alroy2010      617  575.800  41.200     9280 clades = unique(timeseries_fossil$clade)[1:4]  cols= c(\"#ffd353\", \"#ef8737\", \"#bb292c\", \"#62205f\")  par(mfrow=c(2,2)) for(i in 1:length(clades)){   aux = timeseries_fossil[timeseries_fossil$clade==clades[i], ]   plot(aux$time_ma, log(aux$richness), col=cols[i], lwd=3,        main=clades[i], type=\"l\", frame.plot = F,        xlab=\"Time (Mya)\", ylab=\"Log richness\",        xlim=rev(range(aux$time_ma))) } # Restoring old par() configs: par(oldpar)"},{"path":"https://mjanuario.github.io/evolved/articles/rocks_and_clocks.html","id":"comparing-molecular-patterns","dir":"Articles","previous_headings":"","what":"Comparing molecular patterns","title":"Clocks and Rocks","text":"functions, students can also explore molecular sequences compare species. First load dataset protein sequences cytochrome oxidase 1 gene. gene, often known CO1, mitochondrial gene plays key role cellular respiration (e.g., primary aerobic pathway energy ( ATP ) generation). CO1 contains approximately 513 aminoacids (AA) used previous studies reconstructing phylogenetic trees estimating divergence times taxa assuming molecular clock: can compare two sequences terms AA difference number. instance want compare species snake one species bird, type: calculate proportion differences, type: can also quickly visualize sequences directly handling elements object:  using patterns molecular divergence, well fossil occurrences, can build , specially, date, molecular phylogenies.","code":"data(cytOxidase)  summary(cytOxidase) ##  ## 17 amino acid sequences, each with length 513 head(cytOxidase) ## $cnidaria ## [1] \"-RWIFSTNHKDIGTLYL\" ##  ## $snake ## [1] \"TRWLFSTNHKDIGTLYL\" ##  ## $echinoderm ## [1] \"NRWLFSTNHKDIGTLYL\" ##  ## $mollusk ## [1] \"MRWLFSTNHKDIGTLYI\" ##  ## $alligator ## [1] \"HRWFFSTNHKDIGTLYF\" ##  ## $lamprey ## [1] \"IRWLFSTNHKDIGTLYL\" ##  ## $shark ## [1] \"NRWLFSTNHKDIGTLYL\" ##  ## $bird ## [1] \"NRWLFSTNHKDIGTLYL\" ##  ## $frog ## [1] \"TRWLFSTNHKDIGTLYL\" ##  ## $fish ## [1] \"TRWLFSTNHKDIGTLYL\" ##  ## $platypus ## [1] \"NRWLFSTNHKDIGTLYL\" ##  ## $human ## [1] \"DRWLFSTNHKDIGTLYL\" ##  ## $chimpanzee ## [1] \"DRWLFSTNHKDIGTLYL\" ##  ## $bryozoa ## [1] \"MRWLGSTNHKDIGTLYF\" ##  ## $annelid ## [1] \"MRWLYSTNHKDIGTLYF\" ##  ## $insect ## [1] \"RQWLFSTNHKDIGTLYF\" ##  ## $crustacea ## [1] \"RQWLFSTNHKDIGTLYL\" countSeqDiffs(cytOxidase, \"snake\", \"bird\") ## [1] 123 countSeqDiffs(cytOxidase, \"snake\", \"bird\")/nchar(cytOxidase[\"snake\"]) ##     snake  ## 0.2397661 plotProteinSeq(cytOxidase, c(\"snake\", \"bird\", \"cnidaria\"), knitr = TRUE)"},{"path":"https://mjanuario.github.io/evolved/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Matheus Januario. Author, copyright holder, maintainer. Jennifer Auler. Author. Andressa Viol. Author. Daniel Rabosky. Author.","code":""},{"path":"https://mjanuario.github.io/evolved/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Januario M, Auler J, Viol , Rabosky D (2026). evolved: Open Software Teaching Evolutionary Biology Multiple Scales Virtual Inquiries. R package version 1.0.0, https://github.com/mjanuario/evolved.","code":"@Manual{,   title = {evolved: Open Software for Teaching Evolutionary Biology at Multiple Scales Through Virtual Inquiries},   author = {Matheus Januario and Jennifer Auler and Andressa Viol and Daniel Rabosky},   year = {2026},   note = {R package version 1.0.0},   url = {https://github.com/mjanuario/evolved}, }"},{"path":"https://mjanuario.github.io/evolved/index.html","id":"instructions-on-evolved-r-rstudio-rmarkdown","dir":"","previous_headings":"","what":"evolved","title":"evolved","text":"Matheus Januario, Jenniefer Auler, Andressa Viol, Daniel Rabosky Nov/2024  Installing EvolVEd Vignettes (Tutorials) Community guidelines suggesting changes","code":""},{"path":"https://mjanuario.github.io/evolved/index.html","id":"evolved","dir":"","previous_headings":"","what":"EvolVEd","title":"evolved","text":"evolved (EVOLutionary Virtual EDucation) open-source R package designed graduate advanced undergraduate courses evolutionary biology. emphasizes tools inquiry-based learning, students engage scientific practices actively build knowledge (Pedaste et al., 2015). package includes vignettes (tutorials) facilitate classroom investigations. can accessed online https://mjanuario.github.io/evolved/ However, educators encouraged develop content modules depending class context /learning objectives. evolved‘s core functions oriented towards either (ii) developing student intuition classic models evolutionary biology using simulations, (iiii) analyzing (parameter estimation, hypothesis testing, visualization) datasets associated key questions evolutionary biology.","code":""},{"path":"https://mjanuario.github.io/evolved/index.html","id":"installing-evolved","dir":"","previous_headings":"","what":"Installing EvolVEd","title":"evolved","text":"EvolVEd package available two versions:","code":""},{"path":"https://mjanuario.github.io/evolved/index.html","id":"stable-version","dir":"","previous_headings":"Installing EvolVEd","what":"Stable Version:","title":"evolved","text":"stable version represents “error-proof” version package. may reduced features due CRAN’s constraints (e.g., dataset size). stable version can downloaded directly Comprehensive R Archive Network. simpler way install version run following command R terminal:","code":"install.packages(\"evolved\")"},{"path":"https://mjanuario.github.io/evolved/index.html","id":"development-version","dir":"","previous_headings":"Installing EvolVEd","what":"Development Version:","title":"evolved","text":"development version complete updated version package. may contain datasets, functions, documentation slightly CRAN’s standards. development version hosted GitHub requires devtools package installation. devtools already installed, can install first running code lines :","code":"# Install devtools  install.packages(\"devtools\")  # Then, install the development version of EvolVEd: devtools::install_github(\"mjanuario/evolved\")"},{"path":"https://mjanuario.github.io/evolved/index.html","id":"features-in-the-development-version-that-are-absent-in-the-stable-version","dir":"","previous_headings":"Installing EvolVEd > Development Version:","what":"Features in the development version that are absent in the stable version:","title":"evolved","text":"mammals_spp (Extant species list mammals) ammonoidea_fossil (Fossil occurrences ammonoids mammals_fossil (Fossil occurrences mammals) trilob_fossil (Fossil occurrences trilobites)","code":""},{"path":"https://mjanuario.github.io/evolved/index.html","id":"vignettes-tutorials","dir":"","previous_headings":"","what":"Vignettes (Tutorials)","title":"evolved","text":"view vignettes, run following code: \"vignette_name\" one names . vignette covers following topics, organized basic advanced:","code":"vignette(\"vignette_name\", package = \"evolved\")"},{"path":"https://mjanuario.github.io/evolved/index.html","id":"id_1-if-you-never-used-r-before-name-install_r","dir":"","previous_headings":"Vignettes (Tutorials)","what":"1. If you never used R before… (name: install_r)","title":"evolved","text":"Introduces R guides complete beginners installation. Explains RStudio’s interface recommended configurations. Teaches essential workflow: directories, saving, knitting, sourcing, loading data. Troubleshoots common R/RMarkdown issues new users. Presents RMarkdown basics ’s useful scientific work.","code":""},{"path":"https://mjanuario.github.io/evolved/index.html","id":"id_2-intro-to-r-name-intro_r","dir":"","previous_headings":"Vignettes (Tutorials)","what":"2. Intro to R (name: intro_r)","title":"evolved","text":"Basic R syntax coding (objects, vector calculations, etc.) Plotting annotation functions Overview key object classes used vignettes","code":""},{"path":"https://mjanuario.github.io/evolved/index.html","id":"id_3-introduction-to-population-genetics-name-popgen_intro","dir":"","previous_headings":"Vignettes (Tutorials)","what":"3. Introduction to Population Genetics (name: popgen_intro)","title":"evolved","text":"Simple mathematical notation Probability independent events random number generation Malthusian growth Mendelian genetics Hardy-Weinberg Equilibrium (HWE) single locus Heterozygosity, deleterious alleles, mutation Genetics multiple loci DNA variation","code":""},{"path":"https://mjanuario.github.io/evolved/index.html","id":"id_4-genetic-drift-name-popgen_drift","dir":"","previous_headings":"Vignettes (Tutorials)","what":"4. Genetic Drift (name: popgen_drift)","title":"evolved","text":"Intuition qualitative expectations genetic drift Variability outcomes heterozygosity decay Effective population size historical context","code":""},{"path":"https://mjanuario.github.io/evolved/index.html","id":"id_5-selection-in-population-genetics-name-popgen_selection","dir":"","previous_headings":"Vignettes (Tutorials)","what":"5. Selection in Population Genetics (name: popgen_selection)","title":"evolved","text":"Breeding effective population size Mutation-drift equilibrium selection Case studies (e.g., peppered moths)","code":""},{"path":"https://mjanuario.github.io/evolved/index.html","id":"id_6-deep-time-molecular-clocks-name-deeptime_clocks","dir":"","previous_headings":"Vignettes (Tutorials)","what":"6. Deep-Time Molecular Clocks (name: deeptime_clocks)","title":"evolved","text":"Sequence data genetic distance Poisson correction Jukes-Cantor models Molecular clocks uncertainty Inferences deep time","code":""},{"path":"https://mjanuario.github.io/evolved/index.html","id":"id_7-fossils-and-deep-time-patterns-name-deeptime_rocks","dir":"","previous_headings":"Vignettes (Tutorials)","what":"7. Fossils and Deep-Time Patterns (name: deeptime_rocks)","title":"evolved","text":"Exploring fossil occurrences diversity patterns Spatial distribution conclusions fossil records Dating fossils absolute time (technical notes)","code":""},{"path":"https://mjanuario.github.io/evolved/index.html","id":"id_8-birth-death-models-in-deep-time-name-birthdeath_deeptime","dir":"","previous_headings":"Vignettes (Tutorials)","what":"8. Birth-Death Models in Deep Time (name: birthdeath_deeptime)","title":"evolved","text":"Deterministic expectations stochastic processes Effects variation diversification rates Age-richness models extinction dynamics","code":""},{"path":"https://mjanuario.github.io/evolved/index.html","id":"id_9-phylogenies-and-birth-death-models-name-birthdeath_phylogenies","dir":"","previous_headings":"Vignettes (Tutorials)","what":"9. Phylogenies and Birth-Death Models (name: birthdeath_phylogenies)","title":"evolved","text":"Estimating diversification rates pure birth birth-death models Factors influencing speciation extinction","code":""},{"path":"https://mjanuario.github.io/evolved/index.html","id":"community-guidelines-and-suggesting-changes","dir":"","previous_headings":"","what":"Community guidelines and suggesting changes","title":"evolved","text":"Questions support requests sent Matheus Januario’s email (januarioml.eco [] gmail.com). Bug & issue reports, suggestions, improvements, code additions pushed GitHub repository. Emailing Matheus Januario also ok. Additional info can found .","code":""},{"path":"https://mjanuario.github.io/evolved/reference/NatSelSim.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulating natural selection through time in a bi-allelic gene — NatSelSim","title":"Simulating natural selection through time in a bi-allelic gene — NatSelSim","text":"NatSelSim simulates natural selection bi-allelic gene n.gen generations.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/NatSelSim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulating natural selection through time in a bi-allelic gene — NatSelSim","text":"","code":"NatSelSim(   w11 = 1,   w12 = 1,   w22 = 0.9,   p0 = 0.5,   n.gen = 10,   plot.type = \"animateall\",   print.data = FALSE,   knitr = FALSE )"},{"path":"https://mjanuario.github.io/evolved/reference/NatSelSim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulating natural selection through time in a bi-allelic gene — NatSelSim","text":"w11 Number giving fitness genotype A1A1. Values normalized genotype fitness exceeds one. w12 Number giving fitness genotype A1A2. Values normalized genotype fitness exceeds one. w22 Number giving fitness genotype A2A2. Values normalized genotype fitness exceeds one. p0 Initial (time = 0) allelic frequency A1. A2's initial allelic frequency 1-p0. n.gen Number generation simulated. plot.type String indicating plot animated. default, \"animateall\" animate possible panels. options \"static\" (animation), \"animate1\", \"animate3\", \"animate4\". Users can animate panel individually (using plot.type = \"animateX\", X panel one wants animate (options  \"animate1\",  \"animate3\",  \"animate4\" (see return info). print.data Logical indicating whether simulation results returned data.frame. Default value FALSE. knitr Logical indicating plot intended show RMarkdown files made Knitr R package.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/NatSelSim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulating natural selection through time in a bi-allelic gene — NatSelSim","text":"print.data = TRUE, returns data.frame containing number individuals genotype time. plots done function shows (1) Allele frequency change time. (2) adaptive landscape (remains static whole simulation, animated), (3) Time series mean population fitness, (4) Time series genotypic population frequencies.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/NatSelSim.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Simulating natural selection through time in a bi-allelic gene — NatSelSim","text":"value fitness (.e., w11, w12, w22) larger one, fitness interpreted absolute fitness values re-normalized.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/NatSelSim.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Simulating natural selection through time in a bi-allelic gene — NatSelSim","text":"Fisher, R. . (1930). Fundamental Theorem Natural Selection. : genetical theory natural selection. Clarendon Press Plutynski, . (2006). Fisher’s fundamental theorem natural selection ?. Studies History Philosophy Science Part C: Studies History Philosophy Biological Biomedical Sciences, 37(1), 59-82.","code":""},{"path":[]},{"path":"https://mjanuario.github.io/evolved/reference/NatSelSim.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Simulating natural selection through time in a bi-allelic gene — NatSelSim","text":"Matheus Januario, Jennifer Auler, Dan Rabosky","code":""},{"path":"https://mjanuario.github.io/evolved/reference/NatSelSim.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulating natural selection through time in a bi-allelic gene — NatSelSim","text":"","code":"#using the default values (w11=1, w12=1, w22=0.9, p0=0.5, n.gen=10) NatSelSim()  # Continuing a simulation for extra time: # Run the first simulation sim1=NatSelSim(w11 = .4, w12 = .5, w22 = .4, p0 = 0.35,  n.gen = 5, plot.type = \"static\", print.data = TRUE, knitr = TRUE)  # Then take the allelic frequency form the first sim: new_p0 <- (sim1$AA[nrow(sim1)] + sim1$Aa[nrow(sim1)]*1/2)  # and use as p0 for a second one:  NatSelSim(w11 = .4, w12 = .5, w22 = .4, p0 = new_p0, n.gen = 5, plot.type = \"static\", knitr = TRUE)"},{"path":"https://mjanuario.github.io/evolved/reference/OneGenHWSim.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulating one generation of genotypes under Hardy-Weinberg equilibrium — OneGenHWSim","title":"Simulating one generation of genotypes under Hardy-Weinberg equilibrium — OneGenHWSim","text":"OneGenHWSim creates n.sim simulations one generation genotypes Hardy-Weinberg equilibrium bi-allelic loci.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/OneGenHWSim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulating one generation of genotypes under Hardy-Weinberg equilibrium — OneGenHWSim","text":"","code":"OneGenHWSim(n.ind = 50, p = 0.5, n.sim = 100)"},{"path":"https://mjanuario.github.io/evolved/reference/OneGenHWSim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulating one generation of genotypes under Hardy-Weinberg equilibrium — OneGenHWSim","text":"n.ind Integer indicating census size simulated populations. decimals inserted, rounded. p Numerical zero one indicates A1's allele frequency. A2's allele frequency assumed 1-p. n.sim Number simulations made. decimals inserted, rounded.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/OneGenHWSim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulating one generation of genotypes under Hardy-Weinberg equilibrium — OneGenHWSim","text":"data.frame containing number individuals genotype.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/OneGenHWSim.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Simulating one generation of genotypes under Hardy-Weinberg equilibrium — OneGenHWSim","text":"Hardy, G. H. (1908). Mendelian proportions mixed population. Science, 28, 49–50. Weinberg, W. (1908). Uber den Nachweis der Vererbung beim Menschen. Jahreshefte des Vereins fur vaterlandische Naturkunde Wurttemberg, Stuttgart 64:369–382. [demonstration inheritance humans]. Translation R. . Jameson printed D. L. Jameson (Ed.), (1977). Benchmark papers genetics, Volume 8: Evolutionary genetics (pp. 115–125). Stroudsburg, PA: Dowden, Hutchinson & Ross. Mayo, O. (2008). century Hardy–Weinberg equilibrium. Twin Research Human Genetics, 11(3), 249-256.","code":""},{"path":[]},{"path":"https://mjanuario.github.io/evolved/reference/OneGenHWSim.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Simulating one generation of genotypes under Hardy-Weinberg equilibrium — OneGenHWSim","text":"Matheus Januario, Dan Rabosky, Jennifer Auler","code":""},{"path":"https://mjanuario.github.io/evolved/reference/OneGenHWSim.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulating one generation of genotypes under Hardy-Weinberg equilibrium — OneGenHWSim","text":"","code":"#using the default values (n.ind = 50, p = 0.5, n.sim = 100): OneGenHWSim() #>         A1A1 A1A2 A2A2 #> sim_1     13   24   13 #> sim_2     13   24   13 #> sim_3     10   30   10 #> sim_4     12   26   12 #> sim_5     12   26   12 #> sim_6     13   24   13 #> sim_7     14   22   14 #> sim_8     13   24   13 #> sim_9     12   26   12 #> sim_10     9   32    9 #> sim_11    13   24   13 #> sim_12    14   22   14 #> sim_13    11   28   11 #> sim_14    15   20   15 #> sim_15    10   30   10 #> sim_16    10   30   10 #> sim_17    13   24   13 #> sim_18    14   22   14 #> sim_19    12   26   12 #> sim_20     9   32    9 #> sim_21     9   32    9 #> sim_22    12   26   12 #> sim_23    10   30   10 #> sim_24    10   30   10 #> sim_25    12   26   12 #> sim_26    11   28   11 #> sim_27    12   26   12 #> sim_28    10   30   10 #> sim_29    11   28   11 #> sim_30    13   24   13 #> sim_31    11   28   11 #> sim_32    14   22   14 #> sim_33    13   24   13 #> sim_34     9   32    9 #> sim_35    13   24   13 #> sim_36    13   24   13 #> sim_37    10   30   10 #> sim_38    14   22   14 #> sim_39    11   28   11 #> sim_40    12   26   12 #> sim_41    13   24   13 #> sim_42    14   22   14 #> sim_43    11   28   11 #> sim_44    11   28   11 #> sim_45    15   20   15 #> sim_46    14   22   14 #> sim_47    15   20   15 #> sim_48    13   24   13 #> sim_49    14   22   14 #> sim_50    10   30   10 #> sim_51    13   24   13 #> sim_52    14   22   14 #> sim_53    10   30   10 #> sim_54    13   24   13 #> sim_55    13   24   13 #> sim_56    10   30   10 #> sim_57    13   24   13 #> sim_58     9   32    9 #> sim_59    15   20   15 #> sim_60    12   26   12 #> sim_61     8   34    8 #> sim_62    17   16   17 #> sim_63    14   22   14 #> sim_64    12   26   12 #> sim_65    15   20   15 #> sim_66    15   20   15 #> sim_67    12   26   12 #> sim_68    12   26   12 #> sim_69    11   28   11 #> sim_70    12   26   12 #> sim_71    13   24   13 #> sim_72     9   32    9 #> sim_73    12   26   12 #> sim_74    12   26   12 #> sim_75    11   28   11 #> sim_76    12   26   12 #> sim_77    11   28   11 #> sim_78    12   26   12 #> sim_79    11   28   11 #> sim_80    13   24   13 #> sim_81    14   22   14 #> sim_82    15   20   15 #> sim_83    14   22   14 #> sim_84    10   30   10 #> sim_85    14   22   14 #> sim_86    13   24   13 #> sim_87     6   38    6 #> sim_88    14   22   14 #> sim_89    16   18   16 #> sim_90    12   26   12 #> sim_91    12   26   12 #> sim_92    11   28   11 #> sim_93     9   32    9 #> sim_94    14   22   14 #> sim_95    14   22   14 #> sim_96    10   30   10 #> sim_97    13   24   13 #> sim_98    12   26   12 #> sim_99    14   22   14 #> sim_100   11   28   11  #Simulating with a already fixed allele: OneGenHWSim(n.ind = 50, p = 1) #>         A1A1 <NA> <NA> #> sim_1     50    0    0 #> sim_2     50    0    0 #> sim_3     50    0    0 #> sim_4     50    0    0 #> sim_5     50    0    0 #> sim_6     50    0    0 #> sim_7     50    0    0 #> sim_8     50    0    0 #> sim_9     50    0    0 #> sim_10    50    0    0 #> sim_11    50    0    0 #> sim_12    50    0    0 #> sim_13    50    0    0 #> sim_14    50    0    0 #> sim_15    50    0    0 #> sim_16    50    0    0 #> sim_17    50    0    0 #> sim_18    50    0    0 #> sim_19    50    0    0 #> sim_20    50    0    0 #> sim_21    50    0    0 #> sim_22    50    0    0 #> sim_23    50    0    0 #> sim_24    50    0    0 #> sim_25    50    0    0 #> sim_26    50    0    0 #> sim_27    50    0    0 #> sim_28    50    0    0 #> sim_29    50    0    0 #> sim_30    50    0    0 #> sim_31    50    0    0 #> sim_32    50    0    0 #> sim_33    50    0    0 #> sim_34    50    0    0 #> sim_35    50    0    0 #> sim_36    50    0    0 #> sim_37    50    0    0 #> sim_38    50    0    0 #> sim_39    50    0    0 #> sim_40    50    0    0 #> sim_41    50    0    0 #> sim_42    50    0    0 #> sim_43    50    0    0 #> sim_44    50    0    0 #> sim_45    50    0    0 #> sim_46    50    0    0 #> sim_47    50    0    0 #> sim_48    50    0    0 #> sim_49    50    0    0 #> sim_50    50    0    0 #> sim_51    50    0    0 #> sim_52    50    0    0 #> sim_53    50    0    0 #> sim_54    50    0    0 #> sim_55    50    0    0 #> sim_56    50    0    0 #> sim_57    50    0    0 #> sim_58    50    0    0 #> sim_59    50    0    0 #> sim_60    50    0    0 #> sim_61    50    0    0 #> sim_62    50    0    0 #> sim_63    50    0    0 #> sim_64    50    0    0 #> sim_65    50    0    0 #> sim_66    50    0    0 #> sim_67    50    0    0 #> sim_68    50    0    0 #> sim_69    50    0    0 #> sim_70    50    0    0 #> sim_71    50    0    0 #> sim_72    50    0    0 #> sim_73    50    0    0 #> sim_74    50    0    0 #> sim_75    50    0    0 #> sim_76    50    0    0 #> sim_77    50    0    0 #> sim_78    50    0    0 #> sim_79    50    0    0 #> sim_80    50    0    0 #> sim_81    50    0    0 #> sim_82    50    0    0 #> sim_83    50    0    0 #> sim_84    50    0    0 #> sim_85    50    0    0 #> sim_86    50    0    0 #> sim_87    50    0    0 #> sim_88    50    0    0 #> sim_89    50    0    0 #> sim_90    50    0    0 #> sim_91    50    0    0 #> sim_92    50    0    0 #> sim_93    50    0    0 #> sim_94    50    0    0 #> sim_95    50    0    0 #> sim_96    50    0    0 #> sim_97    50    0    0 #> sim_98    50    0    0 #> sim_99    50    0    0 #> sim_100   50    0    0  # Testing if the simulation works: A1freq <- .789 #any value could work n.simul <- 100 simulations <- OneGenHWSim(n.ind = n.simul, n.sim = n.simul, p = A1freq)  #expected: c(A1freq^2, 2*A1freq*(1-A1freq), (1-A1freq)^2) #> [1] 0.622521 0.332958 0.044521  #simulated: apply(X = simulations, MARGIN = 2, FUN = function(x){mean(x)/n.simul}) #>   A1A1   A1A2   A2A2  #> 0.6212 0.3350 0.0438"},{"path":"https://mjanuario.github.io/evolved/reference/ProteinSeq.html","id":null,"dir":"Reference","previous_headings":"","what":"Details, generics, and methods for the ProteinSeq class — ProteinSeq","title":"Details, generics, and methods for the ProteinSeq class — ProteinSeq","text":"ProteinSeq class input functions countSeqDiffs .ProteinSeq. consists character vector. entry vector represents aminoacid (protein components coded gene) sequence, given aligned protein sequence. object must character, named vector, names typically corresponding species (name scientific common name) every sequence came. characters within vector must correspond valid aminoacid symbols (.e. capitalized letters deletion \"_\" symbols). Particularly, following symbols relate amino acids: \"\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"\", \"K\", \"L\", \"M\", \"N\", \"P\", \"Q\", \"R\", \"S\", \"T\", \"V\", \"W\", \"Y\". Importantly, symbol \"_\" means indel (insertion deletion), symbols \"X\", \"B\", \"Z\", \"J\" considered ambiguous site readings.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/ProteinSeq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Details, generics, and methods for the ProteinSeq class — ProteinSeq","text":"","code":"is.ProteinSeq(x)  # S3 method for class 'ProteinSeq' print(x, ...)  # S3 method for class 'ProteinSeq' summary(object, ...)  # S3 method for class 'ProteinSeq' head(x, n = 20, ...)  # S3 method for class 'ProteinSeq' tail(x, n = 20, ...)"},{"path":"https://mjanuario.github.io/evolved/reference/ProteinSeq.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Details, generics, and methods for the ProteinSeq class — ProteinSeq","text":"x object class ProteinSeq ... arguments passed methods. #' @return Shows last n elements ProteinSeq object. object object class ProteinSeq n number aminoacids shown","code":""},{"path":"https://mjanuario.github.io/evolved/reference/ProteinSeq.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Details, generics, and methods for the ProteinSeq class — ProteinSeq","text":"logical indicating object x class ProteinSeq print.ProteinSeq Prints brief summary print.ProteinSeq containing number sequences length alignment. See details format ??ProteinSeq. print.ProteinSeq. Shows first n elements ProteinSeq object.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/ProteinSeq.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Details, generics, and methods for the ProteinSeq class — ProteinSeq","text":".ProteinSeq ProteinSeq must list containing multiple vectors made characters (usually letters code Amino Acids, deletions, etc). must correct length (.e. others) relative positions match (.e., object must contain alligned Amino acide sequences).","code":""},{"path":"https://mjanuario.github.io/evolved/reference/ProteinSeq.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Details, generics, and methods for the ProteinSeq class — ProteinSeq","text":"Daniel Rabosky, Matheus Januario, Jennifer Auler","code":""},{"path":"https://mjanuario.github.io/evolved/reference/WFDriftSim.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulating generations of genetic drift in a Wright–Fisher (WF) population — WFDriftSim","title":"Simulating generations of genetic drift in a Wright–Fisher (WF) population — WFDriftSim","text":"WFDriftSim simulates genetic drift diploid Wright–Fisher populations given effective population size certain number generations.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/WFDriftSim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulating generations of genetic drift in a Wright–Fisher (WF) population — WFDriftSim","text":"","code":"WFDriftSim(   Ne,   n.gen,   p0 = 0.5,   n.sim = 1,   plot.type = \"animate\",   print.data = FALSE,   knitr = FALSE )"},{"path":"https://mjanuario.github.io/evolved/reference/WFDriftSim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulating generations of genetic drift in a Wright–Fisher (WF) population — WFDriftSim","text":"Ne Number giving effective population size population n.gen Number generations simulated. p0 Initial frequency given allele. simulated organism diploid, alleles frequency 1-(p0). Default value 0.5. n.sim Number simulations made. decimals inserted, rounded. Default value 1. plot.type Character indicating simulations plotted colored lines. color represents different population. plot.type = \"animate\" (default value) animates generation individually. plot.type = \"static\" plots lines rapidly. plot.type = \"none\" nothing plotted. print.data Logical indicating whether simulation results returned data.frame. Default value FALSE. knitr Logical indicating plot intended show RMarkdown files made Knitr R package.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/WFDriftSim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulating generations of genetic drift in a Wright–Fisher (WF) population — WFDriftSim","text":"plot.type = \"static\" \"animate\", plots timeseries simulations, line+color referring different simulation. Note many simulations (generally 20) simulated, colors might cycled different simulation color. print.data = TRUE, returns data.frame simulation results.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/WFDriftSim.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Simulating generations of genetic drift in a Wright–Fisher (WF) population — WFDriftSim","text":"effective population size (Ne) strongly connected rate genetic drift (details, see Waples, 2022).","code":""},{"path":"https://mjanuario.github.io/evolved/reference/WFDriftSim.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Simulating generations of genetic drift in a Wright–Fisher (WF) population — WFDriftSim","text":"Fisher RA (1922) dominance ratio. Proc. R. Soc. Edinb 42:321–341 Kimura M (1955) Solution process random genetic drift continuous model. PNAS–USA 41(3):144–150 Tran, T. D., Hofrichter, J., & Jost, J. (2013). introduction mathematical structure Wright–Fisher model population genetics. Theory Biosciences, 132(2), 73-82. [good historical review, math can challenging] Waples, R. S. (2022). Ne, anyway?. Journal Heredity. Wright S (1931) Evolution Mendelian populations. Genetics 16:97–159","code":""},{"path":[]},{"path":"https://mjanuario.github.io/evolved/reference/WFDriftSim.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Simulating generations of genetic drift in a Wright–Fisher (WF) population — WFDriftSim","text":"Matheus Januario, Dan Rabosky, Jennifer Auler","code":""},{"path":"https://mjanuario.github.io/evolved/reference/WFDriftSim.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulating generations of genetic drift in a Wright–Fisher (WF) population — WFDriftSim","text":"","code":"# \\donttest{ #Default values: WFDriftSim(Ne = 5, n.gen = 10, knitr = TRUE)   #A population which has already fixed one of the alleles: WFDriftSim(Ne = 5, n.gen = 10, p0=1, knitr = TRUE)   #Many populations:: WFDriftSim(Ne = 5, n.gen = 10, p0=0.2, n.sim=10, knitr = TRUE)   ######## continuing a previous simulation: n.gen_1stsim <- 10 # number of gens in the 1st sim: sim1 <- WFDriftSim(Ne = 5, n.gen = n.gen_1stsim, p0=.2, n.sim=10,  plot.type = \"none\", print.data = TRUE, knitr = TRUE) n.gen_2ndsim <-7 # number of gens in the 2nd sim: # now, note how we assigned p0: sim2 <- WFDriftSim(Ne = 5, n.gen = n.gen_2ndsim, p0=sim1[,ncol(sim1)],  plot.type = \"static\", n.sim=10, print.data = TRUE, knitr = TRUE)   # if we want to merge both simulations, then we have to: # remove first column of 2nd sim (because it repeats # the last column of the 1st sim) sim2 <- sim2[,-1]  # re-name 2nd sim columns: colnames(sim2) <- paste0(\"gen\", (n.gen_1stsim+1):(n.gen_1stsim+n.gen_2ndsim))  #finally, merging both rounds of simulations: all_sims <- cbind(sim1, sim2) head(all_sims) #>      gen0 gen1 gen2 gen3 gen4 gen5 gen6 gen7 gen8 gen9 gen10 gen11 gen12 gen13 #> sim1  0.2  0.4  0.3  0.4  0.2  0.2  0.4  0.4  0.2  0.1   0.3   0.4   0.5   0.5 #> sim2  0.2  0.2  0.2  0.3  0.3  0.5  0.4  0.6  0.5  0.2   0.2   0.2   0.2   0.1 #> sim3  0.2  0.2  0.2  0.1  0.1  0.1  0.1  0.0  0.0  0.0   0.0   0.0   0.0   0.0 #> sim4  0.2  0.2  0.3  0.3  0.1  0.1  0.1  0.1  0.1  0.1   0.1   0.1   0.2   0.1 #> sim5  0.2  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0   0.0   0.0   0.0 #> sim6  0.2  0.1  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0   0.0   0.0   0.0 #>      gen14 gen15 gen16 gen17 #> sim1   0.6   0.5   0.5   0.4 #> sim2   0.1   0.1   0.1   0.0 #> sim3   0.0   0.0   0.0   0.0 #> sim4   0.1   0.1   0.1   0.1 #> sim5   0.0   0.0   0.0   0.0 #> sim6   0.0   0.0   0.0   0.0 # }"},{"path":"https://mjanuario.github.io/evolved/reference/ammonoidea_fossil.html","id":null,"dir":"Reference","previous_headings":"","what":"Occurrences of ammonoid fossils — ammonoidea_fossil","title":"Occurrences of ammonoid fossils — ammonoidea_fossil","text":"Many ammonoid (Cephalopoda, Mollusca) fossil occurrences different moments geological past. Much information (.e., extra columns) removed original dataset make compact, can fully accessed data URL. dataset part package licensed Creative Commons Attribution 4.0 International License (CC 4.0).","code":""},{"path":"https://mjanuario.github.io/evolved/reference/ammonoidea_fossil.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Occurrences of ammonoid fossils — ammonoidea_fossil","text":"","code":"ammonoidea_fossil"},{"path":"https://mjanuario.github.io/evolved/reference/ammonoidea_fossil.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Occurrences of ammonoid fossils — ammonoidea_fossil","text":"data.frame 58111 rows 13 columns. phylum Organism phylum class Organism taxonomic class order Organism taxonomic order family Organism taxonomic family genus Organism genus species Organism specific name early_interval Earlier known geological period occurrence late_interval Later known geological period occurrence max_ma Occurrence's oldest time boundary million years min_ma Occurrence's newest time boundary million years midpoint Midpoint max_ma min_ma lng Longitude place occurrence found. Follows decimal degree format. lat Latitude place occurrence found. Follows decimal degree format.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/ammonoidea_fossil.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Occurrences of ammonoid fossils — ammonoidea_fossil","text":"Paleobiology Database (downloaded 2022-03-11).  Data URL: http://paleobiodb.org/data1.2/occs/list.csv?datainfo&rowcount&base_name=Ammonoidea&show=full,classext,genus,subgenus,acconly,ident,img,etbasis,strat,lith,env,timebins,timecompare,resgroup,ref,ent,entname,crmod","code":""},{"path":"https://mjanuario.github.io/evolved/reference/birds_spp.html","id":null,"dir":"Reference","previous_headings":"","what":"Birds species list — birds_spp","title":"Birds species list — birds_spp","text":"Birds species list","code":""},{"path":"https://mjanuario.github.io/evolved/reference/birds_spp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Birds species list — birds_spp","text":"","code":"birds_spp"},{"path":"https://mjanuario.github.io/evolved/reference/birds_spp.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Birds species list — birds_spp","text":"vector containing names almost (.e., 9993) extant bird species, following Jetz et al. (2012) taxonomy. dataset part package licensed Creative Commons Attribution 4.0 International License (CC 4.0).","code":""},{"path":"https://mjanuario.github.io/evolved/reference/birds_spp.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Birds species list — birds_spp","text":"Actual file downloaded https://vertlife.org/data/","code":""},{"path":"https://mjanuario.github.io/evolved/reference/birds_spp.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Birds species list — birds_spp","text":"Jetz, W., Thomas, G. H., Joy, J. B., Hartmann, K., & Mooers, . O. (2012). global diversity birds space time. Nature, 491(7424), 444-448.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/calcFossilDivTT.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate paleo diversity curves through different methods — calcFossilDivTT","title":"Calculate paleo diversity curves through different methods — calcFossilDivTT","text":"calcFossilDivTT calculates fossil diversity time using different methods.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/calcFossilDivTT.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate paleo diversity curves through different methods — calcFossilDivTT","text":"","code":"calcFossilDivTT(   data,   tax.lvl = \"species\",   method = \"rangethrough\",   bin.reso = 1 )"},{"path":"https://mjanuario.github.io/evolved/reference/calcFossilDivTT.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate paleo diversity curves through different methods — calcFossilDivTT","text":"data data.frame containing columns: max_ma, min_ma  name provided tax.lvl. max_ma min_ma respectively early late bounds rock layer's age. tax.lvl column taxonomic level data. additional columns ignored. tax.lvl character giving taxonomic calculations based (default value \"species\"). must refer column names data. method character string setting method used. either \"rangethrough\" \"stdmethod\", respectively calculate diversity using range standard methods (Foote & Miller, 2007) bin.reso numeric assigning resolution (length) time bin consider calculations. Default value 1 (cases - e.g. following Paleobiology Database default timescale - equate one million years)","code":""},{"path":"https://mjanuario.github.io/evolved/reference/calcFossilDivTT.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate paleo diversity curves through different methods — calcFossilDivTT","text":"data.frame containing diversity (column div) chosen taxonomic level time, calculation based method. \"method = rangethrough\", time moments layer boundaries given data. \"method = stdmethod\", time moments evenly-space bins  length equal bin.reso, starting earliest bound dataset.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/calcFossilDivTT.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Calculate paleo diversity curves through different methods — calcFossilDivTT","text":"Foote, M., Miller, . ., Raup, D. M., & Stanley, S. M. (2007). Principles paleontology. Macmillan.","code":""},{"path":[]},{"path":"https://mjanuario.github.io/evolved/reference/calcFossilDivTT.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Calculate paleo diversity curves through different methods — calcFossilDivTT","text":"Matheus Januario, Jennifer Auler","code":""},{"path":"https://mjanuario.github.io/evolved/reference/calcFossilDivTT.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate paleo diversity curves through different methods — calcFossilDivTT","text":"","code":"# Loading data data(\"dinos_fossil\")  # Using function: div1 <- calcFossilDivTT(dinos_fossil, method = \"stdmethod\") div2 <- calcFossilDivTT(dinos_fossil, method = \"stdmethod\", bin.reso = 10)  # Comparing different bins sizes in the standard method plot(x=div1$age, y=div1$div, type=\"l\",       xlab = \"Time (Mya)\", ylab = \"Richness\",       xlim=rev(range(div1$age)), col=\"red\")  lines(x=div2$age, y=div2$div, col=\"blue\")   # Comparing different methods: div3 <- calcFossilDivTT(dinos_fossil, method = \"rangethrough\") plot(x=div1$age, y=div1$div, type=\"l\",       xlab = \"Time (Mya)\", ylab = \"Richness\",       xlim=rev(range(div1$age)), col=\"red\")  lines(x=div3$age, y=div3$div, col=\"blue\")"},{"path":"https://mjanuario.github.io/evolved/reference/checkAndFixUltrametric.html","id":null,"dir":"Reference","previous_headings":"","what":"Find and fix small rounding errors in ultrametric trees — checkAndFixUltrametric","title":"Find and fix small rounding errors in ultrametric trees — checkAndFixUltrametric","text":"checkAndFixUltrametric finds correct small numerical errors might appear ultrametric trees created simulations. function never used formal statistical method make tree ultrametric, designed just correct small rounding errors.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/checkAndFixUltrametric.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find and fix small rounding errors in ultrametric trees — checkAndFixUltrametric","text":"","code":"checkAndFixUltrametric(phy)"},{"path":"https://mjanuario.github.io/evolved/reference/checkAndFixUltrametric.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find and fix small rounding errors in ultrametric trees — checkAndFixUltrametric","text":"phy phylo object, following terminology package ape function operate.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/checkAndFixUltrametric.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find and fix small rounding errors in ultrametric trees — checkAndFixUltrametric","text":"check fixed phylo object.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/checkAndFixUltrametric.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Find and fix small rounding errors in ultrametric trees — checkAndFixUltrametric","text":"Paradis, E. (2012). Analysis Phylogenetics Evolution R (Vol. 2). New York: Springer. Popescu, . ., Huber, K. T., & Paradis, E. (2012). ape 3.0: New tools distance-based phylogenetics evolutionary analysis R. Bioinformatics, 28(11), 1536-1537.","code":""},{"path":[]},{"path":"https://mjanuario.github.io/evolved/reference/checkAndFixUltrametric.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Find and fix small rounding errors in ultrametric trees — checkAndFixUltrametric","text":"Daniel Rabosky, Matheus Januario, Jennifer Auler","code":""},{"path":"https://mjanuario.github.io/evolved/reference/checkAndFixUltrametric.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find and fix small rounding errors in ultrametric trees — checkAndFixUltrametric","text":"","code":"S <- 1 E <- 0 set.seed(1) phy <- simulateTree(pars = c(S, E), max.taxa = 6, max.t = 5) phy$edge.length[1] <- phy$edge.length[1]+0.1 ape::is.ultrametric(phy) #> [1] FALSE phy <- checkAndFixUltrametric(phy) ape::is.ultrametric(phy) #> [1] TRUE"},{"path":"https://mjanuario.github.io/evolved/reference/countSeqDiffs.html","id":null,"dir":"Reference","previous_headings":"","what":"Counting protein sequence differences — countSeqDiffs","title":"Counting protein sequence differences — countSeqDiffs","text":"countSeqDiffs counts number protein differences among two sequences proteins within \"ProteinSeq\" object.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/countSeqDiffs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Counting protein sequence differences — countSeqDiffs","text":"","code":"countSeqDiffs(x, taxon1, taxon2)"},{"path":"https://mjanuario.github.io/evolved/reference/countSeqDiffs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Counting protein sequence differences — countSeqDiffs","text":"x \"ProteinSeq\" object containing proteins taxon1 taxon2. taxon1 character giving common name first species compared. Must name present x. taxon2 character giving common name second species compared. Must name present x.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/countSeqDiffs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Counting protein sequence differences — countSeqDiffs","text":"integer giving number protein differences taxon1 taxon2.","code":""},{"path":[]},{"path":"https://mjanuario.github.io/evolved/reference/countSeqDiffs.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Counting protein sequence differences — countSeqDiffs","text":"Matheus Januario, Dan Rabosky, Jennifer Auler","code":""},{"path":"https://mjanuario.github.io/evolved/reference/countSeqDiffs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Counting protein sequence differences — countSeqDiffs","text":"","code":"countSeqDiffs(cytOxidase, \"human\", \"chimpanzee\") #> [1] 4  countSeqDiffs(cytOxidase, \"human\", \"cnidaria\") #> [1] 161  countSeqDiffs(cytOxidase, \"chimpanzee\", \"cnidaria\") #> [1] 162"},{"path":"https://mjanuario.github.io/evolved/reference/cytOxidase.html","id":null,"dir":"Reference","previous_headings":"","what":"Cytochrome Oxidase sequences — cytOxidase","title":"Cytochrome Oxidase sequences — cytOxidase","text":"cytOxidase set homologous protein sequences GENE cytochrome oxidase SUBUNIT 1 gene. mitochondrial gene, often known CO1 (“see-oh-one”),  plays key role cellular respiration. C01 contains approximately 513 aminoacids used previous studies reconstructing phylogenetic trees estimating divergence times Metazoaria assuming molecular clock. 5' partition used ‘Barcoding Life’ initiative, instance. dataset part package licensed Creative Commons Attribution 4.0 International License (CC 4.0).","code":""},{"path":"https://mjanuario.github.io/evolved/reference/cytOxidase.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cytochrome Oxidase sequences — cytOxidase","text":"","code":"cytOxidase"},{"path":"https://mjanuario.github.io/evolved/reference/cytOxidase.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Cytochrome Oxidase sequences — cytOxidase","text":" object class \"ProteinSeq\" 17 entries, representing different animal species names Organism's popular name taxonomic classification sequence Aminoacid sequence length 513","code":""},{"path":"https://mjanuario.github.io/evolved/reference/cytOxidase.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Cytochrome Oxidase sequences — cytOxidase","text":"Amino acid sequences originally downloaded genebank later curated aligned Daniel L. Rabosky.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/cytOxidase.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Cytochrome Oxidase sequences — cytOxidase","text":"object class \"ProteinSeq\" structured named vector 17 different animal species, individual component sequence 513 aminoacids.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/data_whales.html","id":null,"dir":"Reference","previous_headings":"","what":"Whale body size and speciation rates — data_whales","title":"Whale body size and speciation rates — data_whales","text":"Data body size many cetacean species species-specific speciation rates. dataset part package licensed Creative Commons Attribution 4.0 International License (CC 4.0).","code":""},{"path":"https://mjanuario.github.io/evolved/reference/data_whales.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Whale body size and speciation rates — data_whales","text":"","code":"data_whales"},{"path":"https://mjanuario.github.io/evolved/reference/data_whales.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Whale body size and speciation rates — data_whales","text":"data.frame 75 rows 4 columns. species Whale species log_mass Log body mass (grams) S Species-specific speciation rate color Suggested color used tip's clade","code":""},{"path":"https://mjanuario.github.io/evolved/reference/data_whales.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Whale body size and speciation rates — data_whales","text":"Compilation many primary sources (see details).","code":""},{"path":"https://mjanuario.github.io/evolved/reference/data_whales.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Whale body size and speciation rates — data_whales","text":"Species follow taxonomy Steeman et al (2009). Species-specific speciation rates Rabosky 2014 & Rabosky et al, 2014. Mass data PanTHERIA (Jones et al, 2009).","code":""},{"path":"https://mjanuario.github.io/evolved/reference/data_whales.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Whale body size and speciation rates — data_whales","text":"Jones, K. E., Bielby, J., Cardillo, M., Fritz, S. ., O'Dell, J., Orme, C. D. L., ... & Purvis, . (2009). PanTHERIA: species‐level database life history, ecology, geography extant recently extinct mammals: Ecological Archives E090‐184. Ecology, 90(9), 2648-2648. Rabosky, D. L. (2014). Automatic detection key innovations, rate shifts, diversity-dependence phylogenetic trees. PLoS one, 9(2), e89543. Rabosky, D. L., Grundler, M., Anderson, C., Title, P., Shi, J. J., Brown, J. W., ... & Larson, J. G. (2014). BAMM tools: R package analysis evolutionary dynamics phylogenetic trees. Methods Ecology Evolution, 5(7), 701-707. Steeman, M. E., Hebsgaard, M. B., Fordyce, R. E., Ho, S. Y., Rabosky, D. L., Nielsen, R., ... & Willerslev, E. (2009). Radiation extant cetaceans driven restructuring oceans. Systematic biology, 58(6), 573-585.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/dinos_fossil.html","id":null,"dir":"Reference","previous_headings":"","what":"Occurrence of dinosaur fossils — dinos_fossil","title":"Occurrence of dinosaur fossils — dinos_fossil","text":"Many dinosaur (including avian species) fossil occurrences different moments geological past. Much information (.e., extra columns) removed original dataset make compact, can fully accessed data URL. dataset part package licensed Creative Commons Attribution 4.0 International License (CC 4.0).","code":""},{"path":"https://mjanuario.github.io/evolved/reference/dinos_fossil.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Occurrence of dinosaur fossils — dinos_fossil","text":"","code":"dinos_fossil"},{"path":"https://mjanuario.github.io/evolved/reference/dinos_fossil.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Occurrence of dinosaur fossils — dinos_fossil","text":"data.frame containing 15527 rows 13 columns phylum Organism phylum class Organism taxonomic class order Organism taxonomic order family Organism taxonomic family genus Organism genus species Organism specific name early_interval Earlier known geological period occurrence late_interval Later known geological period occurrence max_ma Occurrence's oldest time boundary million years min_ma Occurrence's newest time boundary million years midpoint Midpoint max_ma min_ma lng Longitude place occurrence found. Follows decimal degree format. lat Latitude place occurrence found. Follows decimal degree format.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/dinos_fossil.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Occurrence of dinosaur fossils — dinos_fossil","text":"Paleobiology Database (downloaded 2022-03-11).  Data URL: http://paleobiodb.org/data1.2/occs/list.csv?datainfo&rowcount&base_name=Dinosauria&show=full,classext,genus,subgenus,acconly,ident,img,etbasis,strat,lith,env,timebins,timecompare,resgroup,ref,ent,entname,crmod","code":""},{"path":"https://mjanuario.github.io/evolved/reference/estimateSpeciation.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate speciation assuming a pure-birth process — estimateSpeciation","title":"Estimate speciation assuming a pure-birth process — estimateSpeciation","text":"estimateSpeciation Estimates speciation rate assuming constant-rate, pure-birth model.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/estimateSpeciation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate speciation assuming a pure-birth process — estimateSpeciation","text":"","code":"estimateSpeciation(phy)"},{"path":"https://mjanuario.github.io/evolved/reference/estimateSpeciation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate speciation assuming a pure-birth process — estimateSpeciation","text":"phy phylo object, following terminology package ape function operate.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/estimateSpeciation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate speciation assuming a pure-birth process — estimateSpeciation","text":"numeric estimated speciation rate.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/estimateSpeciation.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Estimate speciation assuming a pure-birth process — estimateSpeciation","text":"Yule G.U. 1925. mathematical theory evolution, based conclusions Dr. JC Willis, FRS. Philosophical Transactions Royal Society London. Series B, Containing Papers Biological Character. 213:21–87.","code":""},{"path":[]},{"path":"https://mjanuario.github.io/evolved/reference/estimateSpeciation.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Estimate speciation assuming a pure-birth process — estimateSpeciation","text":"Daniel Rabosky, Matheus Januario, Jennifer Auler","code":""},{"path":"https://mjanuario.github.io/evolved/reference/estimateSpeciation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate speciation assuming a pure-birth process — estimateSpeciation","text":"","code":"S <- 1 E <- 0 set.seed(1) phy <- simulateTree(pars = c(S, E), max.taxa = 6, max.t = 5) estimateSpeciation(phy) #> [1] 1.333389"},{"path":"https://mjanuario.github.io/evolved/reference/fitCRBD.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit a constant-rate birth-death process to a phylogeny — fitCRBD","title":"Fit a constant-rate birth-death process to a phylogeny — fitCRBD","text":"fitCRBD fits constant-rate birth-death process phylogeny format ape package's phylo object. Optimization based likelihood functions made diversitree. function basically wrapper diversitree's make.bd function.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/fitCRBD.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit a constant-rate birth-death process to a phylogeny — fitCRBD","text":"","code":"fitCRBD(phy, n.opt = 5, l.min = 0.001, l.max = 5, max.bad = 200)"},{"path":"https://mjanuario.github.io/evolved/reference/fitCRBD.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit a constant-rate birth-death process to a phylogeny — fitCRBD","text":"phy phylo object, following terminology package ape, function operate. n.opt Number optimizations tried function. l.min Lower bound optimization. Default value 0.001. l.max Upper bound optimization. Default value 5. max.bad Maximum number unsuccessful optimization attempts. Default value 200.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/fitCRBD.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit a constant-rate birth-death process to a phylogeny — fitCRBD","text":"numeric best estimates speciation S extinction E rates.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/fitCRBD.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Fit a constant-rate birth-death process to a phylogeny — fitCRBD","text":"Paradis, E. (2012). Analysis Phylogenetics Evolution R (Vol. 2). New York: Springer. Popescu, . ., Huber, K. T., & Paradis, E. (2012). ape 3.0: New tools distance-based phylogenetics evolutionary analysis R. Bioinformatics, 28(11), 1536-1537. FitzJohn, R. G. (2010). Analysing diversification diversitree. R Package. ver, 9-2. FitzJohn, R. G. (2012). Diversitree: comparative phylogenetic analyses diversification R. Methods Ecology Evolution, 3(6), 1084-1092.","code":""},{"path":[]},{"path":"https://mjanuario.github.io/evolved/reference/fitCRBD.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Fit a constant-rate birth-death process to a phylogeny — fitCRBD","text":"Daniel Rabosky, Matheus Januario, Jennifer Auler","code":""},{"path":"https://mjanuario.github.io/evolved/reference/fitCRBD.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit a constant-rate birth-death process to a phylogeny — fitCRBD","text":"","code":"S <- 0.1 E <- 0.1 set.seed(1) phy <- simulateTree(pars = c(S, E), max.taxa = 30, max.t = 8) fitCRBD(phy) #>         S         E  #> 0.2471886 0.6915988"},{"path":"https://mjanuario.github.io/evolved/reference/lttPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"Make a lineage through time (LTT) plot — lttPlot","title":"Make a lineage through time (LTT) plot — lttPlot","text":"lttPlot plots lineage time (LTT) phylo object. also adds reference line connecting edges graph.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/lttPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make a lineage through time (LTT) plot — lttPlot","text":"","code":"lttPlot(   phy,   lwd = 1,   col = \"red\",   plot = TRUE,   rel.time = FALSE,   add = FALSE,   knitr = FALSE )"},{"path":"https://mjanuario.github.io/evolved/reference/lttPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make a lineage through time (LTT) plot — lttPlot","text":"phy phylo object, specified ape package. lwd Line width. col Line color. plot logical indicating calculations plotted. FALSE, function returns list calculated points. rel.time logical indicating time scale shown. FALSE (default), plots absolute time since phy's crown age.  TRUE, plots time relative proportion crown age furthest tip root. add logical indicating plot added pre-existing plot. Default FALSE. knitr Logical indicating plot intended show RMarkdown files made Knitr R package.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/lttPlot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make a lineage through time (LTT) plot — lttPlot","text":"Plots sum alive lineages per point time, adds red line reference expectation pure birth. plot = FALSE, list richness point time, phy's crown age.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/lttPlot.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Make a lineage through time (LTT) plot — lttPlot","text":"Paradis, E. (2012). Analysis Phylogenetics Evolution R (Vol. 2). New York: Springer.","code":""},{"path":[]},{"path":"https://mjanuario.github.io/evolved/reference/lttPlot.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Make a lineage through time (LTT) plot — lttPlot","text":"Daniel Rabosky, Matheus Januario, Jennifer Auler","code":""},{"path":"https://mjanuario.github.io/evolved/reference/lttPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Make a lineage through time (LTT) plot — lttPlot","text":"","code":"S <- 1 E <- 0 set.seed(1) phy <- simulateTree(pars = c(S, E), max.taxa = 20, max.t = 5) lttPlot(phy, knitr = TRUE)  lttPlot(phy, plot = FALSE, knitr = TRUE) #> $ldata #>            stime  lineages #>  [1,] 0.00000000 0.6931472 #>  [2,] 0.06989763 1.0986123 #>  [3,] 0.15597366 1.3862944 #>  [4,] 0.60566076 1.6094379 #>  [5,] 0.71359732 1.7917595 #>  [6,] 0.75750071 1.9459101 #>  [7,] 0.86636212 2.0794415 #>  [8,] 1.01919949 2.1972246 #>  [9,] 1.13422660 2.3025851 #> [10,] 1.37067812 2.3978953 #> [11,] 1.42212044 2.4849066 #> [12,] 1.47034648 2.5649494 #> [13,] 1.50608706 2.6390573 #> [14,] 1.51820710 2.7080502 #> [15,] 1.58208936 2.7725887 #> [16,] 1.66461861 2.8332133 #> [17,] 1.71894482 2.8903718 #> [18,] 1.74853490 2.9444390 #> [19,] 1.80376852 2.9957323 #>  #> $age #> [1] 1.855181 #>"},{"path":"https://mjanuario.github.io/evolved/reference/mammals_fossil.html","id":null,"dir":"Reference","previous_headings":"","what":"Occurrences of mammal fossils — mammals_fossil","title":"Occurrences of mammal fossils — mammals_fossil","text":"Many mammal fossil occurrences different moments geological past. Much information (.e., extra columns) removed original dataset make compact, can fully accessed data URL. dataset part package licensed Creative Commons Attribution 4.0 International License (CC 4.0).","code":""},{"path":"https://mjanuario.github.io/evolved/reference/mammals_fossil.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Occurrences of mammal fossils — mammals_fossil","text":"","code":"mammals_fossil"},{"path":"https://mjanuario.github.io/evolved/reference/mammals_fossil.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Occurrences of mammal fossils — mammals_fossil","text":"data.frame containing 69463 rows 13 columns phylum Organism phylum class Organism taxonomic class order Organism taxonomic order family Organism taxonomic family genus Organism genus species Organism specific name early_interval Earlier known geological period occurrence late_interval Later known geological period occurrence max_ma Occurrence's oldest time boundary million years min_ma Occurrence's newest time boundary million years midpoint Midpoint max_ma min_ma lng Longitude place occurrence found. Follows decimal degree format. lat Latitude place occurrence found. Follows decimal degree format.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/mammals_fossil.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Occurrences of mammal fossils — mammals_fossil","text":"Paleobiology Database (downloaded 2022-03-11).  Data URL: http://paleobiodb.org/data1.2/occs/list.csv?datainfo&rowcount&base_name=Mammalia&show=full,classext,genus,subgenus,acconly,ident,img,etbasis,strat,lith,env,timebins,timecompare,resgroup,ref,ent,entname,crmod","code":""},{"path":"https://mjanuario.github.io/evolved/reference/mammals_spp.html","id":null,"dir":"Reference","previous_headings":"","what":"Mammals species list — mammals_spp","title":"Mammals species list — mammals_spp","text":"Mammals species list","code":""},{"path":"https://mjanuario.github.io/evolved/reference/mammals_spp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mammals species list — mammals_spp","text":"","code":"mammals_spp"},{"path":"https://mjanuario.github.io/evolved/reference/mammals_spp.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Mammals species list — mammals_spp","text":"vector containing names almost (.e., 4099) extant mammal species, following Upham et al (2019) taxonomy. dataset part package licensed Creative Commons Attribution 4.0 International License (CC 4.0).","code":""},{"path":"https://mjanuario.github.io/evolved/reference/mammals_spp.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Mammals species list — mammals_spp","text":"Actual file downloaded https://vertlife.org/data/","code":""},{"path":"https://mjanuario.github.io/evolved/reference/mammals_spp.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Mammals species list — mammals_spp","text":"Upham, N. S., Esselstyn, J. ., & Jetz, W. (2019). Inferring mammal tree: species-level sets phylogenies questions ecology, evolution, conservation. PLoS biology, 17(12), e3000494.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/plotNatSel.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot NatSelSim output — plotNatSel","title":"Plot NatSelSim output — plotNatSel","text":"Plot NatSelSim output","code":""},{"path":"https://mjanuario.github.io/evolved/reference/plotNatSel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot NatSelSim output — plotNatSel","text":"","code":"plotNatSel(   gen.HW = gen.HW,   p.t = p.t,   w.t = w.t,   t = t,   W.gntp = c(w11, w12, w22),   plot.type = \"animateall\",   knitr = FALSE )"},{"path":"https://mjanuario.github.io/evolved/reference/plotNatSel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot NatSelSim output — plotNatSel","text":"gen.HW Dataframe A1A1, A1A2 A2A2 genotypic frequencies generation (nrows = NGen) p.t Allelic frequency time w.t Mean population fitness time t time W.gntp Initial genotypic fitness plot.type String indicating plot animated. default, \"animateall\", animate possible panels. options \"static\", \"animate1\", \"animate3\", \"animate4\". knitr Logical indicating plot intended show RMarkdown files made Knitr R package.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/plotNatSel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot NatSelSim output — plotNatSel","text":"Plot NatSelSim's output (see NatSelSim's help page details).","code":""},{"path":[]},{"path":"https://mjanuario.github.io/evolved/reference/plotPaintedWhales.html","id":null,"dir":"Reference","previous_headings":"","what":"Plotting the whale phylogeny and coloring its clades — plotPaintedWhales","title":"Plotting the whale phylogeny and coloring its clades — plotPaintedWhales","text":"plotPaintedWhales plots phylogeny Steeman et al (2011), coloring Dolphins (Delphinidae), porpoises (Phocoenidae), Mysticetes, baleen whales (Balaenopteridae), Beaked whales (Ziphiidae).","code":""},{"path":"https://mjanuario.github.io/evolved/reference/plotPaintedWhales.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plotting the whale phylogeny and coloring its clades — plotPaintedWhales","text":"","code":"plotPaintedWhales(   show.legend = TRUE,   direction = \"rightwards\",   knitr = FALSE,   ... )"},{"path":"https://mjanuario.github.io/evolved/reference/plotPaintedWhales.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plotting the whale phylogeny and coloring its clades — plotPaintedWhales","text":"show.legend Logical indicating clade legend shown. direction Phylogeny plotting direction. set \"rightwards\" knitr Logical indicating plot intended show RMarkdown files made Knitr R package. (default) \"leftwards\". ... arguments passed phytools::plotSimmap","code":""},{"path":"https://mjanuario.github.io/evolved/reference/plotPaintedWhales.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plotting the whale phylogeny and coloring its clades — plotPaintedWhales","text":"whale phylogeny, branch lengths colored major whale taxonomic group.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/plotPaintedWhales.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Plotting the whale phylogeny and coloring its clades — plotPaintedWhales","text":"Steeman, M. E., Hebsgaard, M. B., Fordyce, R. E., Ho, S. Y., Rabosky, D. L., Nielsen, R., ... & Willerslev, E. (2009). Radiation extant cetaceans driven restructuring oceans. Systematic biology, 58(6), 573-585.","code":""},{"path":[]},{"path":"https://mjanuario.github.io/evolved/reference/plotPaintedWhales.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Plotting the whale phylogeny and coloring its clades — plotPaintedWhales","text":"Matheus Januario, Jennifer Auler","code":""},{"path":"https://mjanuario.github.io/evolved/reference/plotPaintedWhales.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plotting the whale phylogeny and coloring its clades — plotPaintedWhales","text":"","code":"plotPaintedWhales(knitr = TRUE) #> no colors provided. using the following legend: #>                    1        Baleen whales        Beaked whales  #>              \"black\"            \"#DF536B\"            \"#61D04F\"  #> Belugas and narwhals             Dolphins     Other mysticetes  #>            \"#2297E6\"            \"#28E2E5\"            \"#CD0BBC\"  #>            Porpoises  #>            \"#F5C710\""},{"path":"https://mjanuario.github.io/evolved/reference/plotProteinSeq.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot protein sequence(s) — plotProteinSeq","title":"Plot protein sequence(s) — plotProteinSeq","text":"plotProteinSeq draws sequences proteins within \"ProteinSeq\" object. format, similar sequences similar banding patterns.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/plotProteinSeq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot protein sequence(s) — plotProteinSeq","text":"","code":"plotProteinSeq(x, taxon.to.plot, knitr = FALSE)"},{"path":"https://mjanuario.github.io/evolved/reference/plotProteinSeq.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot protein sequence(s) — plotProteinSeq","text":"x \"ProteinSeq\" object containing proteins taxon1 taxon2. taxon..plot character vector providing common name species plotted. Must name present x. knitr Logical indicating plot intended show RMarkdown files made Knitr R package.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/plotProteinSeq.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot protein sequence(s) — plotProteinSeq","text":"draw protein sequence(s) provided. Colors refer specific amino acids (\"R\", \"W\", \"\", \"F\", \"S\", \"T\", \"N\", \"H\", \"K\", \"D\", \"G\", \"L\", \"Y\", \"V\", \"M\", \"\", \"E\", \"P\", \"Q\", \"C\")\", \"gaps/space sequence (\"-\"), ambiguous amino acid (\"B\" - often representing either asparagine (\"N\") aspartic acid (\"D\")), another marker  ambiguous amino acid (\"X\").","code":""},{"path":[]},{"path":"https://mjanuario.github.io/evolved/reference/plotProteinSeq.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Plot protein sequence(s) — plotProteinSeq","text":"Matheus Januario, Jennifer Auler","code":""},{"path":"https://mjanuario.github.io/evolved/reference/plotProteinSeq.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot protein sequence(s) — plotProteinSeq","text":"","code":"data(cytOxidase) plotProteinSeq(cytOxidase, c(\"human\", \"chimpanzee\", \"cnidaria\"), knitr = TRUE)"},{"path":"https://mjanuario.github.io/evolved/reference/plotRawFossilOccs.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot a literal interpretation of a fossil record — plotRawFossilOccs","title":"Plot a literal interpretation of a fossil record — plotRawFossilOccs","text":"plotRawFossilOccs calculates plots early late boundaries associated taxa dataset.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/plotRawFossilOccs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot a literal interpretation of a fossil record — plotRawFossilOccs","text":"","code":"plotRawFossilOccs(   data,   tax.lvl = NULL,   sort = TRUE,   use.midpoint = TRUE,   return.ranges = FALSE,   knitr = FALSE )"},{"path":"https://mjanuario.github.io/evolved/reference/plotRawFossilOccs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot a literal interpretation of a fossil record — plotRawFossilOccs","text":"data data.frame containing fossil data age (early late bounds rock layer, respectively labeled max_ma min_ma) taxonomic level asked tax_lv. tax.lvl character giving taxonomic calculations based , must refer column names data. NULL (default value), function plots every individual occurrences data. sort logical indicating taxa sorted max_ma values (default value TRUE). Otherwise (.e., FALSE), function follow order taxa (occurrences) inputted data. use.midpoint logical indicating function use occurrence midpoints (max_ma min_ma) occurrence temporal boundaries, method commonly employed paleobiology remove noise related extremely coarse temporal resolution due stratification. argument used tax.lvl provided. return.ranges logical indicating ranges calculated function return data.frame. tax.lvl NULL, function calculate ranges nothing return. knitr Logical indicating plot intended show RMarkdown files made Knitr R package.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/plotRawFossilOccs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot a literal interpretation of a fossil record — plotRawFossilOccs","text":"Plots pile max-min temporal ranges chosen tax.lvl. usually stratigraphic ranges occurrences (attempt estimate \"true\" ranges), tax.lvl = NULL (default), occurrences drawn ranges stratigraphic resolution (= fossil dating imprecision). return.ranges = TRUE, returns data.frame containing diversity (column div) chosen taxonomic level, time.","code":""},{"path":[]},{"path":"https://mjanuario.github.io/evolved/reference/plotRawFossilOccs.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Plot a literal interpretation of a fossil record — plotRawFossilOccs","text":"Matheus Januario, Jennifer Auler","code":""},{"path":"https://mjanuario.github.io/evolved/reference/plotRawFossilOccs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot a literal interpretation of a fossil record — plotRawFossilOccs","text":"","code":"data(\"dinos_fossil\") oldpar <- par(no.readonly = TRUE)  par(mfrow=c(1,2)) plotRawFossilOccs(dinos_fossil, tax.lvl = \"species\", knitr = TRUE) plotRawFossilOccs(dinos_fossil, tax.lvl = \"genus\", knitr = TRUE)  par(oldpar)"},{"path":"https://mjanuario.github.io/evolved/reference/plotWFDrift.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot WFDriftSim output — plotWFDrift","title":"Plot WFDriftSim output — plotWFDrift","text":"Plot WFDriftSim output","code":""},{"path":"https://mjanuario.github.io/evolved/reference/plotWFDrift.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot WFDriftSim output — plotWFDrift","text":"","code":"plotWFDrift(p.through.time, plot.type = plot, knitr = FALSE)"},{"path":"https://mjanuario.github.io/evolved/reference/plotWFDrift.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot WFDriftSim output — plotWFDrift","text":"p..time Matrix n.gen columns n.sim lines plot.type String. Options \"static\" \"animate\" knitr Logical indicating plot intended show RMarkdown files made Knitr R package.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/plotWFDrift.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot WFDriftSim output — plotWFDrift","text":"static animated plot populations genetic drift time","code":""},{"path":[]},{"path":"https://mjanuario.github.io/evolved/reference/plotWFDrift.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot WFDriftSim output — plotWFDrift","text":"","code":"store_p = WFDriftSim(Ne = 5, n.gen = 10, p0=.2, n.sim=5, plot = \"none\", print.data = TRUE) plotWFDrift(store_p, \"static\")"},{"path":"https://mjanuario.github.io/evolved/reference/simulateBirthDeathRich.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulating richness through birth-death processes — simulateBirthDeathRich","title":"Simulating richness through birth-death processes — simulateBirthDeathRich","text":"simulateBirthDeathRich calculates number species certain point time, following birth-death process.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/simulateBirthDeathRich.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulating richness through birth-death processes — simulateBirthDeathRich","text":"","code":"simulateBirthDeathRich(t, S = NULL, E = NULL, K = NULL, R = NULL)"},{"path":"https://mjanuario.github.io/evolved/reference/simulateBirthDeathRich.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulating richness through birth-death processes — simulateBirthDeathRich","text":"t Point time richness simulated. S numeric representing per-capita speciation rate (number events per lineage per million years). Must larger E. E numeric representing per-capita extinction rate (number events per lineage per million years). Must smaller S. K numeric representing extinction fraction (.e., K = E / S). Must either zero positive number smaller one. R numeric representing per-capita Net Diversification rate (.e., R = S - E). Must positive number.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/simulateBirthDeathRich.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulating richness through birth-death processes — simulateBirthDeathRich","text":"number simulated species (.e., richness).","code":""},{"path":"https://mjanuario.github.io/evolved/reference/simulateBirthDeathRich.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Simulating richness through birth-death processes — simulateBirthDeathRich","text":"function accepts inputs S E, K R.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/simulateBirthDeathRich.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Simulating richness through birth-death processes — simulateBirthDeathRich","text":"Raup, D. M. (1985). Mathematical models cladogenesis. Paleobiology, 11(1), 42-52.","code":""},{"path":[]},{"path":"https://mjanuario.github.io/evolved/reference/simulateBirthDeathRich.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Simulating richness through birth-death processes — simulateBirthDeathRich","text":"Matheus Januario, Daniel Rabosky, Jennifer Auler","code":""},{"path":"https://mjanuario.github.io/evolved/reference/simulateBirthDeathRich.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulating richness through birth-death processes — simulateBirthDeathRich","text":"","code":"# running a single simulation: SS <- 0.40 EE <- 0.09 tt <- 10 #in Mya simulateBirthDeathRich(t = tt, S = SS, E = EE) #> [1] 23  #running many simulations and graphing results: nSim <- 1000 res <- vector() for(i in 1:nSim){   res <- c(res,    simulateBirthDeathRich(t = tt, S = SS, E = EE)) } plot(table(res)/length(res),      xlab=\"Richness\", ylab=\"Probability\")"},{"path":"https://mjanuario.github.io/evolved/reference/simulateTree.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulating a phylogenetic trees through the birth-death process — simulateTree","title":"Simulating a phylogenetic trees through the birth-death process — simulateTree","text":"simulateTree uses birth-death process simulate phylogenetic tree, following format ape package's phylo object. function basically wrapper diversitree's tree.bd function.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/simulateTree.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulating a phylogenetic trees through the birth-death process — simulateTree","text":"","code":"simulateTree(   pars,   max.taxa = Inf,   max.t,   min.taxa = 2,   include.extinct = FALSE )"},{"path":"https://mjanuario.github.io/evolved/reference/simulateTree.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulating a phylogenetic trees through the birth-death process — simulateTree","text":"pars numeric vector simulation parameters: speciation (first slot) extinction (second slot) rates, respectively. follow formats stated function tree.bd diversitree package. max.taxa Maximum number taxa include tree. Inf, tree evolved max.t time passed. max.t Maximum length evolve phylogeny . equal Inf, tree evolve max.taxa extant taxa present. min.taxa Minimum number taxa include tree. include.extinct logical indicating extinct taxa included final phylogeny.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/simulateTree.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulating a phylogenetic trees through the birth-death process — simulateTree","text":"phylo object","code":""},{"path":"https://mjanuario.github.io/evolved/reference/simulateTree.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Simulating a phylogenetic trees through the birth-death process — simulateTree","text":"see help page diversitree::tree.bd","code":""},{"path":"https://mjanuario.github.io/evolved/reference/simulateTree.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Simulating a phylogenetic trees through the birth-death process — simulateTree","text":"Paradis, E. (2012). Analysis Phylogenetics Evolution R (Vol. 2). New York: Springer. Popescu, . ., Huber, K. T., & Paradis, E. (2012). ape 3.0: New tools distance-based phylogenetics evolutionary analysis R. Bioinformatics, 28(11), 1536-1537. FitzJohn, R. G. (2010). Analysing diversification diversitree. R Packag. ver, 9-2. FitzJohn, R. G. (2012). Diversitree: comparative phylogenetic analyses diversification R. Methods Ecology Evolution, 3(6), 1084-1092.","code":""},{"path":[]},{"path":"https://mjanuario.github.io/evolved/reference/simulateTree.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Simulating a phylogenetic trees through the birth-death process — simulateTree","text":"Daniel Rabosky, Matheus Januario, Jennifer Auler","code":""},{"path":"https://mjanuario.github.io/evolved/reference/simulateTree.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulating a phylogenetic trees through the birth-death process — simulateTree","text":"","code":"S <- 1 E <- 0 set.seed(1) phy <- simulateTree(pars = c(S, E), max.taxa = 6, max.t=Inf) ape::plot.phylo(phy) ape::axisPhylo()   # alternatively, we can stop the simulation using time: set.seed(42) phy2 <- simulateTree(pars = c(S, E), max.t=7) ape::plot.phylo(phy2) ape::axisPhylo()"},{"path":"https://mjanuario.github.io/evolved/reference/timeseries_fossil.html","id":null,"dir":"Reference","previous_headings":"","what":"Fossil Time series — timeseries_fossil","title":"Fossil Time series — timeseries_fossil","text":"Values clade diversity many clades organisms (note clades nested within clades dataset). dataset part package licensed =Creative Commons Attribution 4.0 International License (CC 4.0).","code":""},{"path":"https://mjanuario.github.io/evolved/reference/timeseries_fossil.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fossil Time series — timeseries_fossil","text":"","code":"timeseries_fossil"},{"path":"https://mjanuario.github.io/evolved/reference/timeseries_fossil.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Fossil Time series — timeseries_fossil","text":"data.frame 598 rows 6 columns. clade Time series clade source Primary source Time series stem_age Stem age clade rel_time Geological relative time (Million years ago relative present) time_ma Geological time million years since clade stem age richness Number species given geological time","code":""},{"path":"https://mjanuario.github.io/evolved/reference/timeseries_fossil.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Fossil Time series — timeseries_fossil","text":"Data originally compiled many primary sources. Organized, curated , downloaded , Rabosky & Benson (2021).","code":""},{"path":"https://mjanuario.github.io/evolved/reference/timeseries_fossil.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fossil Time series — timeseries_fossil","text":"Legend:  anth = Anthozoa (Cnidaria);  art = Articulata (Crinoidea, Echinodermata);  biv = Bivalvia (Mollusca);  bryo = Bryozoa (Lophotrochozoa, Ectoprocta);  ceph = Cephalopoda (Mollusca);  chon = Chondrocytes (Chordata);  crin = Crinoidea (Echinodermata);  dinosauria = Dinosauria (Chordata);  ech = Echinoidea (Echinodermata);  foram = Foraminifera (Retaria);  gast = Gastropoda (Mollusca);  graptoloids = Graptolites (Graptolithina);  ling = Ligulata (Brachiopoda);  ostr = Ostracoda (Crustacea, Arthropoda);  tril = Trilobita (Arthropoda).","code":""},{"path":"https://mjanuario.github.io/evolved/reference/timeseries_fossil.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Fossil Time series — timeseries_fossil","text":"Rabosky, D. L., & Benson, R. B. (2021). Ecological biogeographic drivers biodiversity resolved using clade age-richness data. Nature Communications, 12(1), 2945.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/trilob_fossil.html","id":null,"dir":"Reference","previous_headings":"","what":"Occurrence of trilobite fossils — trilob_fossil","title":"Occurrence of trilobite fossils — trilob_fossil","text":"Many trilobite fossil occurrences different moments geological past. Much information (.e., extra columns) removed original dataset make compact, can fully accessed data URL. dataset part package licensed Creative Commons Attribution 4.0 International License (CC 4.0).","code":""},{"path":"https://mjanuario.github.io/evolved/reference/trilob_fossil.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Occurrence of trilobite fossils — trilob_fossil","text":"","code":"trilob_fossil"},{"path":"https://mjanuario.github.io/evolved/reference/trilob_fossil.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Occurrence of trilobite fossils — trilob_fossil","text":"data.frame containing 24965 rows 13 columns phylum Organism phylum class Organism taxonomic class order Organism taxonomic order family Organism taxonomic family genus Organism genus species Organism specific name early_interval Earlier known geological period occurrence late_interval Later known geological period occurrence max_ma Occurrence's oldest time boundary million years min_ma Occurrence's newest time boundary million years midpoint Midpoint max_ma min_ma lng Longitude place occurrence found. Follows decimal degree format. lat Latitude place occurrence found. Follows decimal degree format.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/trilob_fossil.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Occurrence of trilobite fossils — trilob_fossil","text":"Paleobiology Database (downloaded 2022-03-11).  Data URL: http://paleobiodb.org/data1.2/occs/list.csv?datainfo&rowcount&base_name=Trilobita&show=full,classext,genus,subgenus,acconly,ident,img,etbasis,strat,lith,env,timebins,timecompare,resgroup,ref,ent,entname,crmod","code":""},{"path":"https://mjanuario.github.io/evolved/reference/whale_phylo.html","id":null,"dir":"Reference","previous_headings":"","what":"Whale Phylogeny — whale_phylo","title":"Whale Phylogeny — whale_phylo","text":"ultrametric phylogenetic tree living cetaceans. Phylogeny generated Steeman et al (2009). dataset part package licensed Creative Commons Attribution 4.0 International License (CC 4.0).","code":""},{"path":"https://mjanuario.github.io/evolved/reference/whale_phylo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Whale Phylogeny — whale_phylo","text":"","code":"whale_phylo"},{"path":"https://mjanuario.github.io/evolved/reference/whale_phylo.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Whale Phylogeny — whale_phylo","text":"ultrametric phylo object 87 tips","code":""},{"path":"https://mjanuario.github.io/evolved/reference/whale_phylo.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Whale Phylogeny — whale_phylo","text":"Original phylogeny generation Steeman et al (2001). File obtained Rabosky et al, 2014.","code":""},{"path":"https://mjanuario.github.io/evolved/reference/whale_phylo.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Whale Phylogeny — whale_phylo","text":"Rabosky, D. L., Grundler, M., Anderson, C., Title, P., Shi, J. J., Brown, J. W., ... & Larson, J. G. (2014). BAMM tools: R package analysis evolutionary dynamics phylogenetic trees. Methods Ecology Evolution, 5(7), 701-707. Steeman, M. E., Hebsgaard, M. B., Fordyce, R. E., Ho, S. Y., Rabosky, D. L., Nielsen, R., ... & Willerslev, E. (2009). Radiation extant cetaceans driven restructuring oceans. Systematic biology, 58(6), 573-585.","code":""}]
